Image Captioning with Very Scarce Supervised Data:
Adversarial Semi-Supervised Learning Approach

Dong-Jin Kim1

Jinsoo Choi1 Tae-Hyun Oh2

In So Kweon1

1KAIST, South Korea.

2MIT CSAIL, Cambridge, MA.

1 {djnjusa,jinsc37,iskweon77}@kaist.ac.kr

2taehyun@csail.mit.edu

9
1
0
2

v
o

N

1
2

]

V

C

.

s

c

[

2
v
1
0
2
2
0

.

9
0
9
1

:

v

i

X

r

a

Abstract

Constructing an organized dataset comprised
of a large number of images and several cap-
tions for each image is a laborious task, which
requires vast human effort. On the other
hand, collecting a large number of images and
sentences separately may be immensely eas-
ier.
In this paper, we develop a novel data-
efÔ¨Åcient semi-supervised framework for train-
ing an image captioning model. We leverage
massive unpaired image and caption data by
learning to associate them. To this end, our
proposed semi-supervised learning method as-
signs pseudo-labels to unpaired samples via
Generative Adversarial Networks to learn the
joint distribution of image and caption. To
evaluate, we construct scarcely-paired COCO
dataset, a modiÔ¨Åed version of MS COCO cap-
tion dataset. The empirical results show the ef-
fectiveness of our method compared to several
strong baselines, especially when the amount
of the paired samples are scarce.

1

Introduction

Image captioning is a task of automatically gener-
ating a natural language description of a given im-
age. It is a highly useful task, in that 1) it extracts
the essence from an image into a self-descriptive
form of representation, and 2) the output format
is a natural language, which exhibits free-form
and manageable characteristics useful to applica-
tions such as language based image or region re-
trieval [Johnson et al., 2016; Karpathy and Fei-
Fei, 2015; Kim et al., 2019], video summariza-
tion [Choi et al., 2018], navigation [Wang et al.,
2018a], vehicle control [Kim et al., 2018b]. Im-
age captioning exhibits free-form characteristics,
since it is not conÔ¨Åned to a few number of pre-
deÔ¨Åned classes. This enables descriptive analysis
of a given image.
Recent research on image captioning has made
impressive progress [Anderson et al., 2018;
Vinyals et al., 2015]. Despite this progress, the

Figure 1: The proposed data setup utilizes both
note paired data as Dp , and unpaired image and caption
‚Äúpaired‚Äù and ‚Äúunpaired‚Äù image-caption data. We de-
datasets as Dx
u and Dy
u respectively.

majority of works are trained via supervised learn-
ing that requires a large corpus of caption labeled
images such as the MS COCO caption dataset [Lin
et al., 2014]. SpeciÔ¨Åcally,
the dataset is con-
structed with 1.2M images that were asked the
annotators to provide Ô¨Åve grammatically plausi-
ble sentences for each image. Constructing such
human-labeled datasets are an immensely labori-
ous task and time-consuming. This is a challenge
of image captioning, because the task heavily re-
quires large data, i.e., data hungry task.
In this work, we present a novel way of leverag-
ing unpaired image and caption data to train data
hungry image captioning neural networks. We
consider a scenario in which we have a small scale
paired image-caption data of a speciÔ¨Åc domain.
We are motivated by the fact that images can be
easily obtained from the web and captions can be
easily augmented and synthesized by replacing or
adding different words for given sentences as done
in [Zhang et al., 2015]. Moreover, given a suf-
Ô¨Åcient amount of descriptive captions, it is easy
to crawl corresponding but noisy images through
Google or Flickr image databases [Thomee et al.,
2016] to build an image corpus. In this way, we
can easily construct a scalable unpaired dataset of
images and captions, which requires no (or at least
minimal) human effort.
Due to the unpaired nature of images (input)
and captions (output supervision),
the conven-

Paired Data (ùë´ùíë)Unpaired Image Data (ùë´ùíñùíô)Unpaired Text Data (ùë´ùíñùíö)Apizzawithbasilleavesservedonaplate.Awomancuttingalargecakewithonelitcandle.Apieceofcakeandcoffeeareonanoutdoortable.AwhitedoghasapurpleFrisbeeinit‚Äôsmouth.Achocolatecakeandaforkreadytobeeat.Awomancuttingapizzawithaforkandknife. 
 
 
 
 
 
tional supervision loss can no longer be used di-
rectly. We propose to algorithmically assign su-
pervision labels, termed as pseudo-labels, to make
unpaired data paired. The pseudo-label is used
as a learned supervision label. To develop the
mechanism of pseudo-labeling, we use generative
adversarial network (GAN) [Goodfellow et al.,
2014], for searching pseudo-labels for unpaired
data. That is, in order to Ô¨Ånd the appropriate
pseudo-labels for unpaired samples, we utilize an
adversarial training method for training a discrim-
inator model. Thereby, the discriminator learns to
distinguish between real and fake image-caption
pairs and to retrieve pseudo labels as well as to
enrich the captioner training.
Our main contributions are summarized as fol-
lows. (1) We propose a novel framework for train-
ing an image captioner with the unpaired image-
caption data and a small amount of paired data.
(2) In order to facilitate training with unpaired
data, we devise a new semi-supervised learning
approach by the novel usage of the GAN dis-
criminator. (3) We construct our scarcely-paired
COCO dataset, which is the modiÔ¨Åed version of
the MS COCO dataset without pairing informa-
tion. On this dataset, we show the effectiveness
of our method in various challenging setups, com-
pared to strong competing methods.

2 Related Work

The goal of our work is to deal with unpaired
image-caption data for image captioning. There-
fore, we mainly focus on image captioning and
unpaired data handling literature.

Data Issues in Image Captioning. Since the

introduction of large-scale datasets such as MS
COCO data [Lin et al., 2014], image captioning
has been extensively studied in vision and lan-
guage society [Anderson et al., 2018; Rennie et
al., 2017; Vinyals et al., 2015; Xu et al., 2015] by
virtue of the advancement of deep convolutional
neural networks [Krizhevsky et al., 2012]. As neu-
ral network architectures become more advanced,
they require much larger dataset scale for gener-
alization [Shalev-Shwartz and Ben-David, 2014].
Despite the extensive study on better network ar-
chitectures, the data issues for image captioning,
such as noisy data, partially missing data, and un-
paired data have been relatively barely studied.
Unpaired image-caption data has been just re-
cently discussed. Gu et al.
[2018] introduce

a third modal information, Chinese captions, for
language pivoting [Utiyama and Isahara, 2007;
Wu and Wang, 2007]. Feng et al. [2019] propose
an unpaired captioning framework which trains a
model without image or sentence labels via learn-
ing a visual concept detector with external data,
OpenImage dataset [Krasin et al., 2017]. Chen et
al. [2017] approach image captioning as a domain
adaptation by utilizing large paired MS COCO
data as the source domain and adapting on a sep-
arate unpaired image or caption dataset as the tar-
get domain. Liu et al. [2018] use self-retrieval for
captioning to facilitate training a model with par-
tially labeled data, where the self-retrieval mod-
ule tries to retrieve corresponding images based
on the generated captions. As a separate line
of work, there are novel object captioning meth-
ods [Anne Hendricks et al., 2016; Venugopalan et
al., 2017] that additionally exploit unpaired image
and caption data corresponding to a novel word.
Most of aforementioned works [Gu et al., 2018;
Anne Hendricks et al., 2016; Venugopalan et al.,
2017; Feng et al., 2019] exploit large auxiliary
supervised data which is often beyond image-
caption data. To the best of our knowledge, we
are the Ô¨Årst to study how to handle unpaired im-
age and caption data for image captioning without
any auxiliary information but by leveraging scarce
paired image-caption data only. Although [Chen
et al., 2017] does not use auxiliary information
as well, it requires large amounts of paired source
data, of which data regime is different from ours.
[Liu et al., 2018] is also this case, where they use
the full paired MS COCO caption dataset with an
additional large unlabeled image set. Our method
lies on a very scarce paired source data regime, of
which scale is only 1% of the COCO dataset.

Multi-modality in Unpaired Data Handling. By

virtue of the advancement on generative modeling
techniques, e.g., GAN [Goodfellow et al., 2014],
multi-modal
translation recently emerged as a
popular Ô¨Åeld. Among many possible modalities,
image-to-image translation between two different
(and unpaired) domains has been mostly explored.
To tackle this issue, the cycle-consistency con-
straint between unpaired data is exploited in Cy-
cleGAN [Zhu et al., 2017] and DiscoGAN [Kim et
al., 2017], and it is further improved in UNIT [Liu
et al., 2017].
In this work, we regard image captioning as
a multi-modal translation. Our work has similar

motivation to the unpaired image-to-image trans-
lation [Zhu et al., 2017], and unsupervised ma-
chine translation [Artetxe et al., 2018; Lample et
al., 2018a,b] works or machine translation with
monolingual data [Zhang et al., 2018]. However,
we show that the cycle-consistency does not work
on our problem setup due to a signiÔ¨Åcant modal-
ity gap. Instead, our results suggest that the tra-
ditional label propagation based semi-supervised
framework [Zhou et al., 2004] is more effective
for our task.

Semi-supervised Learning. Our method is mo-

tivated by the generative model based semi-
supervised learning [Chongxuan et al., 2017; Gan
et al., 2017; Kingma et al., 2014], which mostly
deals with classiÔ¨Åcation labels.
In contrast, we
leverage caption data and devise a novel model to
train the captioning model.

3 Proposed Framework

In this section, we Ô¨Årst brief the standard image
caption learning, and describe how we can lever-
age the unpaired dataset. Then, we introduce an
adversarial learning method for obtaining a GAN
model that is used for assigning pseudo-labels and
encouraging to match the distribution of latent fea-
tures of images and captions. Lastly, we describe
a connection to CycleGAN.

3.1 Model

pairs as Dp = {(xi , yi )}Np

Let us denote a dataset with Np image-caption
i=1 . A typical image cap-
tioning task is deÔ¨Åned as follows: given an im-
age xi , we want a model to generate a caption yi
that best describe the image. Traditionally, a cap-
tioning model is trained on a large paired dataset
(x, y) ‚àà Dp , e.g., MS COCO dataset, by minimiz-
ing the negative log likelihood against the ground
truth caption as follows:

LCE (y , x; Œ∏),

(1)

(cid:88)

min

Œ∏

(x,y)‚ààDp

where LCE = ‚àílog qŒ∏ (y |x) denotes the cross en-
tropy loss, Œ∏ the set of learnable parameters, and
q(¬∑) the probability output of the model. Moti-
vated by encoder-decoder based neural machine
translation literature [Cho et al., 2014],
tradi-
tional captioning frameworks are typically imple-
mented as a encoder-decoder architecture [Vinyals
et al., 2015], i.e., CNN-RNN. The CNN encoder
F (x; Œ∏enc ) produces a latent feature vector zx

from a given input image x, and the RNN decoder
H (zx ; Œ∏dec ) is followed to generate a caption y in
a natural language form from zx , as depicted in
Fig. 2. The term q(¬∑) in Eq. (1) is typically im-
plemented by the sum of the cross entropy of each
word token. For simplicity, we omit Œ∏ from here if
deducible, e.g., H (zx ).

Learning with Unpaired Data. Our problem

u={yi}Ny

i=0

u={xi}Nx

deals with unpaired data samples, where the image
and caption sets Dx
i=0 and Dy
are not paired. Given the unpaired datasets, due to
the missing supervision, the loss in Eq. (1) cannot
be directly computed. Motivated by the nearest
neighbor aware semi-supervised framework [Shi
et al., 2018], we artiÔ¨Åcially generate pseudo-labels
for respective unpaired datasets.
SpeciÔ¨Åcally, we retrieve a best match caption
u given a query image xi , and assign it
as a pseudo-label, and vice versa ( Àúxi for yi ). We
abuse the pseudo-label as a function for simplic-
ity, e.g., Àúyi = Àúy(xi ). To retrieve a semantically
meaningful match, we need a measure to assess
matches. We use a discriminator network to de-
termine real or fake pairs by GAN, which we will
describe later. With the retrieved pseudo-labels,
now we can compute Eq. (1) by modifying it as:

Àúyi in Dy

(cid:88)

x‚ààDx

u

min

Œ∏

Œªx

LCE ( Àúy(x), x; Œ∏) + Œªy

(cid:88)

y‚ààDy

u

LCE (y , Àúx(y); Œ∏),

(2)

where Œª{¬∑} denote the balance parameters.

Discriminator Learning by Unpaired Feature

Matching. We train the criterion to Ô¨Ånd a se-
mantically meaningful match, so that pseudo-
labels for each modality are effectively retrieved.
We learn a discriminator for that by using a small
amount of paired supervised dataset.
We adopt a caption encoder, G(y ; Œ∏cap ), which
embeds the caption y into a feature zy . This is im-
plemented with a single layer LSTM, and we take
the output of the last time step as the caption rep-
resentation zy . Likewise, given an image x, we
obtain zx by the image encoder F (x; Œ∏enc ). Now,
we have a comparable feature space of zx and zy .
We utilize the discriminator to distinguish whether
the pair (zx , zy ) from true paired data (x, y) ‚àà Dp ,
i.e., the pair belongs to the real distribution p(x, y)
or not. We could use random pairs of (x, y)
independently sampled from respective unpaired
datasets, but we found that it is detrimental due
to uninformative pairs. Instead, we conditionally

Figure 2: Description of the proposed method. Dotted arrows denote the path of the gradients via back-propagation.
Given any image and caption pair, CNN and RNN (LSTM) encoders encode input image and caption into the
respective feature spaces. A discriminator (D) is trained to discriminate whether the given feature pairs are real or
fake, while the encoders are trained to fool the discriminator. The learned discriminator is also used to assign the
most likely pseudo-labels to unpaired samples through the pseudo-label search module.

synthesize zx or zy , to form a synthesized pair that
appears to be as realistic as possible. We use the
feature transformer networks Àúzy = Tv‚Üíc (zx ) and
Àúzx = Tc‚Üív (zy ), where v‚Üíc denotes the mapping
from visual data to caption data and vice versa, and
Àúz denotes the conditionally synthesized feature.
{T } are implemented with multi-layer-perceptron
with four FC layers with ReLU nonlinearity.
The discriminator D(¬∑, ¬∑) learns to distinguish
features, real or not. At the same time, the other
associated networks F , G, T{¬∑} are learned to fool
the discriminator by matching the distribution of
paired and unpaired data. Motivated by [Chongx-
uan et al., 2017], the formulation of this adversar-
ial training is as follows:

[log(D(zx , zy )) + Lreg (zx , zy , {T })]

Œ∏,{T } max
min

D

(zx ,zy )
‚àº(F,G)‚ó¶Dp

E

(cid:18)

+ 1

2

E

x‚àºp(x)

+ E

y‚àºp(y)

[log(1 ‚àí D(F (x), Tv‚Üíc (F (x))))]

[log(1 ‚àí D(Tc‚Üív (G(y)), G(y)))]

(cid:19)

(D) and generator (Œ∏ , {T }) similar to [Kim et
al., 2018a],
the latent feature distribution of
paired and unpaired data should be close to

each other, i.e., p(zx , zy ) = p(zx , Tv‚Üíc (zx )) =

p(Tc‚Üív (zy ), zy ) (refer to the proof in [Chongxuan
et al., 2017]).
In addition, as the generator is
trained, the decision boundary of the discriminator
tightens. If the unpaired datasets are sufÔ¨Åciently
large such that semantically meaningful matches
exist between the different modality datasets, and
if the discriminator D is plausibly learned, we
can use D to retrieve a proper pseudo-label. Our
architecture is illustrated in Fig. 2.

Dx

Pseudo-label Assignment. Given an image x ‚àà

u , we retrieve a caption in the unpaired dataset,
i.e., Àúy ‚àà Dy
u , that has the highest score obtained by
the discriminator, i.e., the most likely caption to be
paired with the given image as

(zy )(cid:107)2
F ),

c‚Üív

where Lreg (zx , zy , {T })=
Œªreg ((cid:107) T
(zx )‚àízy (cid:107)2
F + (cid:107)zx‚àí T

v‚Üíc

and we use the distribution notation p(¬∑) to Ô¨Çex-
ibly refer to any type of the dataset regardless
of Dp and Du . Note that the Ô¨Årst log term is
not used for updating any learnable parameters
related to Œ∏ , {T }, but only used for updating D .
Through alternating training of the discriminator

Àúyi = Àúy(xi ) = argmax

y‚ààDy

u

D (F (xi ), G(y)) ,

(4)

,

(3)

vice versa for unpaired captions:

Àúxi = Àúx(yi ) = argmax

x‚ààDx

u

D (F (x), G(yi )) .

(5)

By this retrieval process over all the unpaired
dataset, we have image-caption pairs {(xi , yi )}
from the paired data and the pairs with pseudo-
labels {(xj , Àúyj )} and {( Àúxk , yk )} from the unpaired

CNN()(shared)ùë´ùë´(shared)PairedLSTM(ùê∫ùê∫) (shared)LSTM(ùêªùêª)ùëªùëªùíÑùíÑ‚Üíùíóùíóùëªùëªùíóùíó‚ÜíùíÑùíÑLSTM(ùê∫ùê∫)(shared)Caption feat (ùëßùëßùë¶ùë¶)Image feat(ùëßùëßùë•ùë•)Caption feat (ùëßùëßùë¶ùë¶)Image feat (ùëßùëßùë•ùë•)Unpaired Caption(ùê∑ùê∑ùë¢ùë¢ùë¶ùë¶)Paired  Data(ùê∑ùê∑ùëùùëù)Unpaired Image(ùê∑ùê∑ùë¢ùë¢ùë•ùë•)Unpaired/PairedUnpaired/Pairedùë´ùë´(shared)ùë´ùë´(shared)Prediction (ÔøΩùë¶ùë¶)Pseudo-label (ÔøΩùë¶ùë¶)Pseudo-label  Search Moduleùëßùëßùë•ùë•ùëßùëß1ùë¶ùë¶ùëßùëß2ùë¶ùë¶ùëßùëß3ùë¶ùë¶ùëßùëß4ùë¶ùë¶12343142ScoresRankedScoresùë´ùë´ùë¶ùë¶3CNN()(shared)Pseudo-label  Search Moduleùë≥ùë≥ùë™ùë™ùë™ùë™Caption (ùë¶ùë¶)Caption (ùë¶ùë¶)Image (ùë•ùë•)Image (ùë•ùë•):Forward:Back-prop(ùê∑ùê∑):Back-prop(Œ∏,{T})data. However, these pseudo-labels are not noise-
free, thus treating them equally with the paired
ones is detrimental. Motivated by learning with
noisy labels [Lee et al., 2018; Wang et al., 2018b],
we deÔ¨Åne a conÔ¨Ådence score for each of the as-
signed pseudo-labels. We use the output score
from the discriminator, as the conÔ¨Ådence score,
i.e., Œ±x

i = ÀÜD(xi , Àúyi ) and Œ±y
i = ÀÜD( Àúxi , yi ), where we
denote ÀÜD(x, y) = D(F (x), G(y)), and Œ± ‚àà [0, 1]

The discriminator D is learned to distinguish
whether the latent features is from the image or
the caption distribution. This is different with our
method, in that we distinguish the correct seman-
tic match of pairs. We experimented with Cycle-
GAN purely on unpaired datasets, but we were not
able to train it; hence, we add the supervised loss
(Eq. (1)) with the paired data, which is a fair set-
ting with ours.

due to the sigmoid function of the Ô¨Ånal layer of the
discriminator. Therefore, we utilize the conÔ¨Ådence
scores to assign weights to the unpaired samples.
We compute the weighted loss as follows:

(cid:80)

min

Œ∏

(x,y)‚ààDp

(cid:80)

x‚ààDx

u

LCE (y , x; Œ∏) + Œªx

Œ±x
i LCE ( Àúy(x), x; Œ∏)

+Œªy

Œ±y
i LCE (y , Àúx(y); Œ∏).

(6)

(cid:80)

y‚ààDy

u

We jointly train the model on both paired and
unpaired data. To ease the training further, we add
an additional triplet loss function:

pŒ∏ (yp |xp )
pŒ∏ (yp |xu )

log

+ log

pŒ∏ (yp |xp )
pŒ∏ (yu |xp )

, (7)

(cid:88)

(xp ,yp )‚ààDp ,
xu‚ààDx
u ,yu‚ààDy

u

by regarding random unpaired samples as nega-
tive. This slightly improves the performance.

3.2 Connection with CycleGAN

As a representative fully unpaired method, Cy-
cleGAN [Zhu et al., 2017] would be the strong
baseline at this point, which has been popularly
used for unpaired distribution matching. Since
it is designed for image-to-image translation, we
describe the modiÔ¨Åcations to it to Ô¨Åt our task,
so as to understand relative performance of our
method over the CycleGAN baseline. When ap-
plying the cycle-consistency on matching between
images and captions, since the input modalities are
totally different, we modify it to a translation prob-
lem over feature spaces as follows:

D{x,y}

Lcycle ({T })
Œ∏,{T } max
min
[log(Dx (F (x))) + log(1 ‚àí Dx (Tv‚Üíc (F (x))))]
[log(Dy (G(y))) + log(1 ‚àí Dy (Tc‚Üív (G(y))))],

+ E

+ E

x‚àºp(x)

y‚àºp(y)

(8)

where {T } and D{x,y} denotes the feature transla-
tors and the discriminators for image domain and
caption domain, and

Lcycle ({T }) = Ex‚àºp(x) [(cid:107)Tc‚Üív (Tv‚Üíc (F (x))) ‚àí F (x)(cid:107)2 ]
+Ey‚àºp(y) [(cid:107)Tv‚Üíc (Tc‚Üív (G(y))) ‚àí G(y)(cid:107)2 ].

(9)

4 Experiments

In this section, we describe the experimental
setups, competing methods and provide perfor-
mance evaluations of unpaired captioning with
both quantitative and qualitative results.

4.1

Implementation Details

We implement our neural networks by PyTorch li-
brary [Paszke et al., 2017]. We use ResNet101 [He
et al., 2016] model as a backbone CNN encoder
for image input, and initialize with weights pre-
trained on ImageNet [Russakovsky et al., 2015].
Each region is represented as 2,048-dimensional
output from the last residual block of this network.
For NIC model [Vinyals et al., 2015] and Att2in
model [Rennie et al., 2017] in Table 3, we use vi-
sual features with size 2048 √ó 7 √ó 7 . For Up-
Down [Anderson et al., 2018] and the model in Ta-
ble 3, we use Faster R-CNN [Ren et al., 2015] pre-
trained on Visual Genome [Krishna et al., 2017]
object dataset, thereby we extract visual features
for 10 to 100 regions.
We set the channel size of the hidden layers of
LSTMs to be 1024, 512 for the attention layer,
and 1024 for the word embeddings. For inference
stage, we empirically choose the beam size to be
3 when generating a description, which shows the
best performance.
We use a minibatch size of 100, the Adam [Ba
and Kingma, 2015] optimizer for training (learn-
ing rate lr=5e‚àí4 , b1=0.9, b2=0.999). For hyper-
parameters, we empirically choose Œªx and Œªy to
be equal to 0.1. The total loss function for training
our model is as follows:

L = Lcap + 0.1LGAN + 0.1Ltriplet ,

(10)
where Lcap denotes the captioning loss deÔ¨Åned in
Eq. (6), LGAN the loss for adversarial training de-
Ô¨Åned in Eq. (3), and Ltriplet the triplet loss deÔ¨Åned
in Eq. (7).

(A)

(B)

Fully paired (100%)
Paired only (1%)
CycleGAN (Zhu et al. )

Ours ver1
Ours ver2
Ours (Ô¨Ånal)

[Gu et al., 2018]
[Feng et al., 2019]

(C) BLEU1 BLEU4 METEOR CIDEr
72.5
29.4
25.0
95.7
58.1
13.4
15.9
36.0
58.7
14.1
16.2
37.7
60.1
15.7
16.5
45.3
61.3
17.1
19.1
51.7

63.0

18.7

(cid:88)
(cid:88) (cid:88)
(cid:88) (cid:88) (cid:88)

20.7

55.2

46.2
58.9

5.4
18.6

13.2
17.9

17.7
54.9

Table 1: Captioning performance comparison on MS
COCO testset. The ‚ÄúPaired only‚Äù baseline is trained
only with 1% of paired data from our scarcely-paired
COCO dataset, while CycleGAN and Ours {ver1, ver2,
Ô¨Ånal}, are trained with our scarcely-paired COCO
dataset (1% of paired data and unpaired image and cap-
tion datasets). We indicate the ablation study by: (A)
the usage of the proposed GAN that distinguishes real
or fake image-caption pairs, (B) pseudo-labeling, and
(C) noise handling by sample re-weighting. We also
compare with [Gu et al., 2018] and [Feng et al., 2019],
which are trained with unpaired datasets.

4.2 Experimental Setups

We utilize MS COCO caption [Lin et al., 2014]
as our target dataset, which contains 123k images
with 5 caption labels per image. To validate our
model, we follow Karpathy splits [Karpathy and
Fei-Fei, 2015], which have been broadly used in
image captioning literature. The Karpathy splits
contain 113k training, 5k validation, and 5k test
images in total.
In our experiments, in order to
simulate the scenario that both paired and unpaired
data exist, we use two different data setups: 1) the
proposed scarcely-paired COCO, and 2) partially
labeled COCO [Liu et al., 2018] setup.
For the scarcely-paired COCO setup, we re-
move the pairing information of the MS COCO
dataset, while leaving a small fraction of pairs un-
altered. We randomly select only one percent of
the total data, i.e., 1,133 training images for the
paired data, and remove the pairing information
of the rest to obtain unpaired data. We call the
small fraction of samples given as pairs as paired
data (Dp ) and call the samples without pairing in-
formation as unpaired data (Du ). We study the
effects of other ratios of paired data used for train-
ing (in Figs. 4 and 3). This dataset allows evalu-
ating the proposed framework to measure whether
such small paired data can be leveraged to learn
plausible pseudo-label assignment, and what per-
formance can be achieved compared to the fully
supervised case.
For partially labeled COCO setup, we follow
[Liu et al., 2018] and use the whole MS COCO
data (paired) and add the ‚ÄúUnlabeled-COCO‚Äù

Figure 3: Performance w.r.t. amount of paired data for
training. Baseline denotes our Paired Only baseline,
Ours is our Ô¨Ånal model, and Reference is Paired Only
trained with full paired data.

split of the ofÔ¨Åcially MS-COCO [Lin et al., 2014]
for unpaired images, which involves 123k images
without any caption label. To compute the cross
entropy loss, we use the pseudo-label assignment
for the Unlabeled-COCO images.
For evaluation, we use the following met-
rics conventionally used in image caption-
ing: BLEU [Papineni et al., 2002], ROUGUE-
L [Lin, 2004], SPICE [Anderson et al., 2016],
METEOR [Denkowski and Lavie, 2014], and
CIDEr [Vedantam et al., 2015]. All the evaluation
is done on MS COCO testset.
In order to avoid high time complexity of
the pseudo-labeling process, we do not search
the pseudo-labels from the whole unpaired data.
Pseudo-label retrieval is done on a subset of one-
hundredth of the unpaired data (yielding 1000
samples). Thus, the complexity of each minibatch
becomes O(B √ó N √ó 0.01), where B denotes the
minibatch size, N denotes the size of the unpaired
dataset. Since we also apply label-noise handling,
a plausible pseudo-label assignment is sufÔ¨Åcient
in helping the learning process. We can improve
performance by using a larger subset or by using a
fast approximate nearest neighbor search.

4.3 Evaluation on Scarcely-paired COCO

We follow the same setting with [Vinyals et al.,
2015], if not mentioned. Table 1 shows the re-
sults on the scarcely-paired COCO dataset. We
compare with several baselines: Paired Only; we
train our model only on the small fraction (1%)
of the paired data, CycleGAN ; we train our model
with the cycle-consistency loss [Zhu et al., 2017]
(as in Eq. (8)). Additionally, we train variants of
our model denoted as Ours (ver1, ver2, and Ô¨Å-
nal). The model denoted as Our ver1, is trained

0.10.20.30.40.50.60.70.80.91Ratio of paired data.7880828486889092949698CIDErBaselineOursReferenceFigure 4: Sampled qualitative results of our model. We compare with the baseline models trained only on N % of
paired samples out of the full MS COCO. Despite the use of only 1% paired data, our model generates plausible
captions similar to that of the baseline models trained with more data (10% and above).

via our GAN model (Eq. (3)) that distinguishes
real or fake image-caption pairs. For Our ver2, we
add training with pseudo-labels for unpaired data
with Eq. (6) while setting the conÔ¨Ådence scores
Œ±x=Œ±y=1 for all training samples. For our Ô¨Ånal
model denoted as Our (Ô¨Ånal), we apply the noise
handling technique by the conÔ¨Ådence scores Œ±x
and Œ±y computed by Eq. (6) and re-weighting the
loss for each sample. We present the performance
of the fully supervised (Fully paired) model using
100% of the COCO training data for reference.

As shown in Table 1, in a scarce data regime,
utilizing the unpaired data improves the captioning
performance in terms of all metrics by noticeable
margins. Also, our models show favorable perfor-
mance compared to the CycleGAN model in all
metrics. Our Ô¨Ånal model with pseudo-labels and
noise handling achieves the best performance in
all metrics across all the competitor, hereafter ref-
ered to this model as our model.

We also compare the recent unpaired image
captioning methods [Gu et al., 2018; Feng et al.,
2019] in Table 1. Both of the methods are eval-
uated on MS COCO testset. In the case of Gu et
al., AIC-ICC image-to-Chinese dataset [Wu et al.,
2017] is used as unpaired images Dx
u and cap-
tions from MS COCO are used as unpaired cap-
tions Dy
u . Note that this is not a fair comparison to

our method but they have more advantages, in that
Gu et al. use large amounts of additional labeled
data (10M Chinese-English parallel sentences of
AIC-MT dataset [Wu et al., 2017]) and Feng et
al. use 36M samples of additional OpenImages
dataset, whereas our model only uses a small
amount of paired samples (1k) and 122k unpaired
data. Despite far lower reliance on paired data, our
model shows favorable performance against recent
unpaired captioning works.

We study our Ô¨Ånal model against our Paired
Only baseline according to varying amounts of
paired training data in Fig. 3, so that we can see
how much information can be gained from the un-
paired data. From 100% to 10%, as the amount of
paired samples decreases, the Ô¨Çuency and the ac-
curacy of the descriptions get worse. In particular,
we observed that most of the captions generated
from the Paired Only baseline trained with 10% of
paired data (11,329 pairs) show erroneous gram-
matical structure.
In contrast, by leveraging un-
paired data, our method can generate more Ô¨Çuent
and accurate captions, compared to Paired Only
trained on the same amount of paired data. It is
worthwhile to note that our model trained with
60% of paired data (67,972 pairs) achieves similar
performance to the Paired Only baseline trained
with fully paired data (113,287 pairs), which sig-

Baseline(1%): a player playing a swinging on her long.Baseline(10%): a woman playing tennis on a court with a racket.Baseline(100%): a woman is playing tennis on a court.Ours        (1%) : a man with a tennis racket on a court.Baseline(1%) : a black bear wearing skis with a chain on the trees.Baseline(10%) : a black bear is standing in the grass.Baseline(100%) : a black bear is walking through a field.Ours(1%):ablackbearwalkingthroughthegrassneartheforest.Baseline(1%): a bunch of children white skis on.Baseline(10%): a group of people standing on top of a snow covered slope.Baseline(100%): a group of people standing on top of a snow covered slope.Ours        (1%): a group of people standing on a snow covered slope.Baseline(1%) : a baseball player playing with out a red.Baseline(10%) : a baseball player is getting ready to hit a ball.Baseline(100%) : a group of people playing a game of Frisbee.Ours(1%):abaseballplayerplayingisswingingabatataball.Baseline(1%) : a train rolling down tracks at the track.Baseline(10%) : a train on track near a station.Baseline(100%) : a train is traveling down the tracks in a city.Ours(1%):atraintravelingdownthetracksinfrontofatrainstation.Baseline(1%): a little girl skier markers on to snow the slope.Baseline(10%): a person skiing down a snowy slope.Baseline(100%): a man riding skis down a snow covered slope.Ours        (1%) : a person standing on skis in a snow covered field.Baseline(1%): a zebra standing over ledge in a French together.Baseline(10%): a zebra standing on top of a lush green field.Baseline(100%): a zebra standing in a field with a tree in the background.Ours        (1%): a zebra standing on a grassy filed.Baseline(1%) : a bunch of sheep in front of the zoo standing.Baseline(10%) : a group of sheep standing next to each other.Baseline(100%) : a herd of sheep standing on top of a lush green field.Ours(1%)agroupofsheepstandingnexttoafence.Self-Retrieval [Liu et al., 2018] (w/o unlabeled)
Self-Retrieval [Liu et al., 2018] (with unlabeled)
Baseline (w/o unlabeled)
Ours (w/o unlabeled)
Ours (with unlabeled)

BLEU1 BLEU2 BLEU3 BLEU4 ROUGE-L SPICE METEOR CIDEr
79.8
62.3
47.1
34.9
56.6
20.5
27.5
114.6
80.1
63.1
48.0
35.8
57.0
21.0
27.4
117.1
77.7
61.6
46.9
36.2
56.8
20.0
26.7
114.2
80.8
65.3
49.9
37.6
58.7
22.7
28.4
122.6

23.8

29.4

125.5

81.2

66.0

50.9

39.1

59.4

Table 2: Comparison with the semi-supervised image captioning method, ‚ÄúSelf-Retrieval‚Äù [Liu et al., 2018]. Our
method shows improved performance even without Unlabeled-COCO data (denoted as w/o unlabeled) as well as
with Unlabeled-COCO (with unlabeled), although our model is not originally proposed for such scenario.

Figure 5: Examples of the pseudo-labels (captions) as-
signed to the unpaired images. Our model is able to
sufÔ¨Åciently assign image-caption pairs through the pro-
posed adversarial training.

Figure 6: Example captions containing words that do
not exist in the paired dataset Dp . The novel words that
are not in Dp but in Dy
u are highlighted in bold.

niÔ¨Åes that our method is able to save near half of
the human labeling effort of constructing a dataset.
We also show qualitative samples of our results
in Fig. 4. Paired Only baseline trained with 1%
paired data produces erroneous captions, and the
baseline with 10% paired data starts to produce
plausible captions. It is based on ten times more
paired samples, compared to our model that uses
only 1% of them. We highlight that, in the two ex-
amples on the top row of Fig. 4, our model gener-
ates more accurate captions than the Paired Only
baseline trained on the 100% paired data (‚Äúbase-
ball‚Äù to ‚ÄúFrisbee‚Äù on the top-left, and ‚Äúman‚Äù to
‚Äúwoman‚Äù on the top-right). This suggests that un-
paired data with our method effectively boosts the
performance especially when paired data is scarce.
In order to demonstrate the meaningfulness of
our pseudo-label assignment, we show the pseudo-
labels assigned to the unpaired samples. We show
the pseudo-labels (captions) assigned to unlabeled
images from Unlabeled-COCO images in Fig. 5.
As shown in the Ô¨Ågure, despite not knowing the
real pairs of these images, the pseudo labels are
sufÔ¨Åciently assigned by the model. Note that even
though there is no ground truth caption for unla-
beled images in the searching pool, the model is
able to Ô¨Ånd the most likely (semantically corre-
lated) image-caption pair for the given images.
Fig. 6 highlights interesting result samples of
our caption generation, where the results con-
tain words that do not exist in the paired data of
the scarcely-paired COCO dataset. The semantic
meaning of the words such as ‚Äúgrowling,‚Äù ‚Äúgrow-

ing,‚Äù and ‚Äúherded,‚Äù which involve in the unpaired
caption data but not in the paired data, may have
been learned properly via pseudo-label assignment
during training. These examples suggest that our
method is capable to infer the semantic meaning of
unpaired words to some extent, which would have
been unable to be learned with only little paired
data. This would be an evidence that our frame-
work is capable to align abstract semantic spaces
between two modalities, i.e., visual and caption.

4.4 Evaluation on Partially Labeled COCO

For a more realistic setup, we compare with the
recent semi-supervised image captioning method,
called Self-Retrieval [Liu et al., 2018], on their
problem regime, i.e., ‚Äúpartially labeled‚Äù COCO
setup, where the full amount of the paired MS
COCO (113k) plus 123k uncaptioned images of
the Unlabeled-COCO set are used (no additional
unpaired caption is used). While their regime is
not our direct scope, but we show the effectiveness
of our method in the regime. Then, we extend our
framework by replacing our backbone architecture
with recent advanced image caption architectures.
In this setup, a separate unpaired caption data Dy
does not exist, thus we use captions from paired
COCO data Dp as pseudo-labels.
Table 2 shows the comparison with Self-
Retrieval.
For a fair comparison with them,
we replace the cross entropy loss from our loss
with the policy gradient method [Rennie et al.,
2017] to directly optimize our model with CIDEr
score as in [Liu et al., 2018]. As our baseline

u

a bus is parked on a street.a large bear standing on a grass.a motorcycle parked on a street.Twobearsgrowlinginthewater.Abroccoligrowsonagreenplant.Cowsbeingherdedbyafenceinafield.NIC [Vinyals et al., 2015]

NIC +Ours

Att2in [Rennie et al., 2017]
Att2in +Ours
Up-Down [Anderson et al., 2018]
Up-Down +Ours

BLEU1 BLEU2 BLEU3 BLEU4 ROUGE-L SPICE METEOR CIDEr
72.5
55.1
40.4
29.4
52.7
18.2
25.0
95.7

74.2

56.9

42.0

31.0

54.1

19.4

28.8

97.8

74.5

75.5

76.7

77.3

58.1

58.8

60.7

64.1

44.0

45.0

47.1

47.6

33.1

34.3

36.4

37.0

54.6

55.4

56.6

57.1

19.4

20.0

20.6

21.0

26.2

26.8

27.6

27.8

104.3

105.3

113.6

114.6

Table 3: Evaluation of our method with different backbone architectures. All models are reproduced and trained
with the cross entropy loss. By adding Unlabeled-COCO images, our training method was applied in a semi-
supervised way, which shows consistent improvement in all the metrics.

model (denoted as Baseline), we train a model
only with policy gradient method without the pro-
posed GAN model. When only using the 100%
paired MS COCO dataset (denoted as w/o unla-
beled), our model already shows improved per-
formance over Self-Retrieval. Moreover, when
adding Unlabeled-COCO images (denoted as with
unlabeled), our model performs favorably against
Self-Retrieval in all the metrics. The results sug-
gest that our method is also advantageous in the
semi-supervised setup.
To further validate our method in the semi-
supervised setup, we compare different backbone
architectures [Anderson et al., 2018; Rennie et
al., 2017; Vinyals et al., 2015] in our frame-
work, where their methods are developed for fully-
supervised methods. We use the same data setup
with the above, but we replace CNN (F ) and
LSTM (H ) from our framework with the image
encoder and the caption decoder from their im-
age captioning models. Then, these models can
be trained in our framework as it is by alternat-
ing between the discriminator update and pseudo-
labeling. Table 3 shows the comparison. Training
with the additional Unlabeled-COCO data via our
training scheme consistently improves all base-
lines in all metrics.

4.5 Captioning with Web-Crawled Data

To simulate a scenario involving crawled data
from the web, we use the setup suggested by
Feng et al. [2019]. They collect a sentence cor-
pus by crawling the image descriptions from Shut-
terstock1 as unpaired caption data Dy
u , whereby
2.2M sentences are collected. For unpaired im-
age data Dx
u , they use only the images from the
MS COCO data, while the captions are not used
for training. For training our method, we lever-
age from 0.5% to 1% of paired MS COCO data
as our paired data Dp . The results are shown in
Table 4 with the performance obtained by Feng et

1 https://www.shutterstock.com

Paired only (0.5% paired)
Ours (0.5% paired)
Paired only (0.7% paired)
Ours (0.7% paired)
Paired only (0.8% paired)
Ours (0.8% paired)
Paired only (1% paired)
Ours (1% paired)
[Feng et al., 2019]

BLEU4 ROUGE-L SPICE METEOR CIDEr
4.4
33.7
3.6
10.8
8.6
5.4
34.6
4.2
12.0
10.5
3.5
36.1
3.7
11.4
8.9
8.5
39.0
5.2
13.6
20.2
8.8
39.1
5.9
13.2
21.9
12.2
41.6
7.6
15.1
29.0
13.4
41.9
8.3
15.9
36.0
15.2
43.3
9.4
16.9
39.7
4.8
27.2
7.0
11.4
23.3

Table 4: Performance comparison with web-crawled
data (Shutterstock). On top of unpaired image and cap-
tion data, our method is trained with 0.5 ‚Äì 1% of paired
data, while Feng et al. use 36M additional images of
the OpenImage dataset.

al. Note again that Feng et al. exploits external
large-scale data, i.e., 36M images in the OpenIm-
ages dataset. With 0.5% of paired only data (566
pairs), our baseline shows lower scores in terms
of BLEU4 and METEOR than Feng et al., while
our proposed model shows comparable or favor-
able performance in BLEU4, ROUGE-L and ME-
TEOR. Our method starts to have higher scores in
all metrics from 0.8% of paired data (906 pairs),
even without additional 36M images.

5 Conclusion

We introduce a method to train an image cap-
tioning model with a large scale unpaired image
and caption data, given a small amount of paired
data. Our framework achieves favorable perfor-
mance compared to various methods and setups.
Unpaired captions and images are the data that can
be easily collected from the web. It can facilitate
application speciÔ¨Åc captioning models, where la-
beled data is scarce.

Acknowledgements. This work was supported
by Institute for
Information & communica-
tions Technology Planning & Evaluation(IITP)
grant funded by the Korea government(MSIT)
(No.2017-0-01780, The technology development
for event
recognition/relational
reasoning and
learning knowledge based system for video under-
standing)

References

Peter Anderson, Basura Fernando, Mark Johnson, and
Stephen Gould. Spice: Semantic propositional im-
age caption evaluation. In European Conference on
Computer Vision (ECCV). Springer, 2016.

Peter Anderson, Xiaodong He, Chris Buehler, Damien
Teney, Mark Johnson, Stephen Gould, and Lei
Zhang. Bottom-up and top-down attention for im-
age captioning and vqa.
In IEEE Conference on
Computer Vision and Pattern Recognition (CVPR),
2018.

Lisa Anne Hendricks, Subhashini Venugopalan, Mar-
cus Rohrbach, Raymond Mooney, Kate Saenko, and
Trevor Darrell. Deep compositional captioning: De-
scribing novel object categories without paired train-
ing data. In IEEE Conference on Computer Vision
and Pattern Recognition (CVPR), 2016.

Mikel Artetxe, Gorka Labaka, Eneko Agirre, and
Kyunghyun Cho. Unsupervised neural machine
translation. In International Conference on Learn-
ing Representations (ICLR), 2018.

Jimmy Ba and Diederik Kingma. Adam: A method
for stochastic optimization.
In International Con-
ference on Learning Representations (ICLR), 2015.

Tseng-Hung Chen, Yuan-Hong Liao, Ching-Yao
Chuang, Wan-Ting Hsu, Jianlong Fu, and Min Sun.
Show, adapt and tell: Adversarial training of cross-
domain image captioner.
In IEEE International
Conference on Computer Vision (ICCV), 2017.

Kyunghyun Cho, Bart Van Merri ¬®enboer, Caglar Gul-
cehre, Dzmitry Bahdanau, Fethi Bougares, Holger
Schwenk, and Yoshua Bengio. Learning phrase rep-
resentations using rnn encoder-decoder for statis-
tical machine translation.
In Conference on Em-
pirical Methods in Natural Language Processing
(EMNLP), 2014.

Carin. Triangle generative adversarial networks. In
Advances in Neural Information Processing Systems
(NIPS), 2017.

Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza,
Bing Xu, David Warde-Farley, Sherjil Ozair, Aaron
Courville, and Yoshua Bengio. Generative adver-
sarial nets. In Advances in Neural Information Pro-
cessing Systems (NIPS), 2014.

Jiuxiang Gu, ShaÔ¨Åq Joty, Jianfei Cai, and Gang Wang.
Unpaired image captioning by language pivoting. In
European Conference on Computer Vision (ECCV),
2018.

Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian
Sun. Deep residual learning for image recognition.
In IEEE Conference on Computer Vision and Pattern
Recognition (CVPR), 2016.

Justin Johnson, Andrej Karpathy, and Li Fei-Fei.
Densecap: Fully convolutional
localization net-
works for dense captioning. In IEEE Conference on
Computer Vision and Pattern Recognition (CVPR),
2016.

Andrej Karpathy and Li Fei-Fei. Deep visual-semantic
alignments for generating image descriptions.
In
IEEE Conference on Computer Vision and Pattern
Recognition (CVPR), 2015.

Taeksoo Kim, Moonsu Cha, Hyunsoo Kim, Jung Kwon
Lee, and Jiwon Kim. Learning to discover cross-
domain relations with generative adversarial net-
works.
In International Conference on Machine
Learning (ICML), 2017.

Dong-Jin Kim, Jinsoo Choi, Tae-Hyun Oh, Youngjin
Yoon, and In So Kweon. Disjoint multi-task learn-
ing between heterogeneous human-centric tasks. In
2018 IEEE Winter Conference on Applications of
Computer Vision (WACV), pages 1699‚Äì1708. IEEE,
2018.

Jinsoo Choi, Tae-Hyun Oh, and In So Kweon. Contex-
tually customized video summaries via natural lan-
guage. In IEEE Winter Conference on Applications
of Computer Vision (WACV), 2018.

Jinkyu Kim, Anna Rohrbach, Trevor Darrell, John
Canny, and Zeynep Akata. Textual explanations for
self-driving vehicles.
In European Conference on
Computer Vision (ECCV), 2018.

LI Chongxuan, TauÔ¨Åk Xu, Jun Zhu, and Bo Zhang.
Triple generative adversarial nets.
In Advances
in Neural Information Processing Systems (NIPS),
2017.

Michael Denkowski and Alon Lavie. Meteor univer-
sal: Language speciÔ¨Åc translation evaluation for any
target language. In The workshop on statistical ma-
chine translation, 2014.

Yang Feng, Lin Ma, Wei Liu, and Jiebo Luo. Unsu-
pervised image captioning. In IEEE Conference on
Computer Vision and Pattern Recognition (CVPR),
2019.

Zhe Gan, Liqun Chen, Weiyao Wang, Yuchen Pu,
Yizhe Zhang, Hao Liu, Chunyuan Li, and Lawrence

Dong-Jin Kim, Jinsoo Choi, Tae-Hyun Oh, and In So
Kweon. Dense relational captioning: Triple-stream
networks for relationship-based captioning. In Pro-
ceedings of the IEEE Conference on Computer Vi-
sion and Pattern Recognition, pages 6271‚Äì6280,
2019.

Durk P Kingma, Shakir Mohamed, Danilo Jimenez
Rezende, and Max Welling. Semi-supervised learn-
ing with deep generative models.
In Advances in
neural information processing systems, pages 3581‚Äì
3589, 2014.

Ivan Krasin, Tom Duerig, Neil Alldrin, Vittorio Fer-
rari, Sami Abu-El-Haija, Alina Kuznetsova, Has-
san Rom, Jasper Uijlings, Stefan Popov, Andreas
Veit, et al. Openimages: A public dataset for

large-scale multi-label and multi-class image clas-
siÔ¨Åcation. Dataset available from https://github.
com/openimages, 2:3, 2017.

Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin John-
son, Kenji Hata, Joshua Kravitz, Stephanie Chen,
Yannis Kalantidis, Li-Jia Li, David A Shamma,
et al. Visual genome: Connecting language and vi-
sion using crowdsourced dense image annotations.
International Journal of Computer Vision (IJCV),
123(1):32‚Äì73, 2017.

Alex Krizhevsky, Ilya Sutskever, and Geoffrey E Hin-
ton. Imagenet classiÔ¨Åcation with deep convolutional
neural networks. In Advances in Neural Information
Processing Systems (NIPS), 2012.

Guillaume Lample, Alexis Conneau, Ludovic Denoyer,
and Marc‚ÄôAurelio Ranzato. Unsupervised machine
translation using monolingual corpora only.
In
International Conference on Learning Representa-
tions (ICLR), 2018.

Guillaume Lample, Myle Ott, Alexis Conneau, Lu-
dovic Denoyer, et al. Phrase-based & neural un-
supervised machine translation.
In Conference on
Empirical Methods in Natural Language Processing
(EMNLP), 2018.

Kuang-Huei Lee, Xiaodong He, Lei Zhang, and Lin-
jun Yang. Cleannet: Transfer learning for scalable
image classiÔ¨Åer training with label noise. In IEEE
Conference on Computer Vision and Pattern Recog-
nition (CVPR), 2018.

Tsung-Yi Lin, Michael Maire, Serge Belongie, James
Hays, Pietro Perona, Deva Ramanan, Piotr Doll ¬¥ar,
and C Lawrence Zitnick. Microsoft coco: Com-
mon objects in context. In European Conference on
Computer Vision (ECCV). Springer, 2014.

Chin-Yew Lin. Rouge: A package for automatic eval-
uation of summaries. Text Summarization Branches
Out, 2004.

Ming-Yu Liu, Thomas Breuel, and Jan Kautz. Unsu-
pervised image-to-image translation networks.
In
Advances in Neural Information Processing Systems
(NIPS), 2017.

Xihui Liu, Hongsheng Li, Jing Shao, Dapeng Chen,
and Xiaogang Wang. Show, tell and discriminate:
Image captioning by self-retrieval with partially la-
beled data.
In European Conference on Computer
Vision (ECCV), 2018.

Kishore Papineni, Salim Roukos, Todd Ward, and Wei-
Jing Zhu. Bleu: a method for automatic evaluation
of machine translation. In Association for Compu-
tational Linguistics (ACL). Association for Compu-
tational Linguistics, 2002.

Adam Paszke, Sam Gross, Soumith Chintala, Gre-
gory Chanan, Edward Yang, Zachary DeVito, Zem-
ing Lin, Alban Desmaison, Luca Antiga, and Adam
Lerer. Automatic differentiation in pytorch.
In
NIPS-W, 2017.

Shaoqing Ren, Kaiming He, Ross Girshick, and Jian
Sun. Faster R-CNN: Towards real-time object de-
tection with region proposal networks. In Advances
in Neural Information Processing Systems (NIPS),
2015.

Steven J Rennie, Etienne Marcheret, Youssef Mroueh,
Jarret Ross, and Vaibhava Goel. Self-critical se-
quence training for image captioning. In IEEE Con-
ference on Computer Vision and Pattern Recognition
(CVPR), 2017.

Olga Russakovsky, Jia Deng, Hao Su, Jonathan Krause,
Sanjeev Satheesh, Sean Ma, Zhiheng Huang, Andrej
Karpathy, Aditya Khosla, Michael Bernstein, et al.
Imagenet large scale visual recognition challenge.
International Journal of Computer Vision (IJCV),
115(3):211‚Äì252, 2015.

Shai Shalev-Shwartz and Shai Ben-David. Under-
standing machine learning: From theory to algo-
rithms. Cambridge university press, 2014.

Weiwei Shi, Yihong Gong, Chris Ding, Zhiheng MaX-
iaoyu Tao, and Nanning Zheng. Transductive semi-
supervised deep learning using min-max features. In
European Conference on Computer Vision (ECCV),
2018.

Bart Thomee, David A Shamma, Gerald Fried-
land, Benjamin Elizalde, Karl Ni, Douglas Poland,
Damian Borth, and Li-Jia Li. Yfcc100m: the new
data in multimedia research. Communications of the
ACM, 59(2):64‚Äì73, 2016.

Masao Utiyama and Hitoshi Isahara. A comparison of
pivot methods for phrase-based statistical machine
translation.
In Conference of the North American
Chapter of the Association for Computational Lin-
guistics: Human Language Technologies (NAACL-
HLT), 2007.

Ramakrishna Vedantam, C Lawrence Zitnick, and Devi
Parikh. Cider: Consensus-based image description
evaluation. In IEEE Conference on Computer Vision
and Pattern Recognition (CVPR), 2015.

Subhashini Venugopalan, Lisa Anne Hendricks, Mar-
cus Rohrbach, Raymond Mooney, Trevor Darrell,
and Kate Saenko. Captioning images with diverse
objects.
In IEEE Conference on Computer Vision
and Pattern Recognition (CVPR), 2017.

Oriol Vinyals, Alexander Toshev, Samy Bengio, and
Dumitru Erhan. Show and tell: A neural image cap-
tion generator.
In IEEE Conference on Computer
Vision and Pattern Recognition (CVPR), 2015.

Xin Wang, Wenhan Xiong, Hongmin Wang, and
William Yang Wang. Look before you leap: Bridg-
ing model-free and model-based reinforcement
learning for planned-ahead vision-and-language
navigation.
In European Conference on Computer
Vision (ECCV), 2018.

Yisen Wang, Weiyang Liu, Xingjun Ma, James Bailey,
Hongyuan Zha, Le Song, and Shu-Tao Xia.
Itera-
tive learning with open-set noisy labels.
In IEEE
Conference on Computer Vision and Pattern Recog-
nition (CVPR), 2018.

Hua Wu and Haifeng Wang.
Pivot
language ap-
proach for phrase-based statistical machine transla-
tion. Machine Translation, 21(3):165‚Äì181, 2007.

Jiahong Wu, He Zheng, Bo Zhao, Yixin Li, Baoming
Yan, Rui Liang, Wenjia Wang, Shipei Zhou, Gu-
osen Lin, Yanwei Fu, et al. Ai challenger: A large-
scale dataset for going deeper in image understand-
ing. arXiv preprint arXiv:1711.06475, 2017.

Kelvin Xu, Jimmy Ba, Ryan Kiros, Kyunghyun Cho,
Aaron Courville, Ruslan Salakhudinov, Rich Zemel,
and Yoshua Bengio. Show, attend and tell: Neu-
ral image caption generation with visual attention.
In International Conference on Machine Learning
(ICML), 2015.

Xiang Zhang,
Junbo Zhao,
and Yann LeCun.
Character-level convolutional networks for text clas-
siÔ¨Åcation. In Advances in Neural Information Pro-
cessing Systems (NIPS), 2015.

Zhirui Zhang, Shujie Liu, Mu Li, Ming Zhou, and En-
hong Chen. Joint training for neural machine trans-
lation models with monolingual data. In AAAI Con-
ference on ArtiÔ¨Åcial Intelligence (AAAI), 2018.

Dengyong Zhou, Olivier Bousquet, Thomas N Lal, Ja-
son Weston, and Bernhard Sch ¬®olkopf. Learning
with local and global consistency.
In Advances
in Neural Information Processing Systems (NIPS),
2004.

Jun-Yan Zhu, Taesung Park, Phillip Isola, and Alexei A
Efros. Unpaired image-to-image translation using
cycle-consistent adversarial networks. In IEEE In-
ternational Conference on Computer Vision (ICCV),
2017.

