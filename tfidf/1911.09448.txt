9
1
0
2

v
o

N

1
2

]

h
p

-

t

n

a

u
q

[

1
v
8
4
4
9
0

.

1
1
9
1

:

v

i

X

r

a

Local certiﬁcation of programmable quantum devices of arbitrary high dimensionality

Kishor Bharti,1 , ∗ Maharshi Ray,1 , ∗ Antonios Varvitsiotis,2 Adán Cabello,3, 4 and Leong-Chuan Kwek1, 5, 6

1Centre for Quantum Technologies, National University of Singapore
2Engineering Systems and Design Pil lar, Singapore University of Technology and Design
3Departamento de Física Aplicada II, Universidad de Sevil la, E-41012 Sevil la, Spain
4 Instituto Carlos I de Física Teórica y Computacional, Universidad de Sevil la, E-41012 Sevil la, Spain
5MajuLab, CNRS-UNS-NUS-NTU International Joint Research Unit, Singapore UMI 3654, Singapore
6National Institute of Education, Nanyang Technological University, Singapore 637616, Singapore

The onset of the era of fully-programmable
error-corrected quantum computers will be
marked by ma jor breakthroughs in all areas of
science and engineering. These devices prom-
ise to have signiﬁcant technological and soci-
etal
impact, notable examples being the ana-
lysis of big data through better machine learn-
ing algorithms and the design of new materials.
Nevertheless, the capacity of quantum computers
to faithfully implement quantum algorithms re-
lies crucially on their ability to prepare spe-
ciﬁc high-dimensional and high-purity quantum
states, together with suitable quantum measure-
ments. Thus, the unambiguous certiﬁcation of
these requirements without assumptions on the
inner workings of the quantum computer is crit-
ical to the development of trusted quantum pro-
cessors. One of the most important approaches
for benchmarking quantum devices is through
the mechanism of self-testing [1–3] that requires
a pair of entangled non-communicating quantum
devices [4]. Nevertheless, although computation
typically happens in a localized fashion, no local
self-testing scheme is known to benchmark high
dimensional states and measurements. Here, we
show that the quantum self-testing paradigm can
be employed to an individual quantum computer
that is modelled as a programmable black box by
introducing a noise-tolerant certiﬁcation scheme.
We substantiate the applicability of our scheme
by providing a family of outcome statistics whose
observation certiﬁes that the computer is pro-
ducing speciﬁc high-dimensional quantum states
and implementing speciﬁc measurements.
Classical computing devices store and manipulate se-
quences of binary numbers, which are called bits, to
perform computational tasks of the utmost social sig-
niﬁcance such as healthcare scheduling, weather predic-
tion, and routing of vehicles. However, as the number
of variables involved in a computational task grows bey-
ond a limit, such as in the simulation of 50 − 60 spin
half particles, even state-of-the-art supercomputers fail
spectacularly to carry out the required computations.

∗ equal contribution

Harnessing the properties of quantum theory to carry
out computations beyond the reach of classical super-
computers is one ma jor ob jective of quantum informa-
tion processing. Quantum algorithms choreograph the
state of a number of qubits (the quantum analogue of
classical bits) in an intelligent fashion, which in turn al-
lows to perform highly complex computations. This fur-
ther requires the error corrected programmable universal
quantum computer to be able to generate some speciﬁc
quantum states and perform speciﬁc measurements on
them. Such a requirement is a necessary condition and
must be fulﬁlled by these powerful futuristic devices.
In a faithfully minimimalistic scenario, developing
trust in the functionality of quantum devices necessitates
schemes for certiﬁcation and benchmarking that do not
rely on any assumptions concerning the inner working
of the devices. One of the most important approaches
for establishing trust in third-party quantum hardware
is via self-testing [1, 5–9], where the quantum appar-
atus is modelled as a black box. In this setting, interac-
tions with the device correspond to measurements, and
self-testing leads to guarantees regarding the uniqueness
of the measurement settings and the underlying state
preparation, based solely on the measurement statist-
ics. The ﬁrst approach to self-testing relied on the use of
Bell inequalities, i.e., linear expressions involving prob-
abilities of measurement-outcome events that can be car-
ried out in a Bell experiment [10]. Self-testing based
on Bell experiments is a powerful technique allowing to
develop insights about the inner working of a pair of
non-communicating entangled devices. However, com-
puting typically takes place in a localized setting and
consequently, any scheme for benchmarking a progam-
mable quantum computer must be of a local nature to
be of any practical relevance. The ﬁrst such local self-
testing scheme was introduced recently in [11] within the
framework of contextuality, a broad generalization of Bell
non-locality [10, 12]. However, the contextuality-based
self-testing scheme from [11] was limited in scope due to
its applicability to three dimensional quantum systems
only. As the dimensional of the Hilbert space correspond-
ing to a quantum computing device grows exponentially
as a function of the number of qubits, this naturally leads
to the problem of identifying local certiﬁcation schemes
for arbitrary high dimensionality.
In this article, we provide a contextuality-based self-
testing scheme for local certiﬁcation of programmable

 
 
 
 
 
 
quantum devices of arbitrary high dimensionality. A con-
textuality scenario is characterized by a set of measure-
ment events, where two events are mutually exclusive
if they correspond to same measurement but diﬀerent
outcomes. The exclusivity relations between the meas-
urement events can be conveniently encoded as edges in
an undirected graph, called the exclusivity graph. The
seemingly simple idea to use graphs to represent ex-
clusivity relations has spearheaded the development of
a new line of research at the interface of graph theory
and contextuality [13]. The linear inequalities, the vi-
olation of which witnesses contextuality, are referred to
as non-contextuality inequalities. Bell inequalities are
a special type of non-contextuality inequalities where
the “contexts” are provided via the space-like separation
of the parties involved [10, 14]. The ﬁrst “local” non-
contextuality inequality violated by quantum theory was
identiﬁed by Klyachko, Can, Binicioğlu and Shumovsky
(KCBS) [15]. The bound on a non-contextuality inequal-
ity in a non-contextual hidden variable (NCHV) model
is called the NCHV bound. Quantum theory violates
the NCHV bound for suitably chosen state and measure-
ment settings and thus manifests as a contextual the-
ory. To any exclusivity graph we associate a “canon-
ical” non-contextuality inequality. Furthermore, we say
that a graph is self-testable, if the corresponding non-
contextuality inequality admits self-testing. The main
contributions of this work can be summarized as follows:
We give a local and robust self-testing scheme for cer-
tifying high-dimensional programmable quantum devices
based on contextuality (see Figure 1).
As a key ingredient in the scheme, we show that the
family of odd anti-cyclic graphs with at least ﬁve ver-
tices are self-testable. Additionally, we extend the pro-
tocol given in [11] (which only provides suﬃcient con-
ditions for self-testing), in order to determine if a given
graph is provably non-self-testable (see Appendix F). In
particular, we show that not all graphs with a positive
gap between NCHV bound and the maximum quantum
bound for the corresponding canonical non-contextuality
inequality admits self-testing by providing an explicit
counterexample.
Graph approach to contextuality— An arbitrary experi-
mental scenario can be characterized by a set of measure-
ment events e1 , . . . , en . Two events are mutually exclus-
ive if they correspond to same measurement but diﬀerent
outcomes. The exclusivity structure of a set of measure-
ment events is captured by the exclusivity graph, denoted
Gex , with nodes {1, . . . , n} (denoted by [n]) correspond-
ing to events {ei }n
i=1 . Two nodes i and j are adjacent
(denoted by i ∼ j ) if ei and ej are mutually exclusive.
Given an experimental scenario with exclusivity graph
Gex , a theory assigns probability to the events corres-
ponding to its vertices. The mapping p : [n] → [0, 1],
where pi + pj ≤ 1, for all i ∼ j is called a behaviour.
Here, the non-negative numbers pi refer to the probab-
ility of the event ei . We call a behaviour p determin-
istic non-contextual if all the probabilities pi are either

2

Figure 1. The local certiﬁcation scheme proceeds in three
steps.
In step 1, we select a self-testable graph. Then we
proceed to program the optimal conﬁguration corresponding
to the graph in the quantum computer. In the last step, we
carry on the contextuality experiment and generate the meas-
urement statistics. If the measurement statistics correspond
to optimal quantum violation, it implies that the device imple-
mented the settings as per the program (upto an isometry).
If it reaches close to the optimal violation, the robustness
of our scheme still provides conﬁdence about the ﬁdelity of
the intended operation with the implemented operation. If it
fails (i.e., gives an output outside a pre-established conﬁdence
neighbourhood of the extremal value), the protocol indicates
that the device is not performing reliably.

0 or 1 and the occurrence of a event does not depend on
the possibility of occurrence of other events. The con-
vex hull of all deterministic non-contextual behaviours
form a polytope, denoted by Pnc (Gex ), which contains all
possible non-contextual behaviours for the experimental
scenario encoded by the graph Gex . The behaviours which
lie outside Pnc (Gex ) are contextual behaviours. The set of
non-contextual behaviours are bounded by ﬁnitely many
halfspaces, which are called non-contextuality inequal-
ities. Formally speaking, non-contextuality inequalities
correspond to linear inequalities of the form

wipi ≤ Bnc (Gex , w), ∀p ∈ Pnc (Gex ),

(1)

(cid:88)

i∈[n]

(cid:80)

where w1 , . . . , wn ≥ 0 and Bnc (Gex , w) are real scalars.
The non-contextuality inequalities with all the weights
{wi s} equal to one will be referred to as canonical non-
contextuality inequalities. By deﬁnition, Bnc (Gex , w) cor-
responds to the NCHV bound on the linear expression
i∈[n] wipi and is also equal to the independence num-
ber of the exclusivity graph Gex , deﬁned as the cardinality
of the largest set of pairwise non-adjacent nodes of Gex
[13]. A quantum behaviour has the following form:

pi = tr(ρΠi ), ∀i ∈ [n] and tr(ΠiΠj ) = 0, for i ∼ j,

(2)

for some quantum state ρ and quantum pro jectors
Π1 , . . . , Πn acting on a Hilbert space H. An ensemble
i=1 satisfying (2) is called a quantum realisation
of the behavior p. For a given quantum behaviour p,

ρ, {Π}n

Select a self-testable graphProgram the optimal configurationPerform the experiment and generate statisticsi=1 up

there can be multiple quantum realisations. The set of
sion (cid:80)
quantum behaviours is a convex set, which we denote
by Pq (Gex ). The maximum value of the linear expres-
i∈[n] wipi , as p ranges over the set of quantum
behaviors Pq (Gex ) can exceed the classical bound. We
will denote the maximum attainable quantum value by
Bcq (Gex , w). Interestingly, Bcq (Gex , w) is equal to the
Lovász theta number of the graph Gex and admits a for-
mulation as a tractable optimisation problem known as
a semideﬁnite program [13] (see Methods Section).
Robust
self-testing— Informally speaking,
a non-
contextuality inequality I is said to self-test a quantum
realisation ρ, {Π}n
i=1 if it achieves the quantum bound for
the non-contextuality inequality I and furthermore, all
other quantum realisations which achieve the quantum
bound corresponding to I are equivalent to ρ, {Π}n
to global isometry. For a formal deﬁnition, the reader
is referred to Section B in the Appendix. As discussed
in [11], the essential ingredient in proving self-testing res-
ults for a non-contextuality inequality I with underlying
exclusivity graph Gex is that the corresponding Lovász
theta semideﬁnite program (cf. (PG )) has an unique op-
timal solution. In the case of the KCBS inequality, the
exclusivity graph is a pentagon. The conﬁguration cor-
responding to optimal quantum violation admits an um-
brella structure (see Figure 2). The KCBS inequality has
been generalized to odd n-cycle exclusivity graphs, which
are called KCBSn inequalities. The KCBSn inequalities
are the canonical non-concontextuality inequalities for an
odd cycle graph and admit robust self-testing [11].
Self-testing anti-cycles— Building on the link between
graph theory and contextuality [16], in combination with
the strong perfect graph theorem [17], it was shown in
[13, 16] that the presence of certain exclusivity struc-
tures is a necessary and suﬃcient condition for a non-
contextuality scenario to witness quantum contextuality.
These fundamental exclusivity structures correspond to
an odd number of events that are either cyclically or anti-
cyclically exclusive. In the graph theory literature, odd
cycles and odd anti-cycles are called odd holes and odd
anti-holes respectively. The canonical non-contextuality
inequality for an anti-hole is given by:

n(cid:88)

(cid:0)Cn

(cid:1) ,

pi ≤ 2,

for all p ∈ Pnc

(3)

i=1

n

n

cos π

which we call anti-hole inequalities and correspond to fa-
cets of the classical polytope for Cn . The quantum bound
for the anti-hole inequalities, i.e., the Lovász theta num-
ber for Cn is 1+cos π
. A canonical quantum ensemble
which achieves the quantum value for the anti-hole in-
equalities corresponding to odd n is given by n − 2 di-
mensional quantum state and pro jectors. In fact the di-
mension of quantum system achieving optimal quantum
violation of anti-hole inequalities must be n − 2 for odd n.
We provide a proof of the aforementioned claim in Ap-
pendix D. Moreover, we show that the anti-hole inequal-

3

Figure 2. The geometry corresponding to the unique optimal
conﬁguration of C5 looks like an umbrella. The handle of the
umbrella is the quantum state and the vectors corresponding
to the pro jectors are the spokes of the umbrella.

ities admit robust self-testing. This fact is proven in the
Appendix (Sections B and C).
As the presence of holes and/or anti-holes in a con-
textuality scenario dictates the possibility of quantum
advantage [16], our result regarding anti-hole self-testing
in combination with [11] imply that al l non-contextuality
inequalities which are fundamental to quantum theory ad-
mit local robust self-testing. This is because the gener-
alized KCBS and anti-hole inequalities are the unique
facet-deﬁning non-contextuality inequalities for their re-
spective odd hole and anti-hole exclusivity scenarios [18].
A new local certiﬁcation scheme—Leveraging our self-
testing results we propose a local certiﬁcation scheme
that proceeds in three phases described below:

1. Graph selection: Choose a self-testable graph using
the algorithm detailed in Figure 3. In particular,
one can use the anti-cycle graphs for benchmarking
arbitrary high-dimensional quantum realisations.

2. Conﬁguration coding: Solve the Lovász theta SDP
corresponding to the graph chosen in Step 1 and
compute the unique optimal conﬁguration using the
gram vectors of the solution. Next, program the
device to create this conﬁguration.

3. Experimentation: Perform a contextuality exper-
iment using this conﬁguration and generate the
measurement statistics. If the statistics achieve the
Lovász theta bound or is within a pre-established
conﬁdence neighbourhood, we trust the device.
Otherwise, the protocol indicates that the device
is not performing as a reliable and suﬃciently non-
noisy quantum computer.

Conclusion— One of the central problems in quantum
computation is to devise protocols that allow an eﬃ-
cient classical machine (also known as veriﬁer) to verify
the computation done by an eﬃcient quantum machine
(also known as prover) [19]. An important approach

has been proposed for a weaker variant of the problem
where the veriﬁer has access to a small quantum com-
puter of her own, or she has to verify two entangled
non-communicating provers [4, 20–23], which relies on
self-testing properties of parallel CHSH games. More im-
portantly, the self-testing nature of parallel CHSH games
along with protocols for state and process tomography
and computation by teleportation, [4] devised a method
for realising arbitrary quantum dynamics without assum-
ing anything about the internal structure of the non-
communicating quantum devices.
In a seminal paper,
Mahadev provided an aﬃrmative answer to the prob-
lem involving a single veriﬁer and a single prover [24].
The scheme requires a complexity-theoretic assumption,
i.e., the veriﬁer has access to post-quantum crypto-
graphy, which the eﬃcient quantum prover can not break.
Though our scheme depends on the self-testing proper-
ties of local non-contextuality inequalities, further work
needs to be done for realising arbitrary dynamics in a way
similar to [4]. The classical simulation of the outcome
statistics corresponding to our scheme requires systems
of higher dimension [25–28] and has a thermodynamical
extra cost [29]. The only assumption made in our frame-
work is that measurements are pro jective, which can be
tested experimentally [30].

METHODS

The main tool we use in this work to show that anti-
hole inequalities admit robust self-testing is Theorem 1,
shown in [11], which provides a suﬃcient condition for a
graph to be self-testable. This result relies crucially on
the rich properties of a powerful class of mathematical
optimisation models, known as Semideﬁnite programs
(SDPs) (see Appendix A). SDPs constitute a vast gener-
alisation of linear optimisation models where scalar vari-
ables are replaced by vectors and the constraints and ob-
jective function are aﬃne in terms of the inner products
of the vectors. Equivalently, collecting all pairwise inner
products of these vectors in matrix, known as the Gram
matrix, an SDP corresponds to optimising a linear func-
tion of the Gram matrix sub ject to aﬃne constraints.
Analogously to linear programs, to any SDP there is an
associated a dual program whose value is equal to the
primal under reasonable assumptions. Next, we single
out certain properties of primal-dual solutions that are of
relevance to his work. A pair of primal dual optimal solu-
tions (X ∗ , Z ∗ ) with no duality gap (i.e. tr(X ∗Z ∗ ) = 0),
satisﬁes strict complementarity if the Range(X ∗ ) and
Range(Z ∗ ) give a direct sum decomposition of the under-
lying space. Furthermore, an optimal dual solution Z ∗
with rank r is dual nondegenerate if the tangent space at
Z ∗ of the manifold of symmetric matrices with rank equal
to r together with the linear space of matrices deﬁning
the SDP span the entire space of symmetric matrices. In
this work we focus on the Lovász theta SDP, see (PG ) in

4

Appendix B. The proof of our main result involves two
main steps. First, we construct a dual optimal solution
of (DG ) for an odd-cycle graph by providing an expli-
cit mapping between the Gram vectors of a primal (PG )
optimal solution of an odd-cycle graph and the Gram vec-
tors of a dual optimal solution of the complement graph;
see Theorem 2 for details. Next, once we construct a
dual optimal solution, we show in Theorem 3 that it sat-
isﬁes the non-degeneracy conditions given in (B3). By
Theorem 1 , this shows that anti-hole inequalities admit
robust self-testing. Details of the proofs can be found
in Appendix C. Additionally, we show that not all graphs
admit self-testing by providing a counter example of such
a graph (see Appendix F). The overall scheme for de-
termining whether a graph is self-testable (equivalently
whether the primal optimal solution of the Lovász theta
SDP corresponding to that graph is unique or not) is
provided in the form of a ﬂowchart in Figure 3.

Figure 3. Flowchart for determining (non)uniqueness of
primal solution(s). The (∗) refers to the fact that one can
still hope to arrive at a deﬁnitive answer by restarting the
algorithm using a diﬀerent dual optimal solution (if it exists).

Acknow ledgements.— We thank the National Research
Foundation of Singapore, the Ministry of Education of
Singapore, MINECO Pro ject No. FIS2017-89609-P with
FEDER funds, and the Knut and Alice Wallenberg
Foundation for ﬁnancial support. A signiﬁcant part of
the research pro ject Local certiﬁcation of programmable
quantum devices of arbitrary high dimensionalitywas car-
ried out during “New directions in quantum information”
conference organized by Nordita, the Nordic Institute for
Theoretical Physics.

Given a pair of primal dual optimal solutions   (X*, Z*)Does strict-complimentarity  hold ?Is Z* non-degenerate?Is Z* non-degenerate?Yes Yes X*  is unique NoNoX* is not unique Yes X*  is unique Inconclusive*Nohttp://www.sciencedirect.com/science/article/
pii/037596019290711T.

[6] McKague, M., Yang, T. H. & Scarani, V. Robust self-
testing of the singlet. J. Phys. A 45, 455304 (2012).
[7] Bugliesi, M., Preneel, B., Sassone, V. & Wegener, I.
Automata, Languages and Programming: 33rd Interna-
tional Col loquium, ICALP 2006, Venice, Italy, July 10-
14, 2006, Proceedings, vol. 4051 (Springer, 2006).
[8] Tsirel’son, B. S. Quantum analogues of the bell inequalit-
ies. the case of two spatially separated domains. J. Soviet
Math. 36, 557–570 (1987).
[9] Summers, S. J. & Werner, R. Bell’s inequalities and
quantum ﬁeld theory. i. general setting. J. Math. Phys.
28, 2440–2447 (1987).
[10] Bell, J. S. On the einstein podolsky rosen para-
dox.
Physics (Long Island City, N.Y.) 1, 195–200
(1964).
URL https://link.aps.org/doi/10.1103/
PhysicsPhysiqueFizika.1.195.

[11] Bharti, K. et al. Robust self-testing of quantum sys-
tems via noncontextuality inequalities. Phys. Rev. Lett.

122, 250403 (2019). URL https://link.aps.org/doi/
10.1103/PhysRevLett.122.250403.

[12] Kochen, S. & Specker, E. P. The problem of hidden
variales in quantum mechanics. J. Math. Mech. 17, 59–
87 (1967).
[13] Cabello, A., Severini, S. & Winter, A. Graph-theoretic
approach to quantum correlations. Phys. Rev. Lett. 112,

[1] Mayers, D. & Yao, A. Self testing quantum apparatus.
Quantum Info. Comput. 4, 273–286 (2004). URL http:
//dl.acm.org/citation.cfm?id=2011827.2011830.

[2] Mayers, D. & Yao, A. Quantum cryptography with
imperfect apparatus. In Proceedings 39th Annual Sym-
posium on Foundations of Computer Science (Cat. No.
98CB36280), 503–509 (IEEE, 1998).
[3] Šupić, I. & Bowles, J. Self-testing of quantum systems:
a review. arXiv preprint arXiv:1904.10042 (2019).
[4] Reichardt, B. W., Unger, F. & Vazirani, U. Classical
command of quantum systems. Nature 496, 456 (2013).
[5] Popescu, S. & Rohrlich, D. Generic quantum non-
locality. Phys. Lett. A 166, 293–297 (1992). URL

040401 (2014). URL https://link.aps.org/doi/10.
1103/PhysRevLett.112.040401.

[14] Clauser, J. F., Horne, M. A., Shimony, A. & Holt, R. A.
Proposed experiment to test local hidden-variable theor-
ies. Phys. Rev. Lett. 23, 880–884 (1969). URL https:

//link.aps.org/doi/10.1103/PhysRevLett.23.880.

[15] Klyachko, A. A., Can, M. A., Binicioğlu, S. &
Shumovsky, A. S.
Simple test for hidden variables
in spin-1 systems.
Phys. Rev. Lett. 101, 020403
(2008).
URL https://link.aps.org/doi/10.1103/
PhysRevLett.101.020403.

[16] Cabello, A., Danielsen, L. E., López-Tarrida, A. J. &
Portillo, J. R. Basic exclusivity graphs in quantum cor-
relations. Physical Review A 88, 032104 (2013).
[17] Chudnovsky, M., Robertson, N., Seymour, P. & Thomas,
R. The strong perfect graph theorem. Annals of math-
ematics 51–229 (2006).
[18] Bharti, K., Arora, A. S., Kwek, L. C. & Roland, J. A
simple proof of uniqueness of the kcbs inequality. arXiv
preprint arXiv:1811.05294 (2018).
[19] Gottesman, D. as it has been referenced in the following

5

blog [http://www.scottaaronson.com/blog/?p=284; ac-
cessed 13-apr-2017 (2004).
[20] Broadbent, A., Fitzsimons, J. & Kasheﬁ, E. Universal
blind quantum computation. In 2009 50th Annual IEEE
Symposium on Foundations of Computer Science, 517–
526 (IEEE, 2009).
[21] Fitzsimons, J. F. & Kasheﬁ, E. Unconditionally veriﬁ-
able blind quantum computation. Physical Review A 96,
012303 (2017).
[22] Aharonov, D., Ben-Or, M., Eban, E. & Mahadev, U.
Interactive proofs for quantum computations. arXiv pre-
print arXiv:1704.04487 (2017).
[23] Aharonov, D., Ben-Or, M. & Eban, E. Interactive proofs
for quantum computations. Tech. Rep. (2008).
[24] Mahadev, U. Classical veriﬁcation of quantum computa-
tions. In 2018 IEEE 59th Annual Symposium on Found-
ations of Computer Science (FOCS), 259–267 (IEEE,
2018).
[25] Kleinmann, M., Guehne, O., Portillo, J. R., Larsson, J.-
Å. & Cabello, A. Memory cost of quantum contextuality.
New Journal of Physics 13, 113011 (2011).
[26] Fagundes, G. & Kleinmann, M. Memory cost for sim-
ulating all quantum correlations from the peres–mermin
scenario. Journal of Physics A: Mathematical and The-
oretical 50, 325302 (2017).
[27] Cabello, A., Gu, M., Gühne, O. & Xu, Z.-P. Optimal
classical simulation of state-independent quantum con-
textuality. Physical review letters 120, 130401 (2018).
[28] Budroni, C. Contextuality, memory cost and non-
classicality for sequential measurements. Philosophical
Transactions of the Royal Society A 377, 20190141
(2019).
[29] Cabello, A., Gu, M., Gühne, O., Larsson, J.-Å. & Wies-
ner, K. Thermodynamical cost of some interpretations of
quantum theory. Physical Review A 94, 052127 (2016).
[30] Malinowski, M. et al. Probing the limits of correlations
in an indivisible quantum system. Physical Review A 98,
050102 (2018).
[31] Knuth, D. E. The sandwich theorem. The Electronic
Journal of Combinatorics 1, 1 (1994).
[32] Lovász, L. On the shannon capacity of a graph. IEEE
Trans. Inf. Theory 25, 1–7 (1979).
[33] Alizadeh, F., Haeberly, J.-P. A. & Overton, M. L.
Complementarity and nondegeneracy in semideﬁnite pro-
gramming. Math. Program. 77, 111–128 (1997).
[34] Thinh, L. P., Varvitsiotis, A. & Cai, Y. Structure of the
set of quantum correlators via semideﬁnite programming.
arXiv preprint arXiv:1809.10886 (2018).

Appendix A: Semideﬁnite programming basics

A semideﬁnite program (SDP) is given by an optim-
isation problem of the following form

(cid:8)(cid:104)C, X (cid:105) : X ∈ S n
+ , (cid:104)Ai , X (cid:105) = bi (i ∈ [m])(cid:9) ,

(P)

sup

X

where S n
+ denotes the cone of n×n real positive semideﬁn-
ite matrices and (cid:104)X, Y (cid:105) = tr(X T Y ). The corresponding

dual problem is given by

(cid:40) m(cid:88)

m(cid:88)

(cid:41)

.

(D)

yiAi − C = Z ∈ S n

+

inf

y ,Z

bi yi

:

i=1

i=1

A pair of primal-dual optimal solutions (X ∗ , Z ∗ ) with no
duality gap (i.e. tr(X ∗Z ∗ ) = 0), satisﬁes strict comple-
mentarity if

rank(X ∗ ) + rank(Z ∗ ) = n.

(A1)
Lastly, an optimal dual solution Z ∗ is called dual nonde-
generate if the linear system in the symmetric matrix
variable M

M Z ∗ = Tr(M A1 ) = . . . = Tr(M Am ) = 0,

only admits the trivial solution M = 0.
Central to this work is the Lovász theta SDP corres-
ponding to a graph G, whose primal formulation is:

n(cid:88)

i=1

Xii

ϑ(G) = max
s.t. Xii = X0i , i ∈ [n],
Xij = 0, i ∼ j,
X00 = 1, X ∈ S 1+n
+ ,

and the dual formulation we use is given by:

ϑ(G) = min Z00
s.t. Zii = −(2Z0i + 1), i ∈ [n],
Zij = 0, i (cid:28) j,
Z ∈ S 1+n
+ .

Appendix B: Robust self-testing

(PG )

(DG )

(cid:80)

To prove our main result we use the following
deﬁnitions from [11]. A non-contextuality inequality
i∈[n] wipi ≤ Bnc (Gex , w) is a self-test for the realisa-
tion {|ui (cid:105)(cid:104)ui |}n
i=0 if:
1. {|ui (cid:105)(cid:104)ui |}n
i=0 achieves

the quantum supremum

Bqc (Gex , w);

2. For any other realisation {|u(cid:48)
i (cid:105)(cid:104)u(cid:48)
achieves Bqc (Gex , w), there exists an isometry V
i=0 that also
such that

i |}n

i |,

(cid:80)

0 ≤ i ≤ n.

V |ui (cid:105)(cid:104)ui |V † = |u(cid:48)

i (cid:105)(cid:104)u(cid:48)
Furthermore,
non-contextuality
inequality
is an (, r)-robust self-
test for {|ui (cid:105)(cid:104)ui |}n
i=0 if it is a self-test, and furthermore,
for any other realisation {|u(cid:48)
i (cid:105)(cid:104)u(cid:48)
i=0 satisfying

i∈[n] wipi ≤ Bnc (Gex , w)

i |}n

(B1)

a

wi |(cid:104)u(cid:48)
i |u(cid:48)

0 (cid:105)|2 ≥ Bqc (Gex , w) − ,

n(cid:88)

i=1

6

there exists an isometry V such that
(cid:107)V |ui (cid:105)(cid:104)ui |V † − |u(cid:48)
i (cid:105)(cid:104)u(cid:48)
The proof of our main result hinges on the following
theorem (ﬁrst introduced in [11]):

i |(cid:107) ≤ O (r ) ,

0 ≤ i ≤ n.

(B2)

Theorem 1. Consider a non-contextuality inequality

i=1 wipi ≤ Bnc (Gex , w). Assume that

1. There

{|ui (cid:105)(cid:104)ui |}n

exists an optimal
i=0 such that

quantum realisation

(cid:80)n

(cid:88)

wi |(cid:104)ui |u0 (cid:105)|2 = Bqc (Gex , w)

i

and (cid:104)u0 |ui (cid:105) (cid:54)= 0, for al l 1 ≤ i ≤ n, and
2. There exists a dual optimal solution Z ∗ for the SDP
(DG ) such that the homogeneous linear system

M0i = Mii , for al l 1 ≤ i ≤ n,
Mij = 0, for al l i ∼ j,
M Z ∗ = 0,

(B3)

in the symmetric matrix variable M only admits
the trivial solution M = 0.

Then, the non-contextuality inequality is an (, 1
2 )-robust
self-test for {|ui (cid:105)(cid:104)ui |}n

i=0 .

Appendix C: Self-testing anti-hole inequalities

(cid:0)Cn

by (cid:80)n
(cid:1). The quantum bound
The anti-hole non-contextuality inequalities are given
i=1 pi ≤ 2 for all p ∈ Pnc
for the anti-hole inequalities, i.e., the Lovász theta num-
ber for Cn is 1+cos π
[31]. A canonical quantum ensemble
which achieves the quantum value for the anti-hole in-
equalities corresponding to odd n is given by n − 2 di-
mensional quantum state and pro jectors. Explicitly, the
quantum state is

cos π

n

n

|v0 (cid:105) = (1, 0, · · · , 0)T ,

(C1)
but the description of the pro jectors {Πj = |vj (cid:105)(cid:104)vj |}n
is more involved [16]. Let us denote the k-th compon-
ent of |vj (cid:105) corresponding to pro jector Πj as vj,k . For
0 ≤ j ≤ n − 1 and 0 ≤ k ≤ n − 3,

j=1

(cid:115)

vj,0 =

ϑ(Cn )
n

vj,2m−1 = Tj,m cos Rj,m

vj,2m = Tj,m sin Rj,m

(C2)

(C3)

(C4)

2

and

for m = 1, 2, · · · n−3
(cid:118)(cid:117)(cid:117)(cid:116) 2 cos( π
n ) + (−1)m+1 cos
n cos π

Tj,m = (−1)j (m+1)

n

Rj,m =

j (m + 1)π
n

.

(cid:16) (m+1)π
n

(cid:17)

,

(C5)

(C6)

For the anti-hole non-contextuality inequalities, the en-
semble described above achieves the quantum value and
satisﬁes the ﬁrst condition of Theorem 1. It remains to
establish the existence of a dual optimal solution for the
SDP corresponding to the Lovász theta number of anti-
hole graphs such that the conditions in (B3) are satisﬁed.
Towards this goal, we ﬁrst proceed to provide the explicit
form of the dual optimal solution.
Theorem 2. Let X ∗ = Gram(v0 , v1 , · · · , vn ) be the
unique optimal solution for (PCn ). Then,
Z ∗
is a dual optimal solution for (DCn
pression for Z ∗
n is given by:

n = ϑ(Cn )Gram(−v0 , v1 , · · · , vn ),
(cid:20) ϑ(Cn ) −e(cid:62)

). Another useful ex-

(cid:21)

∈ R(1+n)×(1+n) ,

(C7)

Z (cid:63)
n =

−e

circ(u)

where e is the vector of al l ones of length n,

u = (1, ϑ(Cn )(cid:104)v1 |v2 (cid:105), · · · , ϑ(Cn )(cid:104)v1 |vn (cid:105)),

and circ(·) maps an n-dimensional vector and outputs the
corresponding circulant matrix.
optimal solution X ∗ . For any k = 0, 1, . . . , n − 1, the
Proof. It was shown in [11] that (PCn ) admits a unique
map taking i → i + 1 (modulo n) is an automorph-
ism of Cn (i.e., a bijective map that preserves adjacency
and non-adjacency). In particular, this implies that X ∗
is circulant and furthermore, constant along each band.
Speciﬁcally, all diagonal entries of X ∗ are equal, and as
ii , it follows that

ϑ(Cn ) = (cid:80)

i=1 X ∗

(cid:104)vi |vi (cid:105) = X ∗
ii = ϑ(Cn )/n.

(C8)
Analogously, for a pair of indices i, j with |i − j | = k we
have that X ∗
ij = (cid:104)v1 |vk+1 (cid:105). Moreover, be feasibility of
X ∗ we have that X ∗
has the correct value and it remains to show that Z ∗ is
feasible. Next, by feasibility of X ∗ we have that X ∗
(cid:104)vi |vj (cid:105) = 0, when i ∼ j in Cn . Thus, by deﬁnition of Z ∗
ij = ϑ(Cn )(cid:104)vi |vj (cid:105) = 0 for all edges of Cn .
we have that Z ∗
Finally we show that Z ∗

00 = (cid:104)v0 |v0 (cid:105) = 1. Thus Z ∗
00 = ϑ(Cn )

ii = −(2Z ∗
0i + 1), i ∈ [n]. Indeed,
ii = (cid:104)vi |vi (cid:105)ϑ(Cn ) =
ϑ(Cn )
n

ϑ(Cn ) = 1,

ij =

Z ∗

where we used (C8) and that ϑ(Cn )ϑ(Cn ) = n (see The-
orem 8 of [32]). To ﬁnish the proof we note that

−(2Z ∗
0i + 1) = −(2ϑ(Cn )(cid:104)−v0 |vi (cid:105) + 1)
= 2ϑ(Cn )(cid:104)v0 |vi (cid:105) − 1
= 2ϑ(Cn )(cid:104)vi |vi (cid:105) − 1
= 1.

7

(C9)

where the second last equality follows from the constraint
that (cid:104)v0 |vi (cid:105) = (cid:104)vi |vi (cid:105) for i ∈ [n] and the last equality
follows by substituting (cid:104)vi |vi (cid:105)ϑ(Cn ) = 1.
Finally, we show that the dual optimal solution satisﬁes
the conditions in B3.
Theorem 3. The dual optimal solution Z ∗ , correspond-
ing to the complement of an odd-cycle graph satisﬁes the
conditions in B3.

Proof. We show that for any odd n, the only symmetric
matrix M ∈ R(1+n)×(1+n) satisfying

M00 = 0, M0i = Mii , Mij = 0 (∀ i ∼ j ), M Z ∗ = 0,

(C10)
is the matrix M = 0, where i ∼ j here refers to an edge in
the Cn graph. Barring the M Z ∗ = 0 constraint, the rest
already guarantee that there are at most 2n potentially
non-zero entries in the M matrix (not counting the re-
peated entries) corresponding to Cn graph. Let the ﬁrst
row of M be (0, m1 , m2 , · · · , mn ). We ﬁll the rest of the
potential non-zero slots in M with mn+1 , mn+2 , · · · , m2n .
For example for n = 7, we have

0 m1 m2 m3 m4 m5 m6 m7
m1 m1 m8
0
0
0
0 m14
m2 m8 m2 m9
0
0
0
0
m3
0 m9 m3 m10
0
0
0
m4
0
0
0
m5
0
0
m6
0

0 m10 m4 m11
0 m11 m5 m12
0 m12 m6 m13

m7 m14

0

0 m13 m7

(cid:16) q r(cid:62)

(cid:17)

(C11)
For notational convenience, let M Z ∗ =
, where
T ∈ Rn×n , q ∈ R and r ∈ Rn×1 .
In the rest of this
section we use the notation i to denote i mod n, where
i is an integer. The linear equation corresponding to q
implies that

r T

mi = 0.

(C12)

i=1

For i ∈ {1, 2, · · · , n}, the 2n linear equations correspond-
ing to Ti,i+1 and Ti,i−1 imply

mn+1 = mn+2 = · · · = m2n .

(C13)

Now consider the n linear equations corresponding to r .
These equations along with C13 imply

m1 = m2 = · · · = mn .

(C14)

 ,



M7 =

0
0
0

0
0

n(cid:88)

Using C14 along with C12 we have

m1 = m2 = · · · = mn = 0.

(C15)
Finally, using the equations corresponding to r again and
C15 we have

mn+1 = mn+2 = · · · = m2n = 0,

(C16)

implying that M = 0, as desired.

Appendix D: Dimension for optimal violation of
anti-hole inequalities

Theorem 4. Given an anti-hole non-contextuality in-
equality with an odd number of n measurement events, the
quantum system achieving the optimal quantum bound
must be at least (n − 2) dimensional.
Proof. The value of a non-contextuality inequality
achievable within quantum theory is equal to the Lovász
theta number of the underlying graph G and admits the
SDP formulation (PG ). The lower bound on the dimen-
sion of a quantum system achieving the optimal quantum
bound is the rank of the unique primal optimal matrix

(cid:34)

X (cid:63)
n =

(cid:35)

,

ϑ(Cn )

n e(cid:62)

1
n e

ϑ(Cn )

n , n−ϑ(Cn )
( ϑ(Cn )

2ϑ(Cn )2 , 0, 0, 0, · · · , 0, 0, n−ϑ(Cn )
2ϑ(Cn )2 ). Since X (cid:63)

circ(u)
where e is the all-ones vector of length n, circ(·) is
the circulant function that takes as input a n dimen-
sion vector and outputs a n × n matrix with the in-
put vector as its top row and every subsequent row
being one place right shifted modulo n and u =
n is
real, its rank over complex ﬁeld is the same as over real
ﬁeld, and equals to the number of nonzero eigenvalues
(with multiplicity). Furthermore, a lower bound on the
rank of X (cid:63)
n is given by the rank of the lower right block
matrix (the circulant portion). The eigenvalues of a cir-
culant matrix can be calculated easily using the circulant
vector. A few lines of algebra yields the following expres-
sion for the eigenvalues of the lower right block matrix,

λj =

1
ϑn

+

n − ϑn
ϑn

cos(

2πj
n

)

or n+1

j = n−1

for j ∈ [n] and ϑn denotes the Lovász theta number for
the holes with odd n. One can see that λj (cid:54)= 0 unless
2 . Thus, the rank of the circulant matrix
is n − 2 for all odd values of n. Thus, the lower bound
on the rank of the optimal feasible matrix X (cid:63) is n − 2
which is same as the lower bound on the dimension of
the desired quantum system.

2

Appendix E: Complex versus Real SDPs

Lemma 5. Consider a real SDP

(cid:8)(cid:104)C, X (cid:105) : X ∈ S n
+ , (cid:104)Ai , X (cid:105) = bi (i ∈ [m])(cid:9) ,

sup

X

8

that admits a unique optimal solution X ∗ witnessed by a
dual nondegenerate optimal solution Z ∗ . Then, the SDP
considered over the complex numbers, i.e.,

(cid:8)(cid:104)C, X (cid:105)C : X ∈ Hn

+ , (cid:104)Ai , X (cid:105)C = bi (i ∈ [m])(cid:9) ,

sup

(PC )
stil l admits a unique optimal solution, where (cid:104)X, Y (cid:105)C =
+ denotes the set of n × n Hermitian
positive semideﬁnite matrices.

Tr(X †Y ) and Hn

X

Proof. First, we show that the study of a complex SDP
can be reduced to an equivalent real SDP. This fact is well
known but we provide a brief argument for completeness.
Indeed, for any feasible solution X = XR+iXC ∈ Hn
constraint (cid:104)Ai , X (cid:105)C = bi is equivalent to two constraints
+ , the
on its real and imaginary part, namely: (cid:104)Ai , XR (cid:105) = bi and
(cid:104)Ai , XC (cid:105) = 0. Furthermore, checking whether XR + iXC
is Hermitian PSD is equivalent to

(cid:18)XR −XC
XC XR

(cid:19)

∈ S n

+ .

Based on these observations we deﬁne the realiﬁcation of
(PC ) as the following SDP over the real numbers:

X,Y

(cid:104)C, X (cid:105)
sup
s.t. (cid:104)Ai , X (cid:105) = bi (i ∈ [m])
(cid:104)Ai , Y (cid:105) = 0 (i ∈ [m])

(cid:18)X −Y

(cid:19)

∈ S 2n

+ .

Y X

(PR )

Clearly, the solutions of (PC ) are in bijection with the
solutions of the realiﬁcation, and thus, to show that (PC )
has a unique solution it suﬃces to show that (PR ) has a
unique solution. Bringing (PR ) into standard SDP form
we arrive at the formulation:

whose dual is to minimize the function (cid:80)m
i=1 λi bi over all

+ ,

m(cid:88)
n(cid:88)

λi , µj , tij , zij satisfying
(cid:18)Ai /2
(cid:18)Eij
0
0 Ai /2
0
0 −Eij

(cid:19)
(cid:19)

tij

λi

i=1

+

+

ij=1

m(cid:88)
n(cid:88)

i=1

ij=1

(cid:18) 0 Ai /2
(cid:18) 0 Eij
Ai/2
0
E T
0

(cid:19)

ij

(cid:19)

−

µi

zij

+
(cid:18)C/2
0
0 C/2

(cid:19)

(cid:23) 0.

sup

W

s.t.

• W

(cid:18)C/2
(cid:18)Ai /2
0
0 C/2
(cid:18) 0 Ai /2
0
0 Ai /2
Ai /2
(cid:18) X Y
0
X = Z,
Y + Y T = 0,
Y T Z

(cid:19)
(cid:19)
(cid:19)
(cid:19)

∈ S 2n

W =

• W = bi (i ∈ [m])

• W = 0 (i ∈ [m])

(E1)

(cid:19)

0
0 Y ∗

(cid:18)Y ∗
First, by dual feasibility we have Y ∗ = (cid:80)m
We conclude the proof by showing that
is a
dual nondegenerate optimal solution for the realiﬁcation.
i Ai − C for
appropriate scalars y∗
i . Setting λi = y∗
(cid:18)X ∗ 0
i and all other dual
variables to zero, we have established feasibility. Second,
(cid:18)X ∗ 0
(cid:18)Y ∗
to show optimality note that
is optimal for the
realiﬁcation, and furthermore,
Lastly, to check nondegeneracy consider a symmetric
matrix M =
satisfying

(cid:19)
(cid:19)

0
0 Y ∗

i=1 y∗

(cid:19)

= 0.

•

0

0

0

0

(cid:19)

(cid:18) M1 M2
M T
(cid:18) M1 M2
M T

2 M3

2 M3

(cid:19) (cid:18)Y ∗

(cid:19)

0 =
(cid:18)Ai /2
(cid:18)Eij
0
0 Ai/2
0
0 −Eij

(cid:19)
(cid:19)

0
0 Y ∗
(cid:18) 0 Ai /2
= M •
(cid:18) 0 Eij
Ai /2
0
E T
0

(cid:19)

.

= M •

ij

(cid:19)

=

(E2)

(E3)

and

0 = M •

= M •

Now, constraint (E2) is equivalent to

M1Y ∗ = M2Y ∗ = M3Y ∗ = 0.

Furthermore, using (E3), from the third equation we get
M1 = M3 , from the ﬁrst one we get (cid:104)M1 , Ai (cid:105) = 0 and
from the second one (cid:104)M2 , Ai (cid:105) = 0. Summarizing, for all
k = 1, 2, 3 we have that

MkZ ∗ = 0 and (cid:104)Mk , Ai (cid:105) = 0 (i ∈ [m]).

As Z ∗ is dual nondegenerate it has the property that for
any M ∈ S n :

6(cid:88)

Theorem 6. Let (X ∗ , Z ∗ ) be a pair of primal and dual
optimal solutions satisfying strict complementarity.Then,
uniqueness of X ∗ implies that Z ∗ is dual nondegenerate.

9

The exclusivity graph of our counter-example is
shown in Figure 4. The corresponding canonical non-
contextuality inequality is given by

pi ≤ 2,

(F1)

whose quantum bound is equal to

√

5.

i=1

Figure 4. The above exclusivity graph corresponds to the
canonical non-contextuality inequality with minimal number
of measurement events which doesn’t admit self-testing.

Consider the pair of primal-dual optimal solutions



√
−1
−1
−1
−1
−1
−1

5 −1 −1 −1 −1 −1 −1
1
0
c
c
0
c
0
1
0
c
c
c
c
0
1
0
c
0
c
c
0
1
0
1
0
c
c
0
1
0
c
c
0
1
0
1

 ,

where c =

√

5−1
2

and

(F2)

(F3)

M Z ∗ = (cid:104)M , Ai (cid:105) = 0 ∀i =⇒ M = 0.

Z (cid:63) =

Putting everything together we get M1 = M2 = M3 = 0.

Appendix F: Not all non-contextuality inequalities
admit self-testing

We
have
proved
that
all
fundamental
non-
contextuality inequalities admit self-testing. A natural
question is whether every non-contextuality inequality
with separation between corresponding non-contextual
hidden variable bound and quantum bound admits self-
testing. Below we provide an explicit non-contextuality
inequality which shows that the answer is negative. In
graph theoretical terms, we identify a non-perfect graph
whose Lovász theta SDP admits multiple primal optimal
solutions. We make crucial use of the following result
[33, Theorem 5] to determine the (non)uniqueness of
primal optimal under strict complementarity, see also
[34].

 ,



X (cid:63) =

1 f f f h f h
f f k 0 0 k 0
f k f k 0 0 0
f 0 k f r 0 r
h 0 0 r h r 0
f k 0 0 r f r
h 0 0 r 0 r h
2 , k = 5−√
, h = f

10

5

5

where f = 1√
and r = k
2 . Since
rank(Z ∗ ) = 3 and rank(X )(cid:63) = 4, strict complementarity
holds. Using Theorem 6, the uniqueness of X ∗ implies
dual nondegeneracy. To determine dual nondegeneracy
for Z ∗ we (once again) resort to solving system of linear

equations. The symmetric variable matrix M is given by



M =

0 m0 m1 m2 m3 m4 m5
m0 m0 m6
0
0 m7
0
m1 m6 m1 m8
0
0
0
m2
0 m8 m2 m9
0 m10
m3
0
0 m9 m3 m11
0
m4 m7
0
m5
0
0 m10

0 m11 m4 m12

0 m12 m5

 ,

(F4)

m9 = −m12 , m3 = − (cid:16) 1+

(cid:17)

√

5

10

m12 , m0 = m1 = m2 =

2

m4 = m6 = m7 = m8 = 0. For example, if we set
m12 = 1, we can get a consistent assignment of mi , from
i = 0 to 12, which isn’t all zero. Hence, the dual solu-
tion Z ∗ is degenerate, which together with strict comple-
mentarity implies that the primal is not unique. Thus
the non-contextuality inequality in (F1) does not admit
self-testing.
We also report that we found several other non-perfect
graphs (and equivalently non-contextuality inequalities)
which do not admit self-testing.
Identifying the exact
classes of graphs which admit self-testing will be inter-
esting but we leave that as an open question.

Solving for the linear systems of equations Z (cid:63)M = 0,
√

we get m11 = −m12 , m10 = m12 , m5 = 1+

2 m12 ,
5

