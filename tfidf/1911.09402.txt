Max-Min Fair Precoder Design for Non-Orthogonal
Multiple Access

Ahmet Zahid Yalcin and Melda Yuksel IEEE, Senior Member

1

9
1
0
2

v
o

N

1
2

]

P
S

.

s
s

e
e

[

1
v
2
0
4
9
0

.

1
1
9
1

:

v

i

X

r

a

Abstract—In this paper, a downlink multiple input multiple
output (MIMO) non-orthogonal multiple access (NOMA) wireless
communication system is considered. In NOMA systems, the base
station has unicast data for all users, and multiple users share the
same resources. Maximizing the minimum cluster rate amongst
multiple NOMA clusters through transmit precoding under
quality-of-service (QoS) and total transmit power constraints
is investigated. It is ﬁrst shown that maximizing the minimum
cluster rate and minimizing the maximum weighted cluster
mean square error problems lead to the same optimal point.
For the latter problem, Karush-Kuhn-Tucker (KKT) optimality
conditions are derived and the expressions satisﬁed by the optimal
receivers, minimum mean square error (MMSE) weights and
the optimal precoders are obtained. Then, an iterative and
low complexity transmit precoder design algorithm is proposed.
Simulation results show that the proposed algorithm signiﬁcantly
outperfoms orthogonal multiple access (OMA) and multi-user
linear precoding (MULP) schemes.

Index Terms—Max-min fairness, mean square error, MIMO,
NOMA, precoder design, quality-of-service.

I . INTRODUCT ION

The demand for data trafﬁc is steadily increasing and
wireless networks of the next decade have to meet the high
data rate requirements for many different applications [1].
To handle this high data rate, non-orthogonal multiple access
(NOMA) is considered as a breakthrough technique, which
enables simultaneous multiple access in the power domain
for 5G wireless networks [2]. Speciﬁcally, downlink NOMA
is an application of broadcast channels [3] and it relies on
superposition coding (SPC) at the transmitter to transfer mul-
tiple data streams in the same resource block, and successive
interference cancellation (SIC) at the receiver to cancel co-
channel interference. NOMA has the potential to deliver higher
system throughput [4], [5] and higher ergodic sum capacity
[6], and to achieve better outage performance [7] compared to
the existing orthogonal multiple access (OMA) techniques.
In NOMA systems, each user can have a dedicated precod-
ing vector, or a cluster of users can share the same precoding
vector. The former has the advantage of custom precoding for
each user, but suffers from the rank constraints in the downlink
multiuser MIMO broadcast channel [8]. The latter is not
limited by rank, but messages are not individually precoded,
so channel gain vectors and precoders are mismatched.
Assuming the transmit signals of each user are coded by
a dedicated precoding vector, sum rate maximization, total
power minimization and max-min fairness for NOMA systems
are studied under different constraints and with different
methods in the literature. The paper [8] solves the sum rate
maximization problem by approximating the problem with a
minorization-maximization algorithm (MMA). The paper [9]

presents a precoding design for maximizing the sum rate of all
users under decoding order and quality-of-service (QoS) con-
straints. Similarly, to maximize sum rate, [10] studies the chan-
nel state information (CSI) based singular value decomposition
(CSI-SVD) precoding scheme. Total power minimization with
QoS requirements and total power minimization under target
interference level constraints are respectively investigated in
[11] and [12]. Fairness in NOMA systems are studied in [13]
and [14], but both are for single-antenna base stations, and
the latter assumes only 2 users. Max-min fairness for non-
clustered NOMA for a multiple antenna base station is studied
in [11].
As mentioned above, in NOMA, a single precoder vector
can be shared by a cluster of users. For this case, weighted
sum rate optimization under a total power constraint when
two users exist in each cluster is studied in [15]. For clustered
downlink NOMA systems, a sub-optimal user clustering al-
gorithm is proposed and the optimal power allocation policy
that maximizes the weighted sum rate is derived in [16].
Similarly, [17] maximizes strong users’ sum rate subject
to QoS constraints on weak users’ rates. Minimizing total
transmission power for downlink clustered NOMA is studied
in [18] and [19].
In this work, we study fairness for a downlink MIMO
NOMA system, where the base station broadcasts precoded
and superposed signals to clusters of users. To the best of
our knowledge, there is no precoding study on fairness for
clustered downlink NOMA. In our problem, the objective
is to maximize the minimum cluster rate under QoS and
total transmit power constraints. Due to the non-convexity of
maximizing the minimum cluster rate problem, we use the
equivalence between maximizing the minimum cluster rate and
minimizing the maximum weighted cluster mean square error
problems at the optimal point. We ﬁrst prove that these two
problems lead to the same optimal solution. Employing the
KKT optimality conditions, we ﬁnd the expressions the opti-
mal receivers, minimum mean square error (MMSE) weights
and the optimal precoders have to satisfy. Utilizing these
expressions, we propose an iterative algorithm to evaluate the
optimal precoders and the optimal receivers. We use the expo-
nential penalty method to evaluate the Lagrange multipliers.
We ﬁnd that the proposed alternating optimization algorithm
signiﬁcantly improves the minimum cluster rate performance
with respect to OMA and multi-user linear precoding (MULP)
schemes.
Next, we explain the system model in Section II. We deﬁne
the optimization problems in Section III, and propose the
precoder design in Section IV. We present
the numerical
results in Section V. Finally we provide conclusions and future

 
 
 
 
 
 
work in Section VI.

I I . SY S T EM MODE L

In this paper we study a downlink multiuser MIMO system.
The base station has M transmit antennas and communicates
with K clusters. There are L single antenna users in each
cluster1 . Each user belongs to only one cluster.
The
base
station
aims
to
send
the
data
s1,1 , . . . , sk,l , . . . sK,L to all K L users. Here sk,l represents
the data stream intended for the l-th user in the k -th cluster.
All sk,l are independent and E{sk,l s∗
k,l} = αk,l , where αk,l
is the ratio of power allocated to data stream for the l-th user
in the k -th cluster. Moreover, PL
l=1 αk,l = 1. To send all
the messages, the base station superposes all the messages
in a cluster and forms s = [s1 , . . . , sK ]T ∈ CK×1 , where
l=1 sk,l . When pk ∈ CM ×1 indicates the precoder
vector for the k -th cluster, the base station transforms s with
the precoder matrix P = [p1 , . . . , pK ] ∈ CM ×K . Then, the
base station transmits x ∈ CM ×1 , which is equal to

sk = PL

K

K

L

x = Ps =

pk sk =

pk sk,l .

(1)

Xk=1

Xk=1

Xl=1

The base station has an average total power constraint Etx ,
which is written as

E{xH x} = Tr(PPH ) ≤ Etx .

(2)

Then, the received signal at the l-th user in the k -th cluster
becomes

yk,l = hk,lpk

sk,l + hk,l

L

Xl=1

K

Xi=1,i6=k

pi si + nk,l .

(3)

Here, hk,l ∈ C1×M is the effective channel gain vector
of the l-th user in the k -th cluster. The effective channel
gain is deﬁned as hk,l = ˜hk,l /qdρ
k,l , where dk,l
is the
distance between the l-th user in the k -th cluster and the
base station, and ρ is the path loss exponent. The entries
in ˜hk,l are independent and identically distributed (i.i.d.) and
complex valued random variables. The noise component nk,l
is a circularly symmetric complex Gaussian random variable
with zero mean and unit variance, and nk,l are i.i.d. for all k
and l . The base station is informed about all effective channel
gains hk,l , while the receivers know only their own hk,l .

A. Achievable Data Rates

For the clustered NOMA system we investigate, the mes-
sages for different clusters will be treated as noise, while
SIC will be carried out within a cluster to limit intra-cluster
interference. Due to SIC, in the k -th cluster, the l-th user’s
message is decoded at the i-th user, for which l ≤ i. In other
words, the ﬁrst user in the cluster decodes its own message
only, and the L-th user decodes all user’s messages within
the cluster. Moreover, decoding is ordered and starts from

1 In fact, the results can easily be extended to cover for unequal number
of users in each group. However, to keep the notation simple we adhere to a
ﬁxed number of users in each cluster.

2

the ﬁrst user’s message. Then, for this NOMA system, the
signal to interference ratio (SINR) for decoding the l-th user’s
message at the i-th user in the k -th cluster, i = 1, . . . , L, l =

1, . . . , i, k = 1, . . . , K can be written as

γk,i→l = αk,l |hk,ipk |2 r−1

k,i→l .

(4)

In the above equation, rk,i→l is the effective noise variance
and is deﬁned as

rk,i→l =

L

Xj=l+1

αk,j |hk,ipk |2 + Ik,i + 1,

(5)

where, Ik,i = PK
t=1,t6=k |hk,ipt |2 and is equal to the inter-
cluster interference at user-i in the k -th cluster. Then, in the
k -th cluster, the i-th user’s achievable rate for decoding the
l-th user’s message is

Rk,i→l = log (1 + γk,i→l ) .

(6)

Overall, the achievable rate for the l-th user’s message in the
k -th cluster is deﬁned as the minimum of all Rk,i→l , and is
denoted as

Rk,l = min

i,i∈{l,...,L}

Rk,i→l .

(7)

B. Error Variance Deﬁnitions

It is well known that mutual information and minimum
mean square error (MMSE) are related [20], [21], and we
can state Rk,l in terms of error variances, assuming MMSE
receivers are employed at the receivers.
To estimate the l-th user’s message, the i-th user in the k -
th cluster employs the SIC receiver Vk,i→l on its equivalent
received signal as

ˆsk,i→l = Vk,i→l (cid:16)yk,i − hk,ipk

l−1
Xj=1

sk,j (cid:17)

(8)

and obtains its estimate ˆsk,i→l . Then, the MSE of the i-th
user’s estimate of the l-th user’s message in the k -th cluster
becomes

εk,i→l = E(cid:8)||ˆsk,i→l − sk,l ||2 (cid:9),

= |Vk,i→l |2Tk,i→l + αk,l − 2R {αk,l Vk,i→l hk,ipk } ,

(9)

(10)

where

Tk,i→l = |hk,ipk |2αk,l + rk,i→l .

Given above, the optimal MMSE receiver can be written as

V mmse

k,i→l = arg min

Vk,i→l

εk,i→l

= αk,lpH
k hH

k,i T −1

k,i→l .

(11)

When this MMSE receiver in (11) is employed, the resulting
error variance expression in (9) becomes

εmmse

k,i→l = (cid:18) 1

αk,l

k,i→l(cid:19)−1
+ |hk,i pk |2 r−1

.

(12)

3

As the message for the l-th user has to be decoded by all users
i for which i ≥ l in the k -th cluster, we deﬁne εmmse
as

k,l

εmmse
k,l

= max

i,i∈{l,...,L}

εmmse
k,i→l .

(13)

Note that, the rate and MMSE expressions in (6) and (12) are
related, and we can write

Rk,i→l = log hαk,l εmmse−1
k,i→l

i .

(14)

I I I . PROBL EM D E FIN IT ION S

A. Max-Min Fair Sum Rate

In this subsection, we deﬁne the max-min fair (MMF) sum
rate optimization problem, which aims to ﬁnd the optimal
precoder matrix P, such that the minimum of each cluster
rate is maximized subject to a total power constraint and a
minimum rate constraint for each user. The cluster rate is
deﬁned as the sum of the rates of the users in the same cluster.
Then, the optimization problem is stated as

P1 : max

P,R

min

k (cid:16)

L

Xl=1

Rk,l (cid:17)
Rk,l ≤ Rk,i→l ,
Rth
k,l ≤ Rk,l ,

(15a)

s.t.

∀k , l, i = {l, . . . , L} (15b)

∀k , l,
Tr(PPH ) ≤ Etx ,

(15c)

(15d)

where,

Rk,l

is

deﬁned

in

(7),

R
k,l ≥ 0 is
the threshold data rate that user-l in the k -th cluster has to
satisfy.
To solve this problem, we restate the problem by adding
an auxiliary variable c and convert P1 to a new optimization
problem as

=

[R1,1 , . . . , R1,L , . . . , RK,1 , . . . , RK,L ] and Rth

P ′
1 : max

P,R,c

c

(16a)

s.t.

c ≤

L

Xl=1

Rk,l ,

∀k

(16b)

Rk,l ≤ Rk,i→l ,
Rth
k,l ≤ Rk,l ,

∀k , l, i = {l, . . . , L} (16c)

∀k , l
Tr(PPH ) ≤ Etx .

(16d)

(16e)

This problem is still non-convex and hard to solve. Next, we
convert this problem once more into an equivalent WMMSE
problem using the relation between rate and MMSE. To do
that, we introduce the augmented weighted MSE deﬁned as

ξk,i→l = bk,i→l εk,i→l − log(αk,l bk,i→l ),

(17)

where bk,i→l > 0 is introduced as the weight for MSE. We
also deﬁne

ξmmse
k,i→l = bk,i→l εmmse
ξmmse
ξmmse
k,i→l .
k,l

k,i→l − log(αk,l bk,i→l ),

(18)

=

max

i,i∈{l,...,L}

(19)

B. Min-Max Fair WMMSE

Similar to the MMF sum rate problem, the MMF WMMSE
problem is deﬁned as

P2 : min

P,E

max

k (cid:16)

L

Xl=1

ξmmse
k,l

(cid:17)

(20a)

s.t.

ξmmse
k,i→l ≤ ξmmse
k,l
ξmmse
k,l

, ∀k , l, i = {l, . . . , L} (20b)

≤ ξ th
k,l , ∀k , l
Tr(PPH ) ≤ Etx ,

(20c)

(20d)

where E = [ξmmse
K,L ] and
k,l is the threshold error variance for the l-th user’s data in
the k -th cluster.
The problem P2 is not convex. To solve P2 , we restate P2
as a smooth constrained optimization problem by introducing
an auxiliary variable ¯c and write

1,1

, . . . , ξmmse

1,L , . . . , ξmmse

K,1

, . . . , ξmmse

ξ th

P ′
2 : min

P,E,¯c

¯c

(21a)

s.t.

L

Xl=1

ξmmse
k,l

≤ ¯c, ∀k

(21b)

ξmmse
k,i→l ≤ ξmmse
k,l
ξmmse
k,l

, ∀k , l, i = {l, . . . , L} (21c)

≤ ξ th
k,l , ∀k , l
Tr(PPH ) ≤ Etx .

(21d)

(21e)

C. Gradient Expressions for Both MMF Problems

In this subsection, we ﬁnd the gradient expressions and KKT
conditions for the MMF sum rate and the MMF WMMSE
problems respectively deﬁned in (16) and (21). Comparing the
Lagrangian expressions for the two problems, we will prove
that they are equivalent at the optimal solution point.
To solve the problems in (16) and (21), we write the La-
grangian expressions for both problems P ′
1 and P ′
2 respectively
as

f (P, R, c, µ, κ, ψ , λ) = −c +

K

Xk=1

µk c −

K

Xk=1

L

Xl=1

µkRk,l

+

K

Xk=1
Xk=1

L

Xl=1
Xl=1

κk,l (Rth

k,l − Rk,l ) + λ (cid:0)Tr(PPH ) − Etx (cid:1)

+

K

L

L

Xi=l

ψk,i→l (Rk,l − Rk,i→l ) ,

(22)

g (P, E, ¯c, ¯µ, ¯κ, ¯ψ , ¯λ) = ¯c −

K

Xk=1

¯µk ¯c +

K

Xk=1

L

Xl=1

¯µk ξmmse
k,l

+

K

Xk=1
Xk=1

L

Xl=1
Xl=1

¯κk,l (ξmmse
k,l

− ξ th
k,l ) + ¯λ(Tr(PPH ) − Etx )

+

K

L

L

Xi=l

¯ψk,i→l (ξmmse
k,i→l − ξmmse
k,l

),

(23)

where {µ, κ, ψ , λ} and { ¯µ, ¯κ, ¯ψ , ¯λ} denote the Lagrange mul-
tiplier sets for f and g respectively. We derive ∇pk f , ∇pk g
in Appendix A and state them in (24) and (25) as

4

∇pk f (P, R, c, µ, κ, ψ , λ) =

L

Xl=1
Xl=1

L

Xi=l
Xi=l

L

Xj=l+1
ψk,i→l r−1

αk,j ψk,i→l r−2
k,i→l εmmse
k,i→l hH
k,i hk,ipkpH
k hH
k,ihk,ipk + λpk

−

L

L

k,i→l εmmse
k,i→l hH
k,ihk,ipk +

K

Xt=1
t6=k

L

Xl=1

L

Xi=l

ψt,i→l r−2

t,i→l εmmse
t,i→l hH
t,iht,iptpH
t hH
t,iht,ipk ,

(24)

∇pk g (P, R, ¯c, ¯µ, ¯κ, ¯ψ , ¯λ) =

L

Xl=1
Xl=1
Xt=1
t6=k

L

Xi=l
Xi=l
Xl=1

L

Xj=l+1
¯ψk,i→l r−1

αk,j ¯ψk,i→l r−2

k,i→l bk,i→l (εmmse
k,i→l )2hH
k,i hk,ipk pH
k hH
k,ihk,ipk + λpk

−

L

L

k,i→l bk,i→l (εmmse
k,i→l )2hH
k,ihk,ipk

+

K

L

L

Xi=l

¯ψt,i→l r−2

t,i→l bt,i→l (εmmse
t,i→l )2hH
t,iht,iptpH
t hH
t,iht,ipk .

(25)

D. KKT Conditions for Both Problems and Equivalence

For the MMF sum rate problem, in addition to ∇pk f , we
calculate ∂c f and ∂Rk,l f as

∂cf = −1 +

K

Xk=1

µk ,

(26)

∂Rk,l f = −µk − κk,l +

L

Xi=l

ψk,i→l .

(27)

Then, due to the KKT conditions, a local optimum must
satisfy ∇pk f = 0, ∂Rk,l f = 0, ∂c f = 0 and the following
complementary slackness conditions

k "c⋆ −
µ⋆
κ⋆

L

Xl=1
k,l − Rk,i→l (cid:3) = 0,

k,l # = 0,
R⋆
k,l (cid:3) = 0,
) − Etx i = 0,

(28)

k,l (cid:2)Rth
k,l − R⋆
k,i→l (cid:2)R⋆

(29)

ψ⋆

(30)

λ⋆ hTr(P⋆P⋆H
where ⋆ is used to denote the optimal value. In this problem,
we assume the total power constraint is always satisﬁed with
equality, as increasing the power will always increase the
achievable rates. Similarly, for the MMF WMMSE problem

(31)

∂¯c g = 1 −

K

Xk=1

¯µk

(32)

∂ξmmse
k,l

g = ¯µk + ¯κk,l −

L

Xi=l

¯ψk,i→l .

(33)

Then,

a
local optimum must
satisfy ∇pk g = 0,
g = 0, and ∂¯c g = 0. At the locally optimum point
k,i→l , ¯λ⋆(cid:17), due to complementary

∂ξmmse
k,l

(cid:16)P⋆ , ξmmse⋆
k,l

, ¯c⋆ , ¯µ⋆
k , ¯κ⋆

k,l , ¯ψ⋆

slackness, we must have

¯µ⋆

k " L
ξmmse⋆
k,l
k,l (cid:2)ξmmse⋆
k,l
k,i→l (cid:2)ξmmse
k,i→l − ξmmse⋆
k,l

Xl=1

− ¯c⋆# = 0,
− ξ th
k,l (cid:3) = 0,
(cid:3) = 0,
) − Etx i = 0.

(34)

¯κ⋆

(35)

¯ψ⋆
¯λ⋆ hTr(P⋆P⋆H

(36)

(37)

When (24) and (25) are examined, it is observed that if the
weights bk,i→l , for which ¯µk > 0, ¯κk,l > 0 and ¯ψk,i→l > 0,
are chosen such that

bk,i→l =

1

εmmse
k,i→l

,

(38)

then the two equations become equivalent. Note that, when
we employ these weights in the weighted MSE expression
(18), we ﬁnd that ξmmse
k,i→l = 1 − Rk,i→l which accordingly
yields ξmmse
k,l = 1 − Rk,l by deﬁnition. Moreover, we are free
to choose ξ th
k,l . With these relations, the sets of
equations (26)-(31) and (32)-(37) are also equivalent. Thus, the
optimal precoders designed for the MMF sum rate and MMF
WMMSE problems are equal to each other at the optimal
solution point and it is sufﬁcient to design precoders for only
one of the problems.

k,l = 1 − Rth

IV. I T ERAT IVE PRECODER D E S IGN

The problem deﬁned in (21) is hard to solve and there are no
closed form expressions for the optimal precoders. Instead, in
this section we propose an iterative precoder design algorithm.

The optimization problem in (21) assumes that the optimal
MMSE receiver deﬁned in (11) is employed at all users,
and ﬁnds the optimal precoders at the transmitter. Below, we
ﬁrst deﬁne a generalized problem which allows for arbitrary
receivers Vk,i→l that attain εk,i→l in (9).

ξk,l ≤ ¯c, ∀k , l

(39a)

(39b)

Algorithm 1 Proposed MMF WMMSE Algorithm
1: Initialize: ǫ, αk,l , Etx , Υ, ∆, P = Pinit , ν = log(K L)/ǫ
set n = 0;
2: iterate ∀j, l, k ;

5

P3 : min

P,E,¯c,V,b

¯c

L

s.t.

Xl=1

3:

4:

5:

6:

7:

8:

9:

10:

11:

12:

13:

14:

15:

16:

n = n + 1

compute [Vk,i→l ](n) using (41)
compute [εk,i→l ](n) using (9)
compute [bk,i→l ](n) using (38)
compute [Γk,l ](n) using (45)
compute [θk ](n) using (44)
compute [ηk,i→l ](n) using (46)
compute [β ](n) using (42)
compute [P](n) using (43)
scale [P](n) such that Tr([P](n) [P](n)H
If Tr (cid:8)(P(n)
If (39d) satisﬁed then terminate
else then ν = ν + ∆
else then go to Step 2

− P(n−1) )(P(n)

) = Etx

− P(n−1) )H (cid:3)(cid:9) < Υ then

PL

θk =

exp nν (cid:16)PL
l=1 ξk,l − ¯c(cid:17)o
k=1 exp nν (cid:16)PL
l=1 ξk,l − ¯c(cid:17)o
Γk,l = exp (cid:8)ν (cid:0)ξk,l − εth
k,l (cid:1)(cid:9) ,
exp {ν (εk,i→l − εk,l )}
i=l exp {ν (εk,i→l − εk,l )}

PK

ηk,i→l = (θk + Γk,l )

,

(44)

(45)

.

(46)

0, Γk,l ≥ 0, ηk,i→l ≥ 0.

i=l ηk,i→l = Γk,l + θk , θk ≥

In the above equations, ν is a constant and as long as
ν ≥ (log K L)/ǫ, the solution is ǫ-optimal. Note that, this
choice satisﬁes the KKT conditions on {θk , Γk,l , , ηk,i→l }
since PK
k=1 θk = 1, and PL
In each iteration,
the algorithm increases the objective
function since there is a total power constraint. Thus, the
proposed WMMSE algorithm converges to an upper limit. This
limit is within an ǫ neighborhood of a local optimum, as the
algorithm utilizes the equations found via the KKT conditions,
and the exponential penalty method is employed. Following
similar steps as in [21, Section IV-A] and [23], one can prove
convergence in full detail.
Note that, the expressions given in Theorem 1 are valuable
as they signiﬁcantly accelerate Algorithm 1. When these ex-
pressions are used, the algorithm ends in a couple of minutes.
However, if in each iteration of the algorithm, an optimization
toolbox such as CVX [24] is used, the algorithm takes hours
or days.

V. NUMER ICAL RE SULT S

In this section, we present numerical results to evaluate
the performance of the proposed transmission strategy MMF
WMMSE NOMA. In particular, we compute the proposed
transmit precoder using Algorithm 1 and compare it with
orthogonal transmission and multiuser linear precoding.
In the simulations, the entries in ˜hk,l are assumed to be
i.i.d. circularly symmetric complex Gaussian random variables
with zero mean and unit variance, and the users are uniformly
distributed in a circular region. We assume that the path loss

ξk,l ≤ ξ th

ξk,i→l ≤ ξk,l , ∀k , l, i = {l, . . . , L} (39c)
k,l , ∀k , l
Tr(PPH ) ≤ Etx .

(39d)

(39e)

When θk , Γk,l , ηk,i→l and β denote the Lagrange multipliers
for (39) and V and b consist of all receivers Vk,i→l and
weights bk,i→l respectively, the Lagrangian objective function
of (39) is deﬁned as

h(P, R, ¯c, θ, Γ, η , β ) = ¯c −

θk ¯c +

K

Xk=1

K

L

Xk=1

Xl=1

θk ξk,l

+

+

K

K

Xk=1
Xk=1

L

L

Xl=1
Xl=1

Γk,l (ξk,l − ξ th

k,l ) + β (Tr(PPH ) − Etx )

ηk,i→l (ξk,i→l − ξk,l ).

(40)

L

Xi=l

Studying the KKT conditions for (40), similar to the analysis
in the previous section, we can state the following theorem.
Theorem 1: For the optimization problem deﬁned in (39),
the following data receiver Vk,i→l , the Lagrange multiplier β ,
and the transmit precoders P deﬁned in (43) satisfy the KKT
conditions.

Vk,i→l = αk,lpH
k hH
Etx " K
L

β =

1

pk = (cid:20)β I +
+

L

L

L

L

L

(42)

(41)

k,iT −1
Xk=1
Xl=1
Xi=l
Xl=1
Xi=l
Xj=l
Xt=1,t6=k
Xl=1
Xi=l
Xl=1
Xi=l

k,i→l ,
L
ηk,i→l bk,i→l |Vk,i→l |2 # ,
αk,j ηk,i→l bk,i→lhH
k,i |Vk,i→l |2hk,i
t,i |Vt,i→l |2ht,i (cid:21)−1
ηt,i→l bt,i→lhH
k,i→l # .
ηk,i→l bk,i→lαk,lhH
k,iV

(43)

L

L

∗

× " L

k,i→l and

Proof: The proof is provided in Appendix B.
Remark 1: The receiver Vk,i→l in (41) is exactly equal to
the MMSE receiver V mmse
k,i→l given in (11).
Remark 2: When the optimal MMSE receiver V mmse
the weights bk,i→l in (38) are substituted in ξk,i→l of (17),
then ξk,i→l becomes equal to ξmmse
Utilizing Theorem 1, we propose solving for the receivers
(41), the Lagrange multiplier (42) and the precoders (43) in
an iterative fashion in Algorithm 1. However, calculating the
Lagrange multipliers set {θk , Γk,l , ηk,i→l , ∀i, l, k} for problem
(39) in Algorithm 1 is not trivial. In [22], an exponential
penalty method is suggested to solve min-max type problems.
According to the exponential penalty method, in each iteration
of the algorithm, we update {θk , Γk,l , ηk,i→l } as

k,i→l .

exponent ρ = 4. The effective channel gain magnitudes are
ordered and |hk,L | > |hk,L−1 | > . . . > |hk,1 |. It means
that we name the user with the smallest effective channel
gain magnitude as the ﬁrst user in a cluster and the L-th
user has the largest channel gain magnitude. The users are
clustered according to the user selection scheme proposed in
[16, Algorithm 1, Figure 3]. In this user selection scheme,
the aim is to put users, which have highly different effective
channel gain magnitudes, |hk,l |, in the same cluster. Thus, the
base station sorts the channel gains of all users. For L = 2,
the base station then puts the user with the highest effective
channel gain magnitude in the same cluster with the worst
user in the ﬁrst cluster. Then the second best and second worst
users are put in the second cluster. The remaining clusters are
formed in a similar fashion. For L = 3, the users are ordered,
and divided into 3 groups, as the ﬁrst K best users, the second
best K users and the worst K users. The best users in the ﬁrst
and second groups are then clustered with the worst user in
the last group. Similarly, the second best users in the ﬁrst and
second groups are clustered with the second worst user in the
last group. All clusters are formed in a similar fashion.
In this work, we assume a simple power allocation scheme.
The total power is equally distributed among the clusters.
However, within each cluster, the power level of each user
is inversely proportional to its effective channel gain magni-
tude squared, |hk,l |2 . This power allocation scheme supports
fairness as it tries to balance out the rate terms Rk,i→l in (7).
The presented results are averaged over 102 channel real-
izations. In Algorithm 1, the maximum number of iterations is
limited to 200, ǫ and Υ are set to 10−3 and ∆ is set to 3. ∆ is
used to tune the algorithm to satisfy the rate constraint Rth
The transmit signal to noise ratio (SNR) is deﬁned as Etx /σ2 .
Here σ2 is the noise variance and set to 1. In the following
simulation results, we consider algorithm convergence and
MMF WMMSE results of Algorithm 1 for different settings.

k,l .

A. Convergence Analysis

Fig. 1 shows the convergence behavior of the proposed
alternating optimization scheme given by Algorithm 1 for three
different initial points. In the ﬁgure, the initial precoder matrix,
Pinit , can be the scaled identity matrix, the singular value
decomposition (SVD) based precoder or a randomly chosen
matrix. If it is chosen as the scaled identity matrix, then
Pinit = qI, where q is selected so as to satisfy the transmit
power constraint. On the other hand, the SVD based initial
precoder is calculated as follows. Let Hk be the channel matrix
of the k -th cluster; i.e. Hk = [hk,1 , ..., hk,L ], with the singular
value decomposition Hk = USVT . Then Pinit = U(:, 1)
where U(:, 1) denotes the ﬁrst column of U. In the ﬁgure,
k,l = 0.2, ∀k , l , and the total
transmit power is set to 10 dB. The ﬁgure conﬁrms that the
proposed algorithm converges fast and to the same optimal
point for all three initial points.

M = 4, K = 4, L = 2, Rth

B. Orthogonal Multiple Access and Multiuser Linear Precod-
ing

In this subsection, we describe the two multiple access
schemes we use for comparison: orthogonal multiple access

6

SVD Based

Random

Identity Matrix

2

4

6

8

10
12
Iteration Index

14

16

18

20

)

e
s
u

l

e
n
n
a
h
c

/

s

t
i

b

(

e
a

t

R

3

2.5

2

1.5

1

0.5

0

Fig. 1. MMF rate convergence performance of proposed algorithm for M =
K = 4, L = 2, Rth
k,l = 0.2 bits and different initiation points. Transmit SNR
is set to 10 dB.

(OMA) and multiuser linear precoding (MULP). To make a
fair comparison, we have to deﬁne the MMF rates for OMA
and MULP, MMF OMA and MMF MULP respectively.
1) OMA: In OMA, the transmission time is divided into
L equal slots and the base station transmits data to K users
in each time slot. In other words, the base station commu-
nicates with one user from each cluster in each time slot-
l . For each time slot-l , the input data vector is denoted as
sl,OM A = [s1,l , . . . , sK,l ]T ∈ CK×1 . We assume all sk,l
are independent and E{sk,l s∗
k,l } = 1. The input data vector
sl,OM A is linearly processed in time slot-l by a precoder
matrix Pl,OM A = [pl,OM A
, . . . , pl,OM A
] ∈ CM ×K , where
the precoding vector pl,OM A
∈ CM ×1 is dedicated to the k -
th user in the time slot-l . The overall transmit data vector
the base station can be written as
xl,OM A = Pl,OM A sl,OM A . Then, the SINR at user-k in time
slot-l is given by

xl,OM A ∈ CM ×1 at

K

1

k

hk,lpl,OM A
k

hk,lpl,OM A
i

.

2

+ 1

(47)

2

(cid:12)(cid:12)(cid:12)

(cid:12)(cid:12)(cid:12)

γ l,OM A
k

=

(cid:12)(cid:12)(cid:12)

PK

i=1,i6=k (cid:12)(cid:12)(cid:12)

and the corresponding rate expression is calculated as
). To ﬁnd the MMF OMA rate,
we solve the following optimization problem for ∀k , k =

= 1
L log(1 + γ l,OM A

ROM A
k,l

k

1, 2, . . . , K

Pl,OM A ∗

= arg max

Pl,OM A

s.t.

min

ROM A
k,l

k
Rth
k,l ≤ ROM A
k,l
Tr(Pl,OM APl,OM AH

,

(48a)

(48b)

) ≤ Etx ,

(48c)

∗

Pl,OM A ∗

and deﬁne ROM A
as the rates attained with the precoder
at all the K users served at time slot l . Then, the
MMF OMA rate ROM A can be calculated as

k,l

ROM A =

min

k,k=1,2,...,K

ROM A
k,l

∗

.

L

Xl=1

 
 
 
 
7

In other words, at each time slot-l , the optimization problem
maximizes the minimum rate over K users served in that time
slot. The sum cluster rate is calculated as the sum of the rates
of all users in the cluster and the MMF rate is the minimum
of all such cluster rates.
2) MULP: In MULP precoding, the base station transmits
data to all K L users simultaneously. The input data vector
is denoted as sM U LP = [s1,1 , . . . , s1,L , . . . , sK,1 , . . . , sK,L ]T
∈ CKL×1 . We assume all sk,l
are independent and
k,l } = 1. The input data vector sM U LP
is
linearly processed by a precoder matrix PM U LP =

E{sk,l s∗

[pM U LP

1,1

, . . . , pM U LP

1,L

, . . . , pM U LP

K,1

, . . . , pM U LP

K,L

]

∈ CM ×KL , where the precoding vector pM U LP
dedicated to the l-th user in the k -th cluster. We also deﬁne
] ∈ CM ×K . Then, the
overall transmit data vector xM U LP ∈ CM ×1 at the base
station can be written as xM U LP = PM U LP sM U LP . The
SINR at user-l in the k -th cluster is given by

k,l

∈ CM ×1 is

Pl,M U LP = [pM U LP
1,l

, . . . , pM U LP

K,l

γM U LP
k,l

=

|hk,lpM U LP
k,l

|2

PL

j=1
j 6=l

|hk,lpM U LP
k,j

|2 + PK

i6=k PL
i=1

l=1 |hi,lpM U LP
i,l

|2 + 1

,

(49)

and the corresponding rate expression is calculated as
). Then, we solve the following

RM U LP
k,l

= log(1 + γM U LP
problem for ∀k , k = 1, 2, . . . , K

k,l

Pl,M U LP ∗

= arg max

Pl,M U LP

min

k
Rth
k,l ≤ RM U LP
k,l

RM U LP
k,l

(50a)

s.t.

(50b)

Tr(PPH ) ≤ Etx .

(50c)

When RM U LP
is deﬁned as the rates attained with the
precoder P l,M U LP ∗
at the l-th user of each cluster, the MMF
MULP rate RM U LP can be calculated as

k,l

∗

RM U LP =

min

k,k=1,2,...,K

L

Xl=1

RM U LP
k,l

∗

.

To solve both optimization problems stated for OMA and
MULP, we ﬁrst ﬁnd their equivalent weighted MMSE prob-
lems as done in Section III and solve them in an iterative
fashion as in Section IV. However, instead of solving for the
KKT conditions, in each iteration of the algorithm, we employ
the CVX toolbox [24].

C. Comparisons with MMF WMMSE NOMA

Fig. 2 compares the proposed MMF WMMSE NOMA
algorithm with MMF OMA and MMF MULP schemes for
k,l = 0.2 bits. In this
ﬁgure, we show the minimum cluster rate for each of the
precoding schemes. As shown in the ﬁgure, proposed NOMA
algorithm signiﬁcantly outperforms MMF OMA and MMF
MULP schemes. At 20 dB, the NOMA scheme achieves 6
bits/channels use, while OMA and MULP respectively attain
approximately 5.8 and 3.4 bits/channel use. Due to the lack of
degrees of freedom (DoF), MMF MULP converges for high

M = 4, K = 4, L = 2, and Rth

1
5

10

15
20
Transmit SNR[dB]

25

30

2

3

4

5

6

7

8

9

R

e
a

t

(

b

t
i

s

/

e
n
n
a
h
c

l

e
s
u

)

Proposed

OMA

MULP

Fig. 2. MMF rates for different precoder schemes for M = K = 4, L = 2,
k,l = 0.2 bits.

Rth

1
5

10

15
20
Transmit SNR[dB]

25

30

2

3

4

5

6

7

8

9

10

R

a

t

e

(

b

t
i

s

/

e
n
n
a
h
c

l

e
s
u

)

Proposed
OMA
MULP
Dashed Line: M=K=3, L=2
Solid Line: M=K=3, L=3

Fig. 3. MMF rates for different precoder schemes for M = K = 3, L =
{2, 3}, Rth
k,l = 0.2 bits.

transmit SNR. While OMA enjoys full DoF, it suffers from
time division and is inferior to the proposed NOMA scheme.
The MMF WMMSE NOMA reaps the beneﬁts of full DoF
and superposition coding and becomes superior to all.

In Fig. 3, we investigate the effect of number of users in
each cluster. We simulate a system with M = K = 3, L = 2
and M = K = 3, L = 3 for the rate constraint Rth
bits for all users. We observe that proposed NOMA algorithm
outperforms OMA and MULP schemes for both cases and
increasing the number of users in each cluster decreases the
MMF rates for all schemes. As the number of users in each
cluster increase, it is harder to attain a large rate for all users.

k,l = 0.2

Finally, Fig. 4 shows the impact of the user distances in the
same cluster. The simulation is run for M = 2, K = 2, L = 2
for the given rate constraint Rth
k,l = 0.2 bits and transmit
SNR is set to 10dB. For this ﬁgure, the simulation setting
is slightly different from above. One of the users is uniformly
located on a disk with radius d, 0 < d < 1. The other user is

 
 
 
 
 
 
 
 
8

1

1.5

2

2.5

3

3.5

4

4.5

5

1/d

2

3

4

5

6

7

8

R

a

t

e

(

b

t
i

s

/

e
n
n
a
h
c

l

e
s
u

)

Proposed

OMA

MULP

Fig. 4. MMF rates along with varying d for different precoder schemes when
M = K = 2, L = 2, Rth
k,l = 0.2 bits. Transmit SNR is set to 10dB.

assumed to be uniformly located on an annulus in between
radii d and 1. As a result, as d decreases, 1/d increases
and the effective channel gain magnitudes the users observe
become more imbalanced on average. We observe that when
the asymmetry in the system increases, the MMF rate of the
proposed NOMA algorithm increases signiﬁcantly. The MULP
scheme performs the worst as it suffers from DoF limitations.

V I . CONCLU S ION

In this paper, we study precoder and receiver design for
maximizing the minimum cluster rate in downlink MIMO
non-orthogonal multiple access (NOMA). In NOMA, users’
messages in each cluster are combined using superposition
coding and then precoded at the transmitter. To cancel intra-
cluster interference, receivers in the same cluster employ
successive interference cancellation. We prove that maximiz-
ing the minimum cluster rate, and minimizing the maximum
cluster MMSE are equivalent at the optimal solution, and solve
the problem via alternating optimization. We show that the
NOMA scheme signiﬁcantly outperforms orthogonal multi-
ple access (OMA) and multi-user linear precoding (MULP).
The effects of the number of users in each cluster and the
discrepancy between the user distances within a cluster are
also investigated. It is of future interest to study the proposed
algorithm’s performance in mmWave massive MIMO systems
with limited feedback.

A P P END IX A

In this appendix, we derive ∇pk f (P, R, c, µ, ψ , λ) and
∇pk g (P, R, ¯c, ¯µ, ¯ψ , ¯λ). The Lagrangian objective function f
is given in (22). First, we need ∇pk Rt,i→l for both t = k and
t 6= k . Note that ∇ log X = (∇X)X−1 , and ∇X (XH AX) =
AX [25, ch E.3].
First, assume t = k . Using (14),

∇pk Rk,i→l = ∇pk [εmmse−1
k,i→l

]εmmse
k,i→l .

(51)

The gradient ∇[pk ]m [εmmse−1
chain rule as

k,i→l

] is calculated by applying the

∇[pk ]m [εmmse−1
k,i→l

)] =

∇[pk ]m (cid:18) 1

αk,l

+ pH

k hH

k,i r−1

k,i→l hk,ipk(cid:19)
k hH
k,i )
hk,ipk +
k ]m

= pH

k hH
k,i

∂ (r−1
[∂p∗

k,i→l )
k ]m

∂ (pH
[∂p∗

r−1

k,i→l hk,ipk

+ pH

k hH

k,i r−1

k,i→l

∂ (hk,ipk )

[∂p∗

k ]m

= −pH

k hH

k,i r−2

k,i→l

∂ (rk,i→l )

[∂p∗

k ]m

hk,ipk + eH
mhH

k,i r−1

k,i→l hk,ipk .

(52)

where em is the unity column vector with 1 at the mth element
and zeros elsewhere and is of size M × 1. The last term is 0
since ∂pk
= 0. On the other hand, we have2

∂p∗

k

∇[pk ]m rk,i→l =

∂ (rk,i→l )

[∂p∗

k ]m

=

L

Xj=l+1

αk,j hk,ipk eH
mhH

k,i , (53)

as ∇X (XAXH ) = XA [25]. Then, substituting (53) in (52),
we obtain

∇[pk ]m [εmmse−1
k,i→l
L

] = eH

mhH

k,i r−1

k,i→l hk,ipk

−

Xj=l+1

αk,j pH
k hH

k,i r−2

k,i→l hk,ipk eH
mhH
k,ihk,ipk ,

(54)

∇[pk ]m Rk,i→l = eH
mhH
L

k,i r−1

k,i→l hk,ipk εmmse
k,i→l

−

Xj=l+1

αk,j eH
mhH
k,i hk,ipk εmmse
k,i→l pH
k hH

k,i r−2

k,i→l hk,ipk .

(55)

Using (54) and (55), (51) becomes

∇pk Rk,i→l = hH
L

k,i r−1

k,i→l hk,ipk εmmse
k,i→l

−

Xj=l+1

αk,j hH
k,ihk,ipk εmmse
k,i→l pH
k hH

k,i r−2

k,i→l hk,ipk .

(56)

Next, we compute ∇pk Rt,i→l , for t 6= k as

∇[pk ]m Rt,i→l = pH
t hH

t,i∇[pk ]m (r−1

t,i→l )ht,ipt εmmse
t,i→l .

(57)

Using ∇X (X−1 ) = −X−1∇(X)X−1 [26], we can write

∇[pk ]m (r−1
t,i→l ) = −r−1
t,i→l (cid:0)∇[pk ]m rt,i→l (cid:1) r−1

t,i→l .

(58)

Then we compute

∇[pk ]m (rt,i→l ) = ht,ipk eH
mhH
t,i .

(59)

By combining (57), (58) and (59) we have

∇[pk ]m Rt,i→l = −eH

mhH

t,ir−2

t,i→l ht,ipt εmmse
t,i→l pH
t hH
t,iht,ipk

(60)

2Note that, the gradient of a function f (x) with respect to its variable x
is denoted as ∇x f (x) and its mth element is deﬁned as [∇x f (x)]m =
, where ∗ indicates conjugation.

∇[x]m f (x) = ∂ f (x)
∂ [x

∗ ]m

 
 
Overall, for t 6= k , we have

∇pk Rt,i→l = −hH

t,ir−2

t,i→l ht,ipt εmmse
t,i→l pH
t hH
t,iht,ipk .

The gradient of last term in (22) is

∇pk [λ Tr(PPH )] = λpk .

(61)

(62)

Combining (56), (61) and (62), we ﬁnd ∇pk f (P, R, c, µ, ψ , λ)
as stated in (24). The gradient ∇pk g (P, R, ¯c, ¯µ, ¯ψ , ¯λ) is com-
puted in a similar manner as ∇pk f (P, R, c, µ, ψ , λ) to be
found as in (25).

A P P END IX B

In this appendix, we prove Theorem 1. Taking the derivative
of the objective function h in (40) with respect to Vk,i→l , then
equating it to zero, we obtain

L

αk,lpH
k hH
k,i =

αk,j hk,i pkpH
k hH
k,i Vk,i→l

Xj=l
Xt=1,t6=k

+

K

hk,iptpH
t hH
k,iVk,i→l + Vk,i→l .

(63)

(64)

Then, when ηk,i→l > 0,

Vk,i→l = αk,lpH
k hH

k,iT −1

k,i→l .

Secondly, taking the gradient of (40) with respect to pH
k , and
equating it to zero, we have the following equation

L

L

ηk,i→l bk,i→lhH
k,iV ∗
k,i→l αk,l

L

L

L

=

Xl=1
Xi=l
Xl=1
Xi=l
Xj=l
Xt=1
Xl=1
Xi=l
t6=k

+

K

L

L

αk,j ηk,i→l bk,i→lhH
k,iV ∗
k,i→l Vk,i→l hk,ipk

ηt,i→l bt,i→lhH
t,i |Vt,i→l |2ht,ipk + βpk .

(65)

L

αk,j ηk,i→l bk,i→lhH
k,i |Vk,i→l |2hk,i
t,i |Vt,i→l |2ht,i(cid:21)−1
ηt,i→l bt,i→lhH
k,i→l # .
αk,l ηk,i→l bk,i→l hH
k,iV ∗

(66)

Then,

L

L

L

L

K

pk = (cid:20)β I +
+

Xl=1
Xi=l
Xj=l
Xt=1,t6=k
Xl=1
Xi=l
Xl=1
Xi=l
k,i→l ηk,i→l bk,i→l and perform
k=1 PL
l=1 PL

× " L

L

V ∗

PK

To calculate β , we post-multiply both sides of (63) by

i=l on both sides. We also pre-multiply (65)
with pH
k and sum over k , k = {1, 2, . . . , K }. After calculating
the trace of these two resulting equations, we observe that the
left sides of both equations are equal. Then, the right sides

are also equal to each other. As we assume that the power
constraint in (2) is satisﬁed with equality we can ﬁnd that

9

β =

1

Etx " K

Xk=1

ηk,i→l bk,i→l |Vk,i→l |2# .

L

L

Xl=1

Xi=l
RE F ERENCE S

(67)

[1] J. G. Andrews, S. Buzzi, W. Choi, S. V. Hanly, A. Lozano, A. C. K.
Soong, and J. C. Zhang, “What will 5G be?” IEEE J. Sel. Areas
Commun., vol. 32, no. 6, pp. 1065–1082, Jun. 2014.
[2] L. Dai, B. Wang, Y. Yuan, S. Han, C. I, and Z. Wang, “Non-orthogonal
multiple access for 5G: solutions, challenges, opportunities, and future
research trends,” IEEE Commun. Mag., vol. 53, no. 9, pp. 74–81, Sep.
2015.
[3] T. Cover, “Broadcast channels,” IEEE Trans. Inf. Theory, vol. 18, no. 1,
pp. 2–14, Jan. 1972.
[4] Y. Saito, Y. Kishiyama, A. Benjebbour, T. Nakamura, A. Li, and
K. Higuchi, “Non-orthogonal multiple access (NOMA) for cellular
future radio access,” in IEEE 77th Vehicular Technol. Conf. (VTC
Spring), Jun. 2013, pp. 1–5.
[5] A. Benjebbovu, A. Li, Y. Saito, Y. Kishiyama, A. Harada, and T. Naka-
mura, “System-level performance of downlink NOMA for future LTE
enhancements,” in 2013 IEEE Globecom Workshops (GC Wkshps), Dec.
2013, pp. 66–70.
[6] M. Zeng, A. Yadav, O. A. Dobre, G. I. Tsiropoulos, and H. V. Poor,
“Capacity comparison between MIMO-NOMA and MIMO-OMA with
multiple users in a cluster,” IEEE J. Sel. Areas Commun., vol. 35, no. 10,
pp. 2413–2424, Oct. 2017.
[7] Z. Ding, Z. Yang, P. Fan, and H. V. Poor, “On the performance of
non-orthogonal multiple access in 5G systems with randomly deployed
users,” IEEE Signal Process. Lett., vol. 21, no. 12, pp. 1501–1505, Dec.
2014.
[8] M. F. Hanif, Z. Ding, T. Ratnarajah, and G. K. Karagiannidis, “A
minorization-maximization method for optimizing sum rate in the down-
link of non-orthogonal multiple access systems,” IEEE Trans. Signal
Process., vol. 64, no. 1, pp. 76–88, Jan. 2016.
[9] F. Zhu, Z. Lu, J. Zhu, J. Wang, and Y. Huang, “Beamforming design for
downlink non-orthogonal multiple access systems,” IEEE Access, vol. 6,
pp. 10 956–10 965, 2018.
[10] C. Chen, W. Cai, X. Cheng, L. Yang, and Y. Jin, “Low complexity
beamforming and user selection schemes for 5G MIMO-NOMA sys-
tems,” IEEE J. Sel. Areas Commun., vol. 35, no. 12, pp. 2708–2722,
Dec. 2017.
[11] F. Alavi, K. Cumanan, Z. Ding, and A. G. Burr, “Beamforming tech-
niques for nonorthogonal multiple access in 5G cellular networks,” IEEE
Trans. Veh. Technol., vol. 67, no. 10, pp. 9474–9487, Oct. 2018.
[12] Z. Chen, Z. Ding, P. Xu, and X. Dai, “Optimal precoding for a
QoS optimization problem in two-user MISO-NOMA downlink,” IEEE
Commun. Lett., vol. 20, no. 6, pp. 1263–1266, Jun. 2016.
[13] S. Timotheou and I. Krikidis, “Fairness for non-orthogonal multiple
access in 5G systems,” IEEE Signal Processing Letters, vol. 22, no. 10,
pp. 1647–1651, Oct 2015.
[14] J. Choi, “Power allocation for max-sum rate and max-min rate pro-
portional fairness in NOMA,” IEEE Communications Letters, vol. 20,
no. 10, pp. 2055–2058, Oct 2016.
[15] X. Sun, D. Duran-Herrmann, Z. Zhong, and Y. Yang, “Non-orthogonal
multiple access with weighted sum-rate optimization for downlink
broadcast channel,” in IEEE Military Commun. Conf., Oct. 2015, pp.
1176–1181.
[16] M. S. Ali, H. Tabassum, and E. Hossain, “Dynamic user clustering
and power allocation for uplink and downlink non-orthogonal multiple
access (NOMA) systems,” IEEE Access, vol. 4, pp. 6325–6343, 2016.
[17] X. Sun, C. Shen, Y. Xu, S. M. Al-Basit, Z. Ding, N. Yang, and
Z. Zhong, “Joint beamforming and power allocation design in downlink
non-orthogonal multiple access systems,” in 2016 IEEE Globecom
Workshops (GC Wkshps), Dec. 2016, pp. 1–6.
[18] J. Choi, “Minimum power multicast beamforming with superposition
coding for multiresolution broadcast and application to NOMA systems,”
IEEE Trans. Commun., vol. 63, no. 3, pp. 791–800, Mar. 2015.
[19] Z. Liu, L. Lei, N. Zhang, G. Kang, and S. Chatzinotas, “Joint beam-
forming and power optimization with iterative user clustering for MISO-
NOMA systems,” IEEE Access, vol. 5, pp. 6872–6884, 2017.
[20] D. Guo, S. Shamai, and S. Verdu, “Mutual information and minimum
mean-square error in Gaussian channels,” IEEE Trans. Inf. Theory,
vol. 51, no. 4, pp. 1261–1282, Apr. 2005.

10

[21] S. S. Christensen and R. Agarwal and E. D. Carvalho and J. M. Ciofﬁ,
“Weighted sum-rate maximization using weighted MMSE for MIMO-
BC beamforming design,” IEEE Trans. Wireless Commun., vol. 7, no. 12,
pp. 4792–4799, Dec. 2008.
[22] S. P. X.S. Li, “Solving the ﬁnite min-max problem via an exponential
penalty method,” Comput. Tech., vol. 8, pp. 3–15, 2003.
[23] J. Kaleva, A. Tlli, and M. Juntti, “Decentralized sum rate maximization
with QoS constraints for interfering broadcast channel via successive
convex approximation,” IEEE Trans. Signal Process., vol. 64, no. 11,
pp. 2788–2802, Jun. 2016.
[24] M. Grant and S. Boyd, “CVX: Matlab software for disciplined convex
programming, version 2.1,” http://cvxr.com/cvx , Mar. 2014.
[25] T. Moon and W. Stirling, Mathematical Methods and Algorithms
for Signal Processing.
Prentice Hall, 2000.
[Online]. Available:
https://books.google.com.tr/books?id=1xUfAQAAIAAJ
[26] K. B. Petersen and M. S. Pedersen, “The matrix cookbook,” November
2012, version 20121115.

