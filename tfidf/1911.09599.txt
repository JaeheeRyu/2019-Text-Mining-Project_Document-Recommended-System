Synthesizing Visual Illusions Using Generative Adversarial Networks

A. Gomez-Villa∗, A. Mart´ın∗, J. Vazquez-Corral∗, J. Malo†, M. Bertalm´ıo∗

{alexander.gomez, adrian.martin, javier.vazquez, marcelo.bertalmio}@upf.edu, jesus.malo@uv.es

9
1
0
2

v
o

N

1
2

]

V

C

.

s

c

[

1
v
9
9
5
9
0

.

1
1
9
1

:

v

i

X

r

a

Abstract

Visual illusions are a very useful tool for vision scien-
tists, because they allow them to better probe the limits,
thresholds and errors of the visual system. In this work we
introduce the ﬁrst ever framework to generate novel visual
illusions with an artiﬁcial neural network (ANN). It takes
the form of a generative adversarial network, with a gen-
erator of visual illusion candidates and two discriminator
modules, one for the inducer background and another that
decides whether or not the candidate is indeed an illusion.
The generality of the model is exempliﬁed by synthesizing
illusions of different types, and validated with psychophys-
ical experiments that corroborate that the outputs of our
ANN are indeed visual illusions to human observers. Apart
from synthesizing new visual illusions, which may help vi-
sion researchers, the proposed model has the potential to
open new ways to study the similarities and differences be-
tween ANN and human visual perception.

1. Introduction

A prevalent view in vision science, pioneered by the
works of Attneave and Barlow in the mid-twentieth century
[3, 7], is the one given by the efﬁcient representation prin-
ciple. Stating that the organization of the visual system in
general and neural responses in particular are tailored to the
statistics of the images that the individual typically encoun-
ters, this principle afﬁrms that visual information can be en-
coded in the most efﬁcient way, optimizing the limited bio-
logical resources. This is an ecological approach for vision
science that has proven to be extremely successful, being
the only framework able to predict the functional properties
of neurons from a simple theory. There is an agreement in
considering this codiﬁcation strategy as a result of an evo-
lutionary process, a view shared by more recent and very
popular theories [6, 17, 23].
The direct study of visual perception is an extremely

∗Department of
Information and Communication Technologies
(DTIC), Universitat Pompeu Fabra.
C. Roc Boronat 138, 08018,
Barcelona, Spain
† Image Proc. Lab, Universitat de Val `encia, Val `encia, Spain

Figure 1. A canonical visual illusion (brightness contrast [10]).
The squares have the same gray value, but they are perceived as
being different.

Figure 2. First row targets (squares, rings, and squares) in a neutral
background. Second row, visual illusions generated by our frame-
work. Note that the values of the targets are exactly the same in
the top and the bottom rows.

challenging open problem, and for this reason most psy-
chophysical research is performed on the study of percep-
tual limits, thresholds, and errors, in order to shed light on
the behaviour of the visual system. A visual illusion (VI) is
an image stimulus that induces a visual percept that is not
consistent with the visual information that can be physically
measured in the scene. An example VI can be seen in Fig.
1, that shows a canonical contrast illusion [10]: the center
squares have the exact same gray value, and therefore send
the same light intensity to our eyes (as a measurement with
a photometer could attest), but we perceive the gray square
over the white background as being darker than the gray
square over the black background. This VI, as all VIs, are
images whose statistics do not correspond to the ones that
are typically found in natural images, so our perception of

1

 
 
 
 
 
 
them suffers from errors in the (otherwise optimal) codiﬁ-
cation strategy. In fact, many illusions have been explained
as by-products of optimal information transmission or er-
ror minimization in statistically unusual scenarios [5, 25].
Thus, VIs allow vision scientists to devise and test new vi-
sion models in their search for a better understanding of the
rules that govern visual perception.
Since 2018, a handful of works have observed that arti-
ﬁcial neural networks (ANN) trained in natural images can
also be “fooled” by VIs, in the sense that their response to
an image input that is a VI for a human is (qualitatively) the
same as that of humans, and therefore inconsistent with the
actual physical values of the light stimulus. This has been
shown for VIs of very different type: motion [32], bright-
ness and color [18], and completion [22].
In this article we now move in the opposite direction,
and propose a general framework that allows to generate
novel visual illusions with an ANN, that is, the ANN will
generate images that will now “fool” humans. In particular,
we propose a framework that takes the form of a Genera-
tive Adversarial Network (GAN) [20]. The generality of the
model is exempliﬁed by synthesizing VIs of different types
and with different conﬁgurations of the GAN, and validated
with psychophysical experiments that corroborate that the
outputs of our framework are indeed visual illusions to hu-
man observers. This is a completely novel idea, to the best
of our knowledge. Some examples of our results are shown
in Figure 2.
This paper puts the focus on presenting a framework for
the generation of novel visual illusions, showing the capa-
bility of our model to help vision researchers. But the poten-
tial impact of our proposed approach goes well beyond that:
it could allow to study how close particular ANNs or vision
models are to modelling visual perception, as we will dis-
cuss. Our code and models will be publicly available soon.

2. Phantasmagoria: A framework to generate
visual illusions

Our goal in this work is to propose a framework that syn-
thesize new images that produce a visual illusion to human
observers. Using a generative adversarial network (GAN)
approach, in principle we would just need two components:
a generator of images that are candidate to produce a VI
and a discriminator that ensures that it actually is a VI. The
problem with this approach is that if there is a particular
candidate that produces a visual illusion with a considerably
stronger effect than the rest of candidates, then the genera-
tor will end up generating many replicas of the this VI. In
other words, the approach will fall into a mode collapse,
thus transforming the framework into a synthesizer of the
same VI again and again. This is the reason why we need
a third component that pushes the generator to synthesize a
variety of candidates for VIs that also follow the properties

of a particular image set.
Then the framework we propose (shown in Figure. 3) is
composed by three components, namely a candidate gen-
erator (CG), a background discriminator (BD) and an illu-
sion discriminator (ID). The generator synthesize a candi-
date background (inducer) that is fed to the background dis-
criminator (blue branch in Figure. 3); at the same time the
targets (i.e. the region in where the illusion should happen)
are pasted over the generated candidate (green branch) be-
fore being fed to the illusion discriminator. The background
discriminator judges if the candidate agrees to a certain im-
age type we impose. In our case, this is equivalent to de-
ciding whether the candidate is a real instance of the train-
ing dataset - composed by textures or natural images, for
example-. In contrast, the illusion discriminator plays the
role of a replicant of the human vision system, in the sense
that it assesses whether there is an illusion, i.e. whether it
“sees” both targets pasted in the candidate background in
a different way. The cost function for the candidate gener-
ator weightily combines the outputs from both discrimina-
tors (BD and ID) and therefore allows the CG to learn how
to generate images that jointly produce a visual illusion and
belong to a certain class.

2.1. BD: Background discriminator

The role of the background discriminator is to force the
candidate generator to synthesize inducers belonging to the
type of the desired dataset. The absence of the BD module
or its poor training would allow the CG to fall into collapse
mode and to generate what can be considered as the “trivial
solution” (this will be discussed in section 6). During the
BD supervised training both images that come from the real
dataset and images generated from the CG are fed into the
BD with their corresponding expected probabilities. In this
training scenario the BD outputs a discrepancy value. This
discrepancy is computed by measuring a distance between
the output probability of the input images of being from the
desired dataset and the known answer of whether or not they
were images from that dataset.

2.2. ID: Illusion discriminator

The illusion discriminator consists of two components.
The ﬁrst one is a visual task solver (VTS) designed to per-
form a particular task that the human visual system (HVS)
also achieves, and it therefore provides us with an emula-
tion of the human visual response to the stimuli. The sec-
ond component quantiﬁes the degree of illusion present in
the response given by the VTS, i.e. it acts as a perceptual
quantiﬁer (PQ). Thus, this PQ depends entirely on the type
of VI to be generated and on the selected VTS for the ﬁrst
component. Examples of a VTS could be for instance a
CNN trained to do denoising as seen in [18] or a vision
model speciﬁcally designed to replicate the HVS such as

Figure 3. Phantasmagoria: A framework to generate visual illusions

the ODOG model [9]. Let us note that this ID module is
the key part of our proposed framework. By selecting an ID
with responses very close to those of the HVS, the frame-
work will generate VIs that almost always fool humans. Fi-
nally, this module is the part of the framework that mostly
needs to be adapted in order to generate different types of
illusions.

2.3. CG: Candidate generator

The aim of the candidate generator is to sample images
that fool both the BD and the ID. Its representation power
and the sampled space are key to generate the illusion, since
the inducers produced will be limited by the synthesis capa-
bility of the generator. In our proposed framework we sam-
ple the space with the noise vector z , producing n different
inducers (which means n different versions of the desired
illusion). In order to have a rich variety of inducers it is rec-
ommended to pre-train the CG and BD modules (inside the
dash line in the Fig. 3) in a generative adversarial network
fashion. When this pre-train is not performed, the genera-
tor risks to fall into mode collapse. A discussion on this is
presented in section 6.

2.4. Framework loss function

As discussed above, a good candidate to be a synthe-
sized VI should balance the formation of the VI effect in
the targets with the richness of the inducer background. In
order to do so, our loss function for the candidate generator
weights the outputs from both the ID and the BD modules
using two scalars (α and β respectively) as seen in Figure
3. This approach resembles what is found in many classi-
cal models broadly used in computer vision and image pro-
cessing [19, 16]. In these classical models the loss function
commonly balances two terms: one that is directly linked

with the task to be solved and another one ensuring that the
solution fulﬁlls some a priori constraints, that in our case
correspond to the ID and the BD modules respectively.

3. Generators of Visual Illusions

In this section we detail several instances of the Phantas-
magoria framework to generate visual illusions of speciﬁc
types. In particular we focus on Lightness VIs (LVIs), Color
VIs (CoVIs), and Contrast VIs (CrVIs). In each subsection
we explain the choices for the CG, BD and ID modules re-
quired to generate each type of illusion.
In all the instances we ﬁrst pre-train the CG and GD in
a GAN fashion using either the DTD [13] or the CIFAR10
[24] datasets. Then, both the CG and BD nets are ﬁne-tuned
with the whole framework until no signiﬁcance change is
observed in the loss function for any of them. Note that
the ID block is never trained in this work. The α and β
weights are adjusted to produce high variety of illusions (as
explained in section 6).

3.1. Phantasmagoria-LVI: Lightness VI Generator

Lightness visual illusions (LVI) are a broadly studied
topic in the vision science community. Their importance is
based on its simplicity -there is only the Lightness channel-
and on the importance that this Lightness channel has in
our perception [30]. In this work we focus on LVIs con-
sisting on images that include two targets of the same shape
and lightness intensity, but in which these two targets are
perceived differently because of the inducer image back-
ground.
In this instance, the CG module is a convolutional neu-
ral network (CNN) that receives a batch (size n) of random
noise vectors of size 100 and generates a batch of 32 × 32
images. The CNN is composed by two fully-connected

layers followed by two convolutional layers. The fully-
connected layers have 2048 and 256 × 8 × 8 hidden nodes
respectively. Both convolutional layers use 5 × 5 ﬁlter size
with 128 and 1 channels respectively. Before each convolu-
tional layer the input is 2 × 2 upscaled. ReLu activation
functions are used after each layer but the output one in
which a sigmoid activation function is applied. The CG is
pretrained in a GAN fashion together with just the BD mod-
ule. The BD module is also CNN that receives a batch of
images of size 32 × 32 and outputs their probability of be-
longing to the desired dataset. The network is composed by
three convolutional layers and two fully-connected layers.
The ﬁrst convolutional layer uses 5 × 5 ﬁlter size and the
other two use 3 × 3 ﬁlter size with 128, 256 and 512 chan-
nels respectively. The two fully-connected layers have 1024
and 1 hidden nodes. After every layer the activation func-
tion is a Leaky ReLu (α = 0.2) except for the output layer
that uses a sigmoid function. A max pooling operation is
applied after each convolutional layer. Several choices for
the training dataset can be made, in sections 4.1 and 4.2 we
show the results obtained when using a database of textures
[13] or natural images like CIFAR-10 [24].
As explained in section 2, the ID module is crucial and
should be directly related with the LVI that we want to gen-
erate. In this case, for the visual task solver role we train a
small CNN to perform a restoration problem (joint deblur-
ring and denoising) inspired in the recent work of Gomez-
Villa et al.
[18]. We call this network RestoreNet. We
use the same architecture proposed there: input and output
layers of size 128 × 128 × 3 pixels, one hidden layer with
a 5 × 5 ﬁlter size and 8 channels, and sigmoid activation
functions. The last convolutional layer works as an output
layer and hence has 3 channels. We also test our framework
with a different choice for the visual task solver.
In par-
ticular, we consider the ODOG model [9], which is a very
successful model speciﬁcally designed to replicate human
vision. Since all these choices of VTS receive 128 × 128
input images the images generated by the CG are upscaled
using nearest neighbor interpolation.
Regarding the perceptual quantiﬁer part of the ID, it must
measure whether there is an illusion and its strength. In this
case, we opted to point-wise subtract the intensity of the
central area of one target from the intensity for the same
area of the other target. Please note that we can choose
which target will be seen lighter by just selecting from
which of the targets we subtract the other.

3.2. Phantasmagoria-CoVI: Color VI Generator

The color visual illusions (CoVI) that we synthesized are
very related to the previously described LVI. They are im-
ages with two targets with the same shape and color that are
perceived as having a different color because of the inducer
image background.

The CG and BD modules are the color version of the
CNNs described in the previous section,
i.e.
the only
changes are that the output layer for the CG network has
3 layers and that the size of the inputs of the BD is of
32 × 32 × 3. For the visual task solver of the ID mod-
ule we choose a recent denoising CNN proposed by Zhang
et al.
[33] that according to the work of [18] obtained a
good replication for color illusions. The perceptual quan-
tiﬁer used here is a point and channel-wise subtraction of
the image values of the central area of one target from those
of the same area of the other target. In order to choose a
desired perceived color each channel must be tailored man-
ually. For instance, if the desired output is a reddish right
target (with respect to the left target) a possible perceptual
quantiﬁer will be one that maximizes the difference between
the targets in the red channels (right minus left) and leave
the blue and red channels as a free choice for the model.
Note that color VIs are highly complex, and there is
still ongoing discussions on how to categorize them [28].
Hence, if the target is not neutral gray the framework may
suggest solutions that saturate the color of one target or that
only change the luminance. To alleviate this, we ask the
framework to synthesize a simple perception of color, that
is, show one target of one color. Therefore, mixed classes
(saturation contrast or color contrast) of color illusions are
expected.

3.3. Phantasmagoria-CrVI: Contrast VI Generator

Contrast illusions are different in nature to lightness and
color ones. They are given by the fact that in humans the
presence of certain patterns in the scene (previous in time,
or close in space) leads to changes in the response of texture
sensors [29, 15] and motion sensors [27]. For instance, in
the texture aftereffect [8, 4] parts of stimuli with physically
stationary contrast seem to fade out after prolonged expo-
sure to localized high contrast patterns of similar frequency
and orientation. In the case of texture induction, patterns
with similar frequencies and orientation strongly reduce the
response of sensor tuned to similar patterns [11].
In this work we focus on the case of texture induction.
In particular, we focus on CrVIs consisting on images that
include two targets that present the same spatial frequency
and orientation, but in which these two targets are perceived
differently because of the inducer image background.
In this instance the CG and BD modules are the same
CNNs described in the section 3.1. Regarding the ID, we
use RestoreNet as VTS. For the perceptual quantiﬁer, we
measure the Michelson’s contrast [26] in the central area of
both targets and maximize the difference between them. As
a result we ask the framework to generate an inducer that
remarks or makes more “visible” (i.e. with higher contrast)
one of the patterns with respect to the other.

4. Qualitative Results

Luminance and Color VIs can be further subdivided into
assimilation and contrast ones. In assimilation the target in-
tensity gets attracted by the inducer (e.g. a gray target gets
brighter if it is surrounded by a white inducer). Contrast
is the opposite effect of assimilation, therefore in this case,
the target gets expelled from the inducer (e.g. a gray target
gets darker if it is surrounded by a white inducer). In order
to include the most variate set of examples, we show how
our framework performs both of these sub-types for the lu-
minance case.
In the case of color we focus on showing
how our framework generate color contrast illusions inde-
pendently from the starting color of the given targets. Fi-
nally, we also show how our framework generates contrast
illusions -in particular texture induction- for targets of dif-
ferent orientations.
We recommend the reader to look at all the different
visual illusions in isolation -by for example covering any
other illusion located close to the one of interest-. Also, let
us note that all the visual illusions are presented in isolation
in the supplementary material, together with a larger set of
results.

4.1. Lightness illusions

Our results were obtained by selecting RestoreNet as
the visual task solver, and considering different training
datasets for the background discriminator -DTD [13] and
CIFAR10 [24]-.
The results for the lightness contrast illusions are shown
in Figure 4. Three different shapes for the targets -squares,
rings and bars- were selected. Also, for these images, we
selected that the right target should appear brighter that the
left one. We can see how our framework is able to generate
contrast VIs under all these different setups. Regarding the
shapes, our method presents a slightly worse performance
for the case of the bars, due to their large height. In terms
of the training dataset, we can see how this affects the back-
ground.
In particular, we can see that a more structured
pattern appears in the background image inducer when the
BD is trained using CIFAR10. This is probably caused by
the object categories presented in this dataset.
Figure 5 shows the result of our framework for a light-
ness assimilation illusion. Please note that assimilation VIs
extremely depend on spatial frequency, and thus they de-
pend on the distance at which they are viewed. They may
be converted into contrast VIs if the spatial frequency -or
equivalently the viewing distance- is diminished [21, 14].
We have done our best to accommodate the size of this
ﬁgure to account for the best experience of the visual il-
lusion. This said, in case the reader does not perceive the
illusion -and as the perception of visual illusions varies be-
tween observers- we recommend him/her to zoom out the
Figure to better accommodate the frequency of this illusion.

Figure 4. Results for the Lightness contrast illusions using differ-
ent training datasets and shapes, and RestoreNet as the VTs. In all
the cases the right shape was selected to be brighter than the right
one.

Figure 5. Results for the Lightness assimilation illusion using dif-
ferent training datasets, and RestoreNet as the VTS.

Finally, ﬁgure 6 shows the result of our framework for
the two different VTS choices explained in section 3.1. In
this case, the training dataset was DTD and the shape se-
lected was square, therefore aiming for a lightness contrast
illusion. Please note that in these images the square selected
as the brightest was randomized in order to use these im-
ages in the psychophysical experiment explained in section
5. This said, we can clearly see that both of the VTS are
able to obtain different VIs -although not all of them with
the same strength-.

4.2. Color illusions

As we explained in section 3.2, in this case we have se-
lected the denoising CNN proposed in Zhang et al.
[33]
as the VTS. We have considered the DTD as the training
dataset for the background discriminator. The shape target
selected are squares. Results are shown in Figure 7. The
three columns of this Figure show the color contrast illu-
sion obtained by starting either in a blue, yellow or red tar-
get color, and thus this Figure shows that our framework is
not tied to any particular region of the color space.
More in detail, the three cases perform as it was imposed
in the loss function. In the ﬁrst column the right target is
perceived redder than the left one. Similarly, in the sec-
ond column the right target is perceived yellower, and in
the third column the right target is perceived bluer.

Figure 6. Results for the Lightness inductions using the DTD
dataset and squares for two different VIs. These images are also
a subset of those used in the psychophysical experiment. For this
reason, the square selected as the one being brightest was random-
ized in these images

Figure 7. Results for the color illusions using DTD as the training
dataset for the BG and different target colors. From left to right,
our cost imposed the perception of the right target to be: redder,
yellower, bluer.

4.3. Contrast illusions

For the contrast illusions we have selected the CIFAR10
dataset as the training one for the background discrimina-
tor. We have selected CIFAR10 because the DTD dataset
does not present enough high frequency training data to syn-
thetize these type of illusions. For the visual task solver
we have selected RestoreNET. In terms of the targets, we
have selected patterns of orientation 0◦ , 45◦ , and 90◦ . For
these images, it was selected that the right target should look
higher contrasted than the left one. Results for these illu-
sions are shown in Figure 8. We can see that for the 0◦ and
90◦ cases the visual illusions accomplish our condition (i.e.
the right target is higher contrasted than the left one). How-
ever, in the case of 45◦ even if the framework performs as
expected (i.e. selecting a higher frequency for surrounding
the pattern of the left and a lower frequency for surrounding
the pattern on the right) the effect is not strong enough to
provoke an illusion for a human observer.

Figure 8. Results for the contrast illusions using CIFAR10 as the
training dataset for the BG and different orientation patterns.

5. Psychophysical tests

We have run a phychophysical
test
to evaluate the
ability of our framework to fool human observers. Ob-
servers were shown the lightness visual illusions created
by Phantasmagoria-LVI -using squares as targets-, and they
were asked to select the lighter square, having three differ-
ent options to choose from: left, right, or center (in case
they were not able to perceive any difference). The exper-
iment was performed on a calibrated AOC I2781FH LCD
monitor. Observers were sit at 50 cm of the screen so as
the target grey squares surrounded 1.5 degrees of visual an-
gle. We have considered the Describable Textures Dataset
(DTD) [13] for training the background discriminator mod-
ule. For the visual task solver in the illusion discriminator
module we have considered the two choices mentioned in
section 3.1: RestoreNet [18], and the ODOG model [9].
For each VTS choice we have selected 50 output images
(totalling 100 images) by randomly selecting images that
were considered to be an illusion by the perception quanti-
ﬁer module from batches of different iterations during the
framework training, in order to ensure the diversity of the
candidates generated. These images were randomized both
in terms of the methods and in terms of the side in which the
lighter square was expected to appear. Six example images
(3 for each of the IDs tried: ﬁrst row ODOG, second row
RestoreNet) are shown in Figure 6. The full set of images
used in this experiment are shown in the supplementary ma-
terial.
Ten observers took part in the experiment. All of them
presented normal or corrected to normal color vision. None
of them was an author in this paper. A ﬁrst interpretation of
the results is presented in Table 5, where the average selec-
tion of each option for the full set, as well as for each ID,
is shown. As we can see, in a large majority of the cases
(> 66%) the human observers perceive the illusion that was
generated by the ID. To obtain a more statistically signiﬁ-
cant result, we have also recast the experiment in terms of
the Thurstone Case V Law of Comparative Judgement [31].
To this end, we have divided the answers as having the gen-
erated illusion, or not having it. This second category con-
siders both the cases where an observer has not seen any

Opposite
illusion
0.0770
0.0720
0.0820

No
illusion
0.2280
0.2160
0.2400

Correct
illusion

0.6950
0.7120
0.6780

All
ODOG
RestoreNet

Table 1. Results of the psychophysical experiment as average of
the selected square.

illusion and where an observer has selected the opposite di-
rection for the illusion. Results for this analysis are shown
in Figure 9. As we can see, the generated illusion is per-
ceived with statistical signiﬁcance in all the cases.

6. Discussion and limitations

One of the key points of the proposed framework, as
mentioned in Section 2, is the right balance between the two
discriminator modules, the background discriminator (BD)
and the illusion discriminator (ID). We have studied the be-
havior of the proposed framework for a speciﬁc instance of
Phantasmagoria-LVI in which we have chosen RestoreNET
as the visual task solver and the DTD dataset [13] for the
BD. Finding a right balance between the weights of the ID
(α) and the BD (β ) modules produces a rich variety of can-
didates to be a VI (see the top group of images in Figure 10).
There we can see some randomly selected images from the
generated images after 500 and 800 iterations of the learn-
ing process. If the weight of the BD module is too low (as
shown in the middle group of images in Figure 10), the gen-
erated candidates will be very similar between them since
these solutions will be mainly governed by the ID module.
These candidates already resemble strongly the previously
referred as canonical solution for lightness VI (see Figure
1). This “convergence” to this canonical solution is even
more clear if we observe the extreme case of our frame-
work: when we ignore the BD module (i.e. we set its cor-
responding weight to be 0) and we use a generator that has
not been pretrained to generate images of a certain type. In
this extreme case, in a few iterations the network falls into
a mode collapse generating all the images of every batch
exactly equal (as shown in the bottom group of images in
Figure 10). The images produced by the Phantasmagoria-
LVI framework in mode collapse are nothing but a version
of the canonical solution that produces a very strong illu-
sion in human observers.
The study above introduces one general limitation of the
proposed framework:
there is no general rule to choose
what is the best balance between the two discriminator mod-
ules. This adds up to a shared problem of most of the GAN
approaches that is that of the selection of parameters such
as the learning rates of the generator and discriminator. In
total, this implies that obtaining good solutions requires a
certain degree of ﬁne tuning of the model parameters.

The previous discussion has also implications in the way
the data for the psychophysical experiment was generated.
Since the aim of our work is to synthesize new VI and hence
avoid falling in this mode collapse (that we know that will
produce a VI to human observers), we have to tune the
framework parameters to obtain a good trade-off between
a sufﬁciently rich variety of candidates and the strength of
the effect that they provoke. The images used for the ex-
periment are a consequence of this compromise and were
randomly picked between the generated candidates instead
of being manually chosen to maximize the effect in the ob-
servers. The fact that still under these conditions the ob-
servers perceived the expected VI in roughly a 70% of the
cases is a very remarkable ﬁnding. Another by-product of
the need of manually tuning the parameters in order to ﬁnd
this balance is that we can not use the results from the psy-
chophysical tests to directly compare the two instances of
the VTS used (RestoreNET and ODOG) in terms of how
close are they to be a good “replicant”. We have no way to
ensure that the selected parameters α and β are optimal for
each method in the sense that they are the ones that would
provoke stronger VI in the human observers. Let us note
though, that obtaining a rule to ﬁx these parameters would
open the door to cast our framework as a proxy to assess
how close a given model is to modelling the human visual
perception, therefore becoming a really useful tool for vi-
sion researchers.

Besides the above mentioned topics there are other im-
portant open problems that mainly concern the illusion dis-
criminator (ID) and are intimately related with well-known
open problems for the vision science community. The ﬁrst
one is ﬁnding a vision model that correctly replicates the
human visual perception in most scenarios. This is directly
related with the visual task solver (VTS) part of our ID
module, which in the absence of this “perfect model” we
substitute it by CNNs or one of the existing vision mod-
els. The second one is our need for quantitatively evaluate
the strength of the illusion after they pass through the VTS.
There is a well known lack of quantitative measurements
in the study of VIs in the vision science literature, in where
qualitative assessments are typically performed. This forces
us to propose ways to measure these effects in this work and
therefore implies the need for further study of the impact of
the choices made in the generation of VIs.

Finally, let us remark that the possibility of using a CNN
as the VTS part of the illusion discriminator opens a pos-
sibility still unexplored of allowing the VTS to be trained
during the framework optimization process. This raises fur-
ther questions regarding what could be the best training for
improving the generation of visual illusions.

Figure 9. Thurstone Case V Results for our Experiment. We can see that the illusions are saw with statistical signiﬁcance in all the cases.

ferent shapes and types, namely lightness, color and con-
trast visual illusions. Furthermore, we have corroborated
the validity of our approach with psychophysical experi-
ments that conﬁrm that most of the visual illusions produced
by our framework fool in the same way human observers.
Further work should start by a deeper study of the pa-
rameters governing the model that could open the door to
exciting new ways of research connecting human visual per-
ception and artiﬁcial neural networks. The extension of this
work to other types of illusions should be considered. For
example, we can consider the works of Watanabe et al. [32]
and Kim et al. [22], where they found CNNs replicating
motion or completion illusions respectively. Both of these
CNNs seem to be good candidates for our visual task solver
module.

Acknowledgements

This work has
received funding from the Euro-
pean Unions Horizon 2020 research and innovation pro-
gramme under grant agreement number 761544 (project
HDR4EU) and under grant agreement number 780470
(project SAUCE), and by the Spanish government and
FEDER Fund,
grant
ref.
PGC2018-099651-B-I00
(MCIU/AEI/FEDER, UE). We gratefully acknowledge the
support of NVIDIA Corporation with the donation of the
Titan Xp GPU used for this research.

Figure 10. Parametric study of the Phantasmagoria-LVI frame-
work using RestoreNET as Visual Task Solver.

7. Conclusions

We have introduced Phantasmagoria,
the ﬁrst ever
framework to generate novel visual illusions using artiﬁcial
neural networks. Our framework follows a GAN structure,
that in particular has a generator of inducer candidates to
generate a visual illusion and two discriminator modules,
one that ensures that the candidate belongs to a desired type
of images and another one that decides whether or not the
candidate provokes indeed an illusion. We have shown the
generality of our framework by synthesizing illusions of dif-

[20] I. J. Goodfellow, J. Pouget-Abadie, M. Mirza, B. Xu,
D. Warde-Farley, S. Ozair, A. Courville, and Y. Bengio. Gen-
erative adversarial nets.
In Proceedings of the 27th Inter-
national Conference on Neural Information Processing Sys-
tems - Volume 2, NIPS’14, pages 2672–2680, Cambridge,
MA, USA, 2014. MIT Press. 2
[21] H. Helson. Studies of anomalous contrast and assimilation.
Journal of the Optical Society of America, 53(1), 1963. 5
[22] B. Kim, E. Reif, M. Wattenberg, and S. Bengio. Do neural
networks show gestalt phenomena? an exploration of the law
of closure. arXiv preprint arXiv:1903.01069, 2019. 2, 8
[23] F. A. Kingdom. Lightness, brightness and transparency: A
quarter century of new ideas, captivating demonstrations and
unrelenting controversy. Vision research, 51(7):652–673,
2011. 1
[24] A. Krizhevsky. Learning multiple layers of features from
tiny images. 2009. 3, 4, 5
[25] V. Laparra and J. Malo. Visual aftereffects and sensory non-
linearities from a single statistical framework. Front. Human
Neurosci., 9:557, 2015. 2
[26] A. A. Michelson. Studies in optics. Courier Corporation,
1995. 4
[27] M. Morgan, C. Chubb, and J. Solomon. Predicting the
motion after-effect from sensitivity loss. Vision Research,
46(15):2412–2420, 2006. 4
[28] X. Otazu, C. A. Parraga, and M. Vanrell. Toward a uniﬁed
chromatic induction model. Journal of Vision, 10(12):5–5,
2010. 4
[29] J. Ross and H. D. Speed. Contrast adaptation and contrast
masking in human vision. Proceedings of the Royal Society
of London. Series B: Biological Sciences, 246(1315):61–70,
1991. 4
[30] A. G. Shapiro and D. Todorovic. The Oxford compendium of
visual illusions. Oxford University Press, 2016. 3
[31] L. L. Thurstone. A law of comparative judgment. Psycho-
logical review, 34(4):273, 1927. 6
[32] E. Watanabe, A. Kitaoka, K. Sakamoto, M. Yasugi, and
K. Tanaka. Illusory motion reproduced by deep neural net-
works trained for prediction. Frontiers in psychology, 9:345,
2018. 2, 8
[33] K. Zhang, W. Zuo, Y. Chen, D. Meng, and L. Zhang. Beyond
a gaussian denoiser: Residual learning of deep cnn for image
denoising. Trans. Img. Proc., 26(7):3142–3155, July 2017.
4, 5

References

[1] Oriented difference of gaussians implementation. https:

//github.com/computational-psychology/

lightness_models. Accessed: 2019-11-21. 10
[2] M. Abadi and et al. TensorFlow: Large-scale machine learn-
ing on heterogeneous systems, 2015. Software available
from tensorﬂow.org. 10
[3] F. Attneave. Some informational aspects of visual percep-
tion. Psychological review, 61(3):183, 1954. 1
[4] H. Barlow. A theory about the functional role and synap-
tic mechanism of visual after-effects. Vision: Coding and
efﬁciency, 363375, 1990. 4
[5] H. Barlow. Vision: Coding and Efﬁciency, chapter A theory
about the functional role and synaptic mechanism of visual
aftereffects. Cambridge Univ. Press, UK, 1990. 2
[6] H. Barlow. Redundancy reduction revisited. Network: com-
putation in neural systems, 12(3):241–253, 2001. 1
[7] H. B. Barlow et al. Possible principles underlying the trans-
formation of sensory messages. Sensory communication,
1:217–234, 1961. 1
[8] C. Blakemore and F. W. Campbell. Adaptation to spatial
stimuli. The Journal of physiology, 200(1):11P–13P, 1969. 4
[9] B. Blakeslee and M. E. McCourt. A multiscale spatial ﬁlter-
ing account of the white effect, simultaneous brightness con-
trast and grating induction. Vision Research, 39(26):4361 –
4377, 1999. 3, 4, 6
[10] E. Brucke.
uber erganzungs und contrasfarben. Wiener
Sitzungsber, 51, 1865. 1
[11] J. R. Cavanaugh, W. Bair, and J. A. Movshon. Nature and
interaction of signals from the receptive ﬁeld center and sur-
round in macaque v1 neurons. Journal of neurophysiology,
88(5):2530–2546, 2002. 4
[12] F. Chollet et al. Keras. https://keras.io, 2015. 10
[13] M. Cimpoi, S. Maji, I. Kokkinos, S. Mohamed,
, and
A. Vedaldi. Describing textures in the wild. In Proceedings
of the IEEE Conf. on Computer Vision and Pattern Recogni-
tion (CVPR), 2014. 3, 4, 5, 6, 7
[14] C. Fach and L. T. Sharpe. Assimilative hue shifts in color
gratings depend on bar width. Perception and Psychophysics,
40(6):412–418, 1986. 5
[15] J. M. Foley and C.-C. Chen. Analysis of the effect of pattern
adaptation on pattern pedestal effects: A two-process model.
Vision research, 37(19):2779–2788, 1997. 4
[16] D. A. Forsyth and J. Ponce. Computer vision: a modern
approach. Prentice Hall Professional Technical Reference,
2002. 3
[17] K. Friston. The free-energy principle: a rough guide to the
brain? Trends in cognitive sciences, 13(7):293–301, 2009. 1
[18] A. Gomez-Villa, A. Martin,
J. Vazquez-Corral,
and
M. Bertalmio. Convolutional neural networks can be de-
ceived by visual illusions. In Proceedings of the IEEE Con-
ference on Computer Vision and Pattern Recognition, pages
12309–12317, 2019. 2, 4, 6
[19] R. C. Gonzalez, R. E. Woods, et al. Digital image processing,
2002. 3

Appendix A.

CNN

architectures
from
Phantasmagoria-
LVI/CoVI/CrVI

In this section we depict the CNN architectures consid-
ered in the paper for the speciﬁc instance of the Phantas-
magoria framework to synthesize lightness, color and con-
trast visual illusions (Phantasmagoria-LVI/CoVI/CrVI re-
spectively). Fig. A1 shows the candidate generator net-
work. Fig. A2 depicts background discriminator network.
Finally, in Fig. A3 we detail the visual task solver (which
is part of the illusion discriminator module) and that we de-
note as RestoreNET.

Appendix B. Implementation details

All our CNN were trained in Keras [12] and Tensor-
ﬂow [2] frameworks. We used the following loss functions:
binary cross-entropy for the background discriminator net-
work and mean squared error for the candidate generation
and visual task solver. The maximum number of epochs
was set to 100, and we set a batch size of 32. The training
stop criteria of the framework varies depending of the value
of α and β parameters (please go to section 6 of the paper
for more details).
The oriented difference of Gaussians model (ODOG)
used was a Tensorﬂow implementation of an public avail-
able [1] Python implementation
Our code and models will be publicly available soon.

Appendix C. Psychophysical test images

Figures C1 and C2 show the full set of images (50 per
method) that were used in the psychophysical test (see sec-
tion 5 of the paper). The square selected as the one being
brightest was randomized in these images for experimental
purposes.

Appendix D. Visual illusions in isolation and
additional results

Figures D1 to D14 show the different images presented
in the paper in isolation. This allows the reader to better
accomodate for the effects provoked by the visual illusions.
Additionally, Fig.D15 to Fig.D23 present several new vi-
sual illusions (different from the main paper results). The
expected visual illusion is explained at each ﬁgure caption.
Please remember that -as is always the case in visual
illusions- both targets have exactly the same pixel values.

Figure A.1. Architecture of the background discriminator CNN

Figure A.2. Architecture of the candidate generator CNN

Figure A.3. Architecture of the visual task solver (RestoreNet) CNN

Figure C.1. Visual illusions generated using RestoreNet as visual task solver. The square selected as the one being brightest are randomized
in these images for experimental purposes.

Figure C.2. Visual illusions generated using ODOG as visual task solver. The square selected as the one being brightest are randomized in
these images for experimental purposes.

Figure D.1. Right target is asked to be lighter. LVI generated using RestoreNet as VTS and the DTD as database for the BD.

Figure D.2. Right target is asked to be lighter. LVI generated using RestoreNet as VTS and the DTD as database for the BD.

Figure D.3. Right target is asked to be lighter. LVI generated using RestoreNet as VTS and the DTD as database for the BD.

Figure D.4. Right target is asked to be lighter. LVI generated using RestoreNet as VTS and CIFAR10 as database for the BD.

Figure D.5. Right target is asked to be lighter. LVI generated using RestoreNet as VTS and CIFAR10 as database for the BD.

Figure D.6. Right target is asked to be lighter. LVI generated using RestoreNet as VTS and CIFAR10 as database for the BD.

Figure D.7. Right target is asked to be reddish. CoVI generated using RestoreNet as VTS and the DTD as database for the BD.

Figure D.8. Right target is asked to be yellower. CoVI generated using RestoreNet as VTS and the DTD as database for the BD.

Figure D.9. Right target is asked to be bluer. CoVI generated using RestoreNet as VTS and the DTD as database for the BD.

Figure D.10. Right target is asked to be lighter. LVI generated using RestoreNet as VTS and the DTD as database for the BD.

Figure D.11. Right target is asked to be lighter. LVI generated using RestoreNet as VTS and CIFAR10 as database for the BD.

Figure D.12. Right target is asked to be highlighted (higher contrast). CrVI generated using RestoreNet as VTS and CIFAR10 as
database for the BD.

Figure D.13. Right target is asked to be highlighted (higher contrast). CrVI generated using RestoreNet as VTS and CIFAR10 as
database for the BD.

Figure D.14. Right target is asked to be highlighted (higher contrast). CrVI generated using RestoreNet as VTS and CIFAR10 as
database for the BD.

Figure D.15. Right target is asked to be reddish. CoVI generated using RestoreNet as VTS and the DTD as database for the BD.

Figure D.16. Right target is asked to be reddish. CoVI generated using RestoreNet as VTS and the DTD as database for the BD.

Figure D.17. Right target is asked to be bluer. CoVI generated using RestoreNet as VTS and the DTD as database for the BD.

Figure D.18. Right target is asked to be bluer. CoVI generated using RestoreNet as VTS and the DTD as database for the BD.

Figure D.19. Right target is asked to be yellower. CoVI generated using RestoreNet as VTS and the DTD as database for the BD.

Figure D.20. Right target is asked to be yellower. CoVI generated using RestoreNet as VTS and the DTD as database for the BD.

Figure D.21. Right target is asked to be lighter. LVI generated using RestoreNet as VTS and the DTD as database for the BD.

Figure D.22. Right target is asked to be lighter. LVI generated using RestoreNet as VTS and the DTD as database for the BD.

Figure D.23. Right target is asked to be lighter. LVI generated using RestoreNet as VTS and CIFAR10 as database for the BD.

