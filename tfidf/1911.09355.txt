A Probabilistic Approach for Discovering Daily Human Mobility Patterns with Mobile
Data

Weizhu Qian

Fabrice Lauri

Franck Gechter

CIAD, Univ. Bourgogne Franche-Comt ´e,
UTBM, F-90010
Belfort, France
Email: weizhu.qian@utbm.fr

CIAD, Univ. Bourgogne Franche-Comt ´e,
UTBM, F-90010
Belfort, France
Email: fabrice.lauri@utbm.fr

CIAD, Univ. Bourgogne Franche-Comt ´e,
UTBM, F-90010
Belfort, France
Email: franck.gechter@utbm.fr

9
1
0
2

v
o

N

1
2

]

G

L

.

s

c

[

1
v
5
5
3
9
0

.

1
1
9
1

:

v

i

X

r

a

Abstract—Discovering human mobility patterns with geo-
location data collected from smartphone users has been a hot
research topic in recent years. In this paper, we attempt to
discover daily mobile patterns based on GPS data. We view this
problem from a probabilistic perspective in order to explore
more information from the original GPS data compared to
other conventional methods. A non-parameter Bayesian modeling
method, Inﬁnite Gaussian Mixture Model, is used to estimate the
probability density for the daily mobility. Then, we use Kullback-
Leibler divergence as the metrics to measure the similarity
of different probability distributions. And combining Inﬁnite
Gaussian Mixture Model and Kullback-Leibler divergence, we
derived an automatic clustering algorithm to discover mobility
patterns for each individual user without setting the number
of clusters in advance. In the experiments, the effectiveness
of our method is validated on the real user data collected
from different users. The results show that the IGMM-based
algorithm outperforms the GMM-based algorithm. We also test
our methods on the dataset with different lengths to discover the
minimum data length for discovering mobility patterns.
Index Terms—Probabilistic model; Inﬁnite Gaussian Mixture
Model; Kullback-Leibler divergence; Human mobility.

I . IN TRODUC T ION

SMART PHON E devices are equipped with multiple sensors
that can record user behavior on the handsets. With the
help of a large-scale smartphone usage data, researchers are
able to study human behavior in the real world. Since location
information is one of the crucial aspects of human behaving,
investigating human mobility from mining mobile data has
become recently a popular research topic.
Previous research in this ﬁled mainly only focus on discov-
ering the signiﬁcant places or predicting the transition among
the signiﬁcant places [1], [2], [3]. However, these research
neglect the data sampled at the places where one stay for a
relatively short time, for instance, in the middle of transitions.
As opposed to this point of view, we believe that these data
is important for revealing human mobility patterns as well.
To characterize human mobility, we should realize that there
are multiple patterns lying in the mobility data even for the
same individuals. For example, normally, on workdays, one
goes to work or school at daytime while on weekends, he/she
may prefer to stay at home. As a result, the mobility on
weekends is different from the one on workdays. Therefore,

for each user, it is reasonable to depict the trajectory for each
day and then discover the common mobility patterns shared
by the trajectories of different days.
In our work, the human mobility is recorded by the GPS
module embedded on the smartphone devices. It should be
emphasized that the GPS data (longitudes and latitudes) is
not evenly distributed spatially because one may stay longer
at a signiﬁcant place (i.e, home or workplace/school) than at
a less signiﬁcant place (i.e, restaurants or the roads). Thus,
an appropriate description for human mobility is to treat the
location of an individual as a set of data points randomly
distributed in the space with respect to different probabilities.
Moreover, in practice, the data collecting procedure may not
be continuous all the time because the GPS module is turned
off or does not function sometimes. As a consequence, it arises
the issue of data sparsity. In general, the human mobility GPS
data has the following properties:
• The data has latent structures.
• The data is not evenly distributed in space.
• The data is sparse and noisy.
These unique data characteristics prevent researchers adopt-
ing some conventional methods. Therefore, in our work, we
adopt a probabilistic approach to describe the daily human
mobility. As compared to the conventional methods, we be-
lieve our approach can explore more information from the
original GPS data and decrease the impact of data sparsity.
The approach presented in this paper is aimed at investigating
this hypothesis and is structured into three steps as shown in
Fig. 1.
The ﬁrst stage of the method is to estimate the probability
density for each day’s trajectories. For such task, Gaussian
Mixture Model [4] is a possible solution. However, the stan-
dard Gaussian Mixture Model needs to set the number of
components in advance, which is not practical to implement
because trajectory data can be statistically heterogeneous and
a ﬁxed component number for every daily trajectories is not
appropriate. To handle this problem, we adopted the Inﬁnite
Gaussian Mixture Model [5], in which the Dirichlet process
prior is used to modify the mixed weights of components.
To measure the difference between different mobility proba-
bility densities, the Kullback-Leibler divergence [6] estimator

 
 
 
 
 
 
are tackling in this paper. In Section IV, the proposed method
is depicted. In Section V presents the conducted experiment
and its results to evaluate our method with real user data.
Finally, we conclude our paper and discuss about the future
work in Section VI.

I I . R ELAT ED WORK

In literature, previous research such as [7], [8], [9], [10],
[11], [12] which were studying human mobility with mobile
data, mainly focused on tasks such as extracting signiﬁcant
places, predicting next visiting places, predicting visit duration
or clustering trajectories.
A widespread topic is to predict human mobility with
the smartphone usage contextual information, e.g., temporal
information, application usage, call logs, WiFi status, Cell
ID, etc. In [2] and [13] for instance, the researchers applied
various machine learning techniques to accomplish prediction
tasks such as next-time slot
location prediction and next-
place prediction. In particular, they exploited how different
combinations of contextual features related to smartphone
usage can affect prediction accuracy. Meanwhile, they also
compared the predicting performance of individual models and
generic models.
Another frequently-used method for such tasks is to use
probabilistic models. Through calculating the conditional
probabilities between contextual features, [14] developed the
contextual conditional models for the next-place prediction
and visit duration prediction. In [15] and [16], the researchers
presented the probabilistic prediction frameworks based on
kernel density estimation. [15] utilized conditional kernels
density estimation to predict the mobility events while [16]
devised different kernels for different context
information
types. And in [3], the authors developed a location Hierarchical
Dirichlet Process (HDP) based approach to model heteroge-
neous location habits under data sparsity.
In addition, generative models can also be applied to predict
human mobility. This type of models can be Nave Bayes
[17], Markov Model [18], Hidden Markov Model (HMM)
[19] or Dynamic Bayesian Network (DBN) [20], [21], etc.
These generative models attempt to predict the future states of
human behavior by computing the state transition probabilities.
However, when the number of states expands, the calculation
grows exponentially.
Among the other possible approaches, [22] proposed a
Hypertext Induced Topic Search-based inference model for
mining interesting locations and travel sequences using a large
GPS dataset in certain region. In [1], the authors employed
the random forests classiﬁers to label different places without
any geo-location information. [23] made use of nonlinear time
series analysis of the arrival
time and residence time for
location prediction.
In particular, for clustering user trajectories, there exists
several different methods. However, these conventional algo-
rithms are not applicable to our objectives. For example, some

Fig. 1. Overview of our method.

is used. The Kullback-Leibler divergence is an asymmetric
metric, which means the distance from distribution p to
distribution q is not the same as the distance from distribution
q to distribution p unless they are identical distributions. We
exploit the inequality property of KL divergence to reveal the
subordinate relationship of one trajectory to another.
Finally, we devise a clustering algorithm using the Inﬁnite
Gaussian Mixture Models with Kullback-Leibler divergence to
discover the mobility patterns existing in human mobility data.
More importantly, as compared to traditional methods, our
clustering algorithm is automatic because it does not require
a preset of the pattern number.
The work presented in this paper has then 3 main contribu-
tions:
• For estimating probability density of daily mobility, we
illustrate that the Inﬁnite Gaussian Mixture Models out-
perform the Gaussian Mixture Models.
• We prove that Kullback-Leibler divergence is an ap-
propriate metrics to measure the closeness of mobility
probability densities.
• We develop a clustering algorithm based on Inﬁnite Gaus-
sian Mixture Model and Kullback-Leibler divergence to
ﬁnd the human mobility patterns.
The reminder of the paper is organized as follows. Section II
surveys the related work. Section III addresses the problem we

researchers used K-means [24], [25] in their work, whereas K-
means can not handle the trajectories with complex shapes or
noisy data because it is based on Euclidean distance. Besides,
it also need the pre-knowledge of cluster number, which is not
acquirable in many cases.
Though DBSCAN [26], [18], a density based clustering
techniques, can deal with data with arbitrary shapes and does
not require the number of cluster in advance. However, it still
needs to set the minimum points number and neighbourhood
radius to recognize core areas and it
treats the non-core
data points as noise. From our study, we argue that
the
trajectory parts with less data density are also essential to
demonstrate the human mobility trajectories. And the grid
searching algorithm [14] focus on detecting the stay points
within a set of square regions and fails to reveal the mobility
at a larger scale.
In this paper we decided to focus on a probabilistic point
of view. As compared to aforementioned previous works, we
aim at describing the daily trajectories using their probability
densities. Moreover, to discover the common mobility pat-
terns shared among these trajectories, we devise an automatic
clustering algorithm. As opposed to traditional clustering
algorithms, our method is able to exploit more information
from the sparse and noisy original GPS data and free from
pre-deﬁning clusters number.

I I I . PROBL EM FORMU LAT ION

As expressed in introduction, our purpose is to discover the
mobility patterns for each individual from their GPS location
data.
As shown in Fig. 2, the mobility for one individual consists
of many different trajectories (the data is from the MDC
dataset,
the detailed data description will be in following
experiments). We believe that one’s daily mobility is rather
regular and there are common mobility patterns shared among
different daily trajectories. From a common sense, one may
follow the regular daily itineraries, for instance, home-work
place/school-home. Yet, on different days the daily itineraries
may not be the same, for instance, on the way to home, one
may take a detour to do shopping in a supermarket sometimes.
Hence, our objective is to discover all the potential daily
mobility from the data with location information.
We extract each day’s trajectory from the whole dataset
as shown in Fig. 3. Fig. 3 reveals that a daily trajectories
recorded by GPS data is not distributed evenly in space, and
is even not continuous in some areas. It may be caused by the
data collecting procedure: some data collecting time range is
actually relatively short (less than 24 hours, in fact, only few
hours sometimes), which leads to the data sparsity problem.
In order to overcome this problem and exploit as much
information as possible from the GPS data, we argue that
a reasonable way to describe the daily trajectories is to
estimate the probability density of the location data. And the
relationship among the trajectories can be represented by their

Fig. 2. GPS data for a randomly selected user. Different colors represent
different days.

Fig. 3. One randomly selected daily trajectories for a given user.

probability densities. As a result, we can discover all the
mobility patterns for each user.
The tasks in this paper will be as follows:
• Task 1: Estimate the probability density for mobility for
each day. We will compare results of GMM and IGMM.
• Task 2: Measure the closeness between different trajec-
tories. We will use the KD divergence as metrics.
• Task 3: Discover the similar mobility patterns among all
the recorded daily trajectories. This can be regarded as a
clustering problem.
• Task 4: Compare the IGMM algorithm with the GMM
based algorithms.
• Task 5: Identify the minimum data length for discovering
all mobility patterns.

IV. PRO PO SED M E THOD

A. Estimate Daily Trajectories Probability Density
We assume that the GPS location data points are distributed
randomly spatially. Besides, the distribution of each day con-
sists of unknown number of heterogeneous sub-distributions.
Therefore, it is reasonable to adopt mixed Gaussian models
for estimating probability density of daily mobility.

1) Gaussian Mixture Model: A Gaussian Mixture Model
(GMM) is composed of a ﬁxed number K of sub components.
The probability distribution of a GMM can be described as
follows:

P (x) =

πk P (x|θk )

(1)

k=1

probability for each model, with (cid:80)K
where, x is the observable variable, πk is the assignment
and θk is the internal parameters of the base distribution.
Let zn be the latent variables for indicating categories.

k=1 πk = 1, (0 < πk < 1),

K(cid:88)

zn ∼ C ategorical(zn |π)

znk = 1

(2)

k=1

where, zn = [zn1 , zn2 , ..., znk , ..., znK ], in which only one

element znk = 1. It means xn is correspondent to θk .
If the base distribution is a Gaussian, then:

P (x|θk ) = N (x|µk , Λ−1
k )

(3)

where, µk is the mean vector and Λk is the precision matrix.
Therefore, an observable sample xn is drawn from GMM
according to:

K(cid:88)

xn ∼ K(cid:89)

k=1

N (xn |νk , Λk )znk

(4)

As it is illustrated above, one crucial issue of GMM is
to pre-deﬁne the number of components K . This is tricky
because the probability distribution for each day’s mobility is
not identical. Thus, to deﬁne a ﬁxed K for all mobility GMM
models is not suitable in our case.
2) Inﬁnite Gaussian Mixture Model: Alternatively, we re-
sort to the Inﬁnite Gaussian Mixture Model (IGMM) [5].
As compared to ﬁnite Gaussian Mixture Model, by using a
Dirichlet process (DP) prior, IGMM does not need to specify
the number of components in advance. Fig. 4 presents the
graphical structure of the Inﬁnite Gaussian Mixture Model.
In Fig. 4, the nodes represents the random variables and
especially, the shaded node is observable and the unshaded
nodes are unobservable. The edges represent the conditional
dependencies between variables. And the variables are within
the plates means that they are drawn repeatedly.
According to Fig. 4, the Dirichlet process can be depicted
as:

G ∼ DP (α, G0 )

(5)

where, G is a random measure, which consists of inﬁnite
base measure G0 and λ is the hyper-parameter of G0 . In
our case, it is a series of Gaussian distributions. And α ∼
Gamma(1, 1) is the concentration parameter. N is the total
samples number. θk is the parameters of base distribution. Xk

Fig. 4. The plate representation of Inﬁnite Gaussian Mixture Model.

∞(cid:88)

k=1

is the observable data for θk . Zk is the latent variables that
indicates the category of Xk .
Alternatively, G can be explicitly depicted as follow:

G(θ) =

πk δθk

(6)

where, θk ∼ G0 (λ), and δ is Dirac function. πk determines
the proportion weights of the clusters and the δθk is the prior
of the θk to determine the location of clusters in space.
We choose the Stick-breaking process (SBP) [27] to im-
plement the Dirichlet process as the prior for πk . The the
Stick-breaking process can be described as follow:
k−1(cid:89)

(1 − νj ) k ≥ 2

πk = νk

(7)

j=1

where, νk ∼ B eta(1, α).

Since P (x|θ) is Gaussian, θ = {µ, Λ}. Further, let G0 be
a Gaussian-Wishart distribution, then, µk , Λk ∼ G0 (µ, Λ).
Therefore, similarly, draw an observable sample xn from
IGMM:

xn ∼

N (xn |νk , Λ−1
k )

znk

(8)

∞(cid:89)

k=1

Then, Variational Inference is used to solve the IGMM
models. As compared to Gibbs sampling or to a Markov chain
Monte Carlo (MCMC) method which consumes a large mount
of calculating time, Variational Inference is relatively fast [28].
The results will be demonstrated in the later experiments.

B. Measure Daily Trajectories Similarities

The Kullback-Leibler (KL) divergence is a metric to eval-
uate the closeness between two distributions. For continuous
variables, the KL divergence DKL (p||q) the expectation of
the logarithmic difference between the p and q with respect
to probability p and vice versa. From (9) and (10), it can be
seen that the KL divergence is non-negative and asymmetric.
In many occasions, the inequality of the KL divergence is

notorious. However, in our methodology, on the contrary, we
take advantage of the characteristics of inequality to reveal the
similarities among different trajectories instead of the Jensen-
Shannon divergence which is a symmetric metrics.

(cid:90) ∞
(cid:90) ∞

−∞

−∞

DKL (p||q) =

DKL (q ||p) =

p(x)log(

q(y)log(

p(x)
q(x)

)dx

q(y)
p(y)

)dy

(9)

(10)

There is no closed form to implement the KL divergence by
the deﬁnition of (9) and (10) for Gaussian Mixture Models.
Instead, we resort
to the Monte Carlo simulation method
proposed in [29]. Then, the KL divergence can be caculated
by:

Models. At this step, we create a list, in which the members
are the probability densities of each. Then, the ﬁrst cluster is
created with one trajectory as its ﬁrst member and it also will
be compared with other trajectories.

Afterwards, we select another daily trajectory in the list and
calculate the KL divergences, both DKL(p||q) and DKL(q ||p) .
And the new trajectory is added to the current cluster if the
minimum and maximum of the KL-divergences are smaller
than the lower bound and upper bound of the thresholds at
the same time, respectively. And if the DKL(p||q) is smaller
than DKL(q ||p) , the new trajectory become the benchmark for
the current cluster. An alternative way to do this is to compute
the probability density of the current cluster using all the data
of the discovered trajectories, however, the calculation will be
massive.

DKLM C (p||q) =

DKLM C (q ||p) =

1
n

1
n

n(cid:88)
n(cid:88)

i=1

i=1

log(

p(xi )
q(xi )

)

log(

q(yi )
p(yi )

)

(11)

(12)

This step will be repeated until all the trajectories belonging
to the current cluster are discovered at the end of this iteration.
Then, all the members of the current cluster are removed from
iteration because, we assume that each trajectories can only be
a member of one mobility pattern. At the start of new iteration,
a new cluster is created, repeat the above steps until the list
is empty. Finally, all the mobility patterns are discovered.

This method is to draw a large amount of i.i.d samples xi
from distribution p to calculate DKLM C (p||q) according to
(11) and DKLM C (p||q) → DKL (p||q) as n → ∞. And it is
the same for implementing (10) by using (12). The results
will be demonstrated in the later experiments. Furthermore,
if we deﬁne a representative trajectory for a mobility pattern
then we can distinguish whether a new trajectory belong to
this cluster by comparing it to the representative trajectory. To
do so, we need to set a threshold with a lower bound and an
upper bound for the KL divergence, then it can be used as the
metrics to cluster mobility patterns.

C. Discover Mobility Patterns

As mentioned before, our task is to ﬁnd the trajectories
which are mutually similar. For this reason, we treat the dif-
ferent mobility patterns as different clusters in which the daily
trajectories are their sub-members. Even so, the trajectories
within the same clusters still can not be treated as identically
distributed as other conventional clustering methods because
of different trajectory lengths. Hence, we need to devise a
algorithm that is able to cluster the trajectories based on the
distribution similarity and the aforementioned KL divergence
can be applicable as closeness metrics. Note that due to the
large data scale and the number of the potential clusters, a high
accuracy solution is intractable sometimes. Therefore, instead
of pursuing a very accurate result, our purpose is to reach a
relative accurate result in a reasonable amount of calculating
time.
The algorithm we devise is shown in Algorithm 1 and its
variables are described in Table I.
The ﬁrst step of the clustering algorithm is to calculate
the probability densities using the Inﬁnite Gaussian Mixture

Algorithm 1 Mobility Pattern Discovering Algorithm

Input: X
Output: M

1: P ← IGMM(X )
2: Initialize:M = {Mk }

3: while P (cid:54)= ∅ do

(cid:46) probability density estimation

(cid:46) create the mobility patterns set

(cid:46) set the baseline mobility for Mk
(cid:46) create current pattern Mk

Xs = X1
Mk = {Xs }
for d = 2, . . . , D do
DKL ← (Ps , Pd )
if (min(DKL ) < T h[0]) & (max(DKL ) < T h[1])

(cid:46) measure similarity

then

(cid:46) two patterns are similar
(cid:46) add new member

add Pd to Mk

if DKL [0] > DKL [1] then
Ps ← Pd

(cid:46) change the baseline mobility

end if
end if
end for

create Mk+1
add Mk+1 to M

18: end while

remove Pd ∈ Mk from P (cid:46) current pattern is ﬁnished

(cid:46) ﬁnd new mobility pattern

4:
5:
6:
7:
8:

9:
10:
11:
12:
13:
14:
15:

16:
17:

19:

return M

As it can be seen that our algorithm is designed to discover
the latent mobility patterns automatically without the pre-
knowledge of the numbers of existing patterns.

TABLE I . VAR IAB LE S D E SCR I P T ION

Variable

d
X
P
M
Mk
T h

DKL

Domain

{1, 2, . . . , D}
{X1 , X2 , . . . , Xd , . . . , XD }
{P1 , P2 , . . . , Pd , . . . , PD }
{M1 , M2 , . . . , Mk , . . . MK }
{Xk1 , Xk2 , . . . , Xkn }
{lowerbound, upperbound}

{DKL(p||q) , DKL(q||p) }

V. EX PER IM EN T S AND R E SU LT S

A. Dataset Description

We use the Mobile Data Challenge (MDC) dataset [30], [31]
to validate our method. This dataset records comprehensive
smartphone usages with ﬁne granularity of time. The partici-
pants of the MDC dataset are up to nearly 200 and the data
collection campaign lasts more than 18 months. This abundant
information thus can be used to investigate individual mobility
patterns.
To collect the individual location information, as compared
to other methods, for instance,
through stand-alone GPS
devices, using GPS-equipped smartphones is a more practical
way to have a larger group of participants without affecting
their daily life.
In our study, we attempt to ﬁnd the trajectories that belong
to the same mobility patterns,
thus we focus the spatial
information of the GPS records, namely, the latitudes and
longitudes and the time-stamps of the data are not considered.
Meanwhile, since we consider not only the signiﬁcant places
but all location records, we use the unlabeled data without any
semantic information.

B. Experimental Setup

In the conducted experiment, we randomly select 20 users
with sufﬁcient data. And each user’s is segmented by the time
range of one day. Fig. 5 demonstrates the number of data
collecting days for each user. It can be seen that the data
collecting days for most users are more than 200. And with
such amount of data, we believe that it is possible to discover
individual’s mobility patterns from it.
However, as it is illustrated in Fig. 6, the data length of
each day varies from less than 4 hours to 24 hours. And most
of them is less than 8 hours. Hence, we also should be aware
that some data can be missing because the GPS modules were
turned off or were not functioning. Consequently, it is one
of the reasons that cause the data sparsity problem. In the
following part, we will prove that our method can mitigate
the impact of data sparsity.
Table II summarizes the temporal information about the
GPS data for conducting the experiments.
To test the performance of our method, we will conduct
three experiments from different perspectives:
• We compare the IGMM model with the GMM model on
estimating the daily trajectories probability density.

Description
Number of data collecting day
Total GPS data (longitudes, latitudes
Probability density for X
Total mobility patterns
Discovered mobility pattern
Threshold for distinguishing patterns
KL divergences

Fig. 5. Number of data collecting days for each user

TABLE I I . DATA CO L LECT ING T IM E

Collecting days for all users
Collecting hours per day for all users
Collecting hours per day for each user

Average
300.25 days
6.93 hours
6.67 hours

Total
6005.0 days
41595.0 hours
2084.65 hours

Fig. 6. Empirical cumulative distribution of hours per data collecting days.

• We use that the KL divergence to measure the closeness
of different trajectories.
• We test our method on each selected user data so as to
ﬁnd the daily mobility patterns for each individual.

TABLE I I I . KL -D IV ERG ENC E S FOR D I FFER EN T TRA J EC TOR I E S .

p
Trajectory 1
Trajectory 1
Trajectory 1
Trajectory 1

q
Trajectory 2
Trajectory 3
Trajectory 4
Trajectory 5

DKL(p||q) DKL(p||q)

7.21
1.28
19.07
3.08

2.82
1.83
1269.47
996.17

The combinations are shown in Figure 9 and the results are
illustrated in Table III:
Trajectory 2 is nearly a subset of Trajectory 1 and thus
DKL (p||q) is larger than DKL(p||q) . And their values are
both small, thus Trajectory 2 and Trajectory 1 can be re-
garded to belong to the same mobility pattern. Trajectory
3 is very similar to Trajectory 1 and DKL (p||q) almost
equals to DKL (q ||p). Hence, they also are the members of
the same mobility pattern. Trajectory 4 share a small part
with Trajectory 1 whereas generally they are very different.
DKL (p||q) and DKL (q ||p) are both very large. Therefore, it
is reasonable to recognize Trajectory 4 and Trajectory 1 as
different patterns. And Trajectory 5 is totally different from
Trajectory 1. And DKL (p||q) is small but DKL (p||q) are very
large. So they naturally are not in the same pattern. According
to the trajectories in the Fig. 9 and the results in Table III, it
shows that the KL divergence is able to illustrate the difference
among trajectories and can be the metrics for clustering.
3) Discovering Daily Mobility Patterns: We run our al-
gorithm on the data of the 20 users to discover their daily
mobility patterns.
• Discovered Patterns: The partial results for different
randomly selected user data are demonstrated in Fig. 10.
It shows that, after clustered by our proposed algorithm,
the data is split into different mobility patterns. Each
cluster is composed of trajectories close to each other
even if they are not distributed with the same density in
the space. That proves our methodology is able to ﬁnd
the different mobility patterns even under the condition
of noisy data and discontinuous trajectories.
Fig. 11 shows that our methodology is not only able to
identify the different patterns in the daily trajectories data
but is also able to ﬁnd the most representative trajectories
for each mobility pattern.

• Number of Patterns and Trajectories: Fig. 12 shows the

number of discovered mobility pattern for all the user in
our experiments. We can see that the number of mobility
patterns varies from 5 to more than 30 and most of them
are about 10 to 15. It also can be found that the lengths
of data collecting days are not proportional to the number
of discovered mobility patterns, which indicates that the
results rely more on the individual behavior rather than
the data length.

• Number of members for each patterns: Fig. 13 depicts

the number of members for each discovered mobility
patterns for all users. We can see that most mobility
patterns consist of less than 50 trajectories. And nearly
40% of the patterns have only one trajectory, whereas few

Fig. 7. Distribution estimation by GMM (negative log-likelihood)

Fig. 8. Distribution estimation by IGMM (negative log-likelihood)

• We compare the results of the IGMM models to a series
of ﬁxed-number components GMM models.
• We run the algorithm on the varying-length datasets, in
the aim to ﬁnd the minimum data length for discovering
most mobility patterns of one individual.

C. Experimental Results

1) Probability Density Estimation: Fig. 7 and Fig. 8 show
the density estimation results obtained by GMM and IGMM,
respectively. It can be seen that, compared to the GMM model,
the result of the IGMM model is more smooth. It suggests
that IGMM is not affected by the number of components
and it infers more information from the original data and
it is less inﬂuenced by data sparsity. That is to say, on the
same dataset, the computational results of IGMM have higher
ﬁdelity. Hence, in our approach, we chose IGMM to estimate
probability density of daily mobility.
2) Measuring Daily Trajectories Similarities: As shown in
Fig. 9, we select 5 daily trajectories from the data of one
random user to present the KD divergences between different
trajectories. The baseline trajectory is the Trajectory 1 and the
rest of trajectories are chosen to make comparisons.

(a) Trajectory 1 and Trajectory 2

(b) Trajectory 1 and Trajectory 3

(c) Trajectory 1 and Trajectory 4

(d) Trajectory 1 and Trajectory 5

Fig. 9. Comparison Between Different Trajectories.

patterns have more than 100 trajectories.
One needs to notice that the number of discovered patterns
depends on the Kullback-Leibler divergence thresholds we set
in the clustering algorithm. When the thresholds are small, it
means that the condition to be in the same mobility pattern
is more strict and naturally the discovered mobility patterns
are more and the member of each patterns are less, and vice
versa.
4) Comparison to GMM: To compare the Inﬁnite Gaussian
Mixture Models, we use a group of Gaussian Mixture Models
with different numbers of components to estimate the daily
mobility probability densities in our proposed clustering algo-
rithm. The metrics we adopt to evaluate the results is the mean
log-likelihood. The results show in Table IV that changing
the ﬁxed number of component Gaussian Mixture Models can
not enhance the clustering performance. On the contrary, the
Inﬁnite Gaussian Mixture Models can improve the clustering
performance.

TABLE IV . OV ERA LL M EAN LOG - L IKE L IHOOD FOR D I FFER EN T MODE L S

Model
GMM-1
GMM-2
GMM-3
GMM-4
GMM-5
IGMM

Mean log-likelihood
-26078.15
-38514.32
-52431.62
-63794.70
-73508.10

-24871.78

5) Varying Data Length: To investigate how the data
length, namely, the number of days of the data, affects the

results, we utilize different data lengths which varies from 50
days to 350 days. The results are shown in Fig. 14. It can
be seen that, from 50-day data length to 200-day data length,
the average discovered mobility pattern numbers increase as
the data length grows. While, when the data length is larger
than 200 days, the patterns numbers change marginally. Thus,
according to the results, we can say that, generally, a 200-day
GPS dataset is large enough to discover most of the mobility
patterns of an individual.

V I . CONC LU S ION AND P ER S PEC T IV E

In this work, we presented a probabilistic approach to
discover human daily mobility patterns based on GPS data
collected by smartphones.
In our approach, the human daily mobility is considered
as sets of probability distributions. The proposed approach is
divided into three parts. The ﬁrst step is to estimate the prob-
ability densities. We argue that the Inﬁnite Gaussian Mixture
Model is more appropriate than the standard Gaussian Mixture
Model to this issue, this argument being besides validated by
the experimental results. Further, in order to ﬁnd the similar
trajectories, one needs to measure the closeness between the
trajectories. For this task, we chose the Kullback-Leibler
divergence as distance metrics. According to the computational
results from the selected trajectories, we validated, on test
sets, that KL divergence is able to measure the similarities
among the trajectories. Finally, we devised a novel automatic

Fig. 10. Discovered mobility patterns from three random selected users.
Different colors represents different days.

Fig. 11. Representative trajectories for each discovered mobility patterns.

clustering algorithm combining the advantages of both IGMM
and the KL divergence so as to discover human daily mobility
patterns without having the knowledge of the cluster number
in advance.
For validation, we select 20 random individual data from
the MDC dataset to conduct the different experiments. The
results obtained show that our proposed approach can discern
different mobility patterns and select the most representative
trajectories for each mobility patterns from the GPS data. In
addition, we also compared the IGMM based algorithm with
a group of GMM based algorithms with various ﬁx-number
components, the results reveal that the IGMM model performs
better. Finally, testing varying-length dataset on our methods
leads to results which suggest that a 200-day GPS is generally
sufﬁcient enough to discover most of the individual daily
mobility patterns.
We are aware of that human mobility is also a time-related
behavior. Thus, as future work, we plan to take into account
the temporal information, for example, hour of day and day
of week. Based on that, we will try to build a spatial-temporal
probabilistic model to predict human mobility. In addition,
for further study, we may exploit other smartphone usage
information (i.g., application usage) in the dataset to obtain
more knowledge about human behavior.

Fig. 12. Number of discovered mobility patterns for each user.

ACKNOW L EDGM ENT

The research in this paper used the MDC Database made
by Idiap Research Institute, Switzerland and owned by Nokia.
The authors would like to thank the MDC team for providing
the access to the database.

R E F ER ENC E S

[1] T. M. T. Do and D. Gatica-Perez, “The places of our lives: Visiting
patterns and automatic labeling from longitudinal smartphone data,”

[12] H. Cao, N. Mamoulis, and D. W. Cheung, “Discovery of periodic
patterns in spatiotemporal sequences,” IEEE Transactions on Knowledge
and Data Engineering, vol. 19, no. 4, pp. 453–467, 2007.
[13] T. M. T. Do and D. Gatica-Perez, “Where and what: Using smartphones
to predict next locations and applications in daily life,” Pervasive and
Mobile Computing, vol. 12, pp. 79–91, 2014.
[14] T.-M.-T. Do and D. Gatica-Perez, “Contextual conditional models for
smartphone-based human mobility prediction,” in Proceedings of the
2012 ACM conference on ubiquitous computing. ACM, 2012, pp. 163–
172.
[15] T. M. T. Do, O. Dousse, M. Miettinen, and D. Gatica-Perez, “A proba-
bilistic kernel method for human mobility prediction with smartphones,”
Pervasive and Mobile Computing, vol. 20, pp. 13–28, 2015.
[16] A. Peddemors, H. Eertink, and I. Niemegeers, “Predicting mobility
events on personal devices,” Pervasive and Mobile Computing, vol. 6,
no. 4, pp. 401–423, 2010.
[17] M. Muhlenbrock, O. Brdiczka, D. Snowdon, and J.-L. Meunier, “Learn-
ing to detect user activity and availability from a variety of sensor
data,” in Second IEEE Annual Conference on Pervasive Computing and
Communications, 2004. Proceedings of the.
IEEE, 2004, pp. 13–22.
[18] C. Yu, Y. Liu, D. Yao, L. T. Yang, H. Jin, H. Chen, and Q. Ding,
“Modeling user activity patterns for next-place prediction,” IEEE Sys-
tems Journal, vol. 11, no. 2, pp. 1060–1071, 2017.
[19] S.-B. Cho, “Exploiting machine learning techniques for location recog-
nition and prediction with smartphone logs,” Neurocomputing, vol. 176,
pp. 98–106, 2016.
[20] V. Etter, M. Kafsi, E. Kazemi, M. Grossglauser, and P. Thiran, “Where
to go from here? mobility prediction from instantaneous information,”
Pervasive and Mobile Computing, vol. 9, no. 6, pp. 784–797, 2013.
[21] D. J. Patterson, L. Liao, D. Fox, and H. Kautz, “Inferring high-
level behavior from low-level sensors,” in International Conference on
Ubiquitous Computing. Springer, 2003, pp. 73–89.
[22] Y. Zheng, L. Zhang, X. Xie, and W.-Y. Ma, “Mining interesting locations
and travel sequences from gps trajectories,” in Proceedings of the 18th
international conference on World wide web. ACM, 2009, pp. 791–800.
[23] S. Scellato, M. Musolesi, C. Mascolo, V. Latora, and A. T. Campbell,
“Nextplace: a spatio-temporal prediction framework for pervasive sys-
tems,” in International Conference on Pervasive Computing. Springer,
2011, pp. 152–169.
[24] S. Jiang, J. Ferreira, and M. C. Gonz ´alez, “Clustering daily patterns of
human activities in the city,” Data Mining and Knowledge Discovery,
vol. 25, no. 3, pp. 478–510, 2012.
[25] D. Ashbrook and T. Starner, “Using gps to learn signiﬁcant locations
and predict movement across multiple users,” Personal and Ubiquitous
computing, vol. 7, no. 5, pp. 275–286, 2003.
[26] J. Tang, F. Liu, Y. Wang, and H. Wang, “Uncovering urban human mo-
bility from large scale taxi gps data,” Physica A: Statistical Mechanics
and its Applications, vol. 438, pp. 140–153, 2015.
[27] J. Sethuraman, “A constructive deﬁnition of dirichlet priors,” Statistica
sinica, pp. 639–650, 1994.
[28] D. M. Blei, M. I. Jordan et al., “Variational inference for dirichlet
process mixtures,” Bayesian analysis, vol. 1, no. 1, pp. 121–143, 2006.
[29] J. R. Hershey and P. A. Olsen, “Approximating the kullback leibler di-
vergence between gaussian mixture models,” in 2007 IEEE International
Conference on Acoustics, Speech and Signal Processing-ICASSP’07,
vol. 4.
IEEE, 2007, pp. IV–317.
[30] N. Kiukkonen, J. Blom, O. Dousse, D. Gatica-Perez, and J. Laurila, “To-
wards rich mobile phone datasets: Lausanne data collection campaign,”
Proc. ICPS, Berlin, vol. 68, 2010.
[31] J. K. Laurila, D. Gatica-Perez,
I. Aad, O. Bornet, T.-M.-T. Do,
O. Dousse, J. Eberle, M. Miettinen et al., “The mobile data challenge:
Big data for mobile computing research,” Tech. Rep., 2012.

Fig. 13. Empirical cumulative distribution of discovered patterns’ members.

Fig. 14. Average number of discovered patterns for different data collecting
day length. Error bars represent the standard deviation.

IEEE Transactions on Mobile Computing, vol. 13, no. 3, pp. 638–648,
2014.
[2] P. Baumann, C. Koehler, A. K. Dey, and S. Santini, “Selecting individual
and population models for predicting human mobility,” IEEE Transac-
tions on Mobile Computing, vol. 17, no. 10, pp. 2408–2422, 2018.
[3] J. McInerney, J. Zheng, A. Rogers, and N. R. Jennings, “Modelling het-
erogeneous location habits in human populations for location prediction
under data sparsity,” in Proceedings of the 2013 ACM international joint
conference on Pervasive and ubiquitous computing. ACM, 2013, pp.
469–478.
[4] D. Reynolds, “Gaussian mixture models,” Encyclopedia of biometrics,
pp. 827–832, 2015.
[5] C. E. Rasmussen, “The inﬁnite gaussian mixture model,” in Advances
in neural information processing systems, 2000, pp. 554–560.
[6] S. Kullback, Information theory and statistics. Courier Corporation,
1997.
[7] X. Lu, E. Wetter, N. Bharti, A. J. Tatem, and L. Bengtsson, “Approaching
the limit of predictability in human mobility,” Scientiﬁc reports, vol. 3,
p. 2923, 2013.
[8] J. Ye, S. Dobson, and S. McKeever, “Situation identiﬁcation techniques
in pervasive computing: A review,” Pervasive and mobile computing,
vol. 8, no. 1, pp. 36–66, 2012.
[9] M. Lin and W.-J. Hsu, “Mining gps data for mobility patterns: A survey,”
Pervasive and mobile computing, vol. 12, pp. 1–16, 2014.
[10] P. Pirozmand, G. Wu, B. Jedari, and F. Xia, “Human mobility in
opportunistic networks: Characteristics, models and prediction methods,”
Journal of Network and Computer Applications, vol. 42, pp. 45–58,
2014.
[11] Y. Zheng, “Trajectory data mining: an overview,” ACM Transactions on
Intelligent Systems and Technology (TIST), vol. 6, no. 3, p. 29, 2015.

