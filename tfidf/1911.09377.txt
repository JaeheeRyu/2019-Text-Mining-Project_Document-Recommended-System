9
1
0
2

v
o

N

1
2

]

n
n

-

s

i

d

.

t

a

m

-

d
n
o

c

[

1
v
7
7
3
9
0

.

1
1
9
1

:

v

i

X

r

a

SciPost Physics

Submission

The asymptotics of the clustering transition for random
constraint satisfaction problems

L. Budzynski1* , G. Semerjian1

1 Laboratoire de physique de l’Ecole normale sup´erieure, ENS, Universit´e PSL, CNRS,
Sorbonne Universit´e, Universit´e de Paris, F-75005 Paris, France
* louise.budzynski@ens.fr

November 22, 2019

Abstract

Random Constraint Satisfaction Problems exhibit several phase transitions when
their density of constraints is varied. One of these threshold phenomena, known
as the clustering or dynamic transition, corresponds to a transition for an infor-
mation theoretic problem called tree reconstruction. In this article we study this
threshold for two CSPs, namely the bicoloring of k-uniform hypergraphs with a
density α of constraints, and the q-coloring of random graphs with average de-
gree c. We show that in the large k , q limit the clustering transition occurs for
k (ln k + ln ln k + γd + o(1)), c = q(ln q + ln ln q + γd + o(1)), where γd is the same
constant for both models. We characterize γd via a functional equation, solve
the latter numerically to estimate γd ≈ 0.871, and obtain an analytic lowerbound
γd ≥ 1 + ln(2(√2 − 1)) ≈ 0.812. Our analysis unveils a subtle interplay of the cluster-
ing transition with the rigidity (naive reconstruction) threshold that occurs on
the same asymptotic scale at γr = 1.

α = 2k−1

Contents

1 Introduction

2 The tree reconstruction problem for ﬁnite k
2.1 The recursive distributional equations for the tree reconstruction problem
2.2 Numerical resolution for ﬁnite k
2.3 The naive reconstruction procedure
2.4 The distribution of the soft ﬁelds

3 The large k limit for a ﬁnite distance n
3.1 Evolution of the hard ﬁelds
3.2 The reduced order parameter
3.3 Evolution of the soft ﬁelds distribution

4 The limit of large distance n
4.1 The regime γ ≥ γr = 1
4.2 The diﬃculties for γ < 1

1

2

5
5
9
10
12

13
13
14
15

16
17
19

 
 
 
 
 
 
SciPost Physics

Submission

4.3 Reweighted probability distributions
4.4 Numerical resolution
4.5 The ﬁxed point equation and the determination of γd
4.6 An analytic lowerbound on γd

5 Conclusion

A The graph coloring case

References

1 Introduction

19
22
25
28

29

30

33

A Constraint Satisfaction Problem (CSP) is a system of N variables that can take discrete
values, with M constraints that each enforce some requirements on a subset of the variables,
a solution of the CSP being an assignement of the variables which satisﬁes simultaneously
all the constraints. The two examples of CSPs that will appear in this paper are the graph
coloring and the hypergraph bicoloring problems. In the ﬁrst one the variables are placed on
the vertices of a graph, they have q possible values, to be interpreted as colors, and each edge
of the graph enforce the constraint that the two vertices at its ends take diﬀerent colors. The
hypergraph bicoloring problem is similarly deﬁned on an hypergraph, with hyperedges linking
subsets of k (instead of two for a graph) vertices; the variables on the vertices can take two
colors, and the constraint associated to each hyperedge is that both colors are present among
its k adjacent vertices.
CSPs can be studied from several diﬀerent perspectives; computational complexity the-
ory [1, 2] classiﬁes them according to their worst-case diﬃculty, assessed by the existence or
not of an eﬃcient algorithm (running in a time polynomial in N , M ) able to solve (i.e. to
determine the existence or not of a solution) all their possible instances. Another line of
work [3–11], in which this paper ﬁnds its place, concentrates on the characterization of the
typical instances of a CSP, where typical refers to a random ensemble of instances, most
importantly the one obtained by drawing the M constraints uniformly at random.
In the
examples mentioned above this corresponds to study G(N , M ) Erd˝os-R´enyi random graphs,
or their hypergraph generalization. One striking feature of these models is the appearance
of phase transitions, or threshold phenomena, when the large size limit (also called thermo-
dynamic limit) N , M → ∞ is taken with a ﬁxed value of the control parameter α = M /N ,
the density of constraints per variable. At these phase transitions some properties that were
true with high probability (w.h.p., i.e. with a probability going to one in the large size limit)
for a certain value of α become false w.h.p. when α is modiﬁed inﬁnitesimally. For instance
the satisﬁability threshold αsat separates an underconstrained, satisﬁable regime α < αsat
where typical instances of a random CSP do admit solutions from an overconstrained regime
α > αsat where no solution typically exists.
Several other phase transitions occur in the satisﬁable phase α < αsat , at which the
structure of the set of solutions undergoes qualitative changes; in this paper we concentrate

2

SciPost Physics

Submission

on one of them, the so-called clustering (or dynamic) transition that occurs at a critical
control parameter denoted αd . This transition can be deﬁned in various ways; the name
clustering emphasizes the drastic change of the shape of the set of solutions, viewed as a
subset of the whole conﬁguration space. Below αd the set of solutions of typical instances is
rather well-connected, any solution can be reached from any other one by a rearrangement
of a non-extensive number of variables. Above αd the solution set splits in a large number
of distinct groups of solutions, called clusters, which are internally well-connected but well-
separated one from the other. In the cavity method [12] treatment of the random CSPs αd
is deﬁned as the appearance of a solution of the one step of Replica Symmetry Breaking
(1RSB) equation with Parisi breaking parameter m = 1, and can also be interpreted as the
birth of some long-range correlation between the spin variables under the uniform probability
measure over the set of solutions. This correlation is not the usual two-point function but
rather a point-to-set correlation function [13], that measures how much information on the
value of one spin variable (the point) is provided by the observation of all spins at distance n
from it (the set). This correlation decays to zero at large distance for α < αd , and becomes
long-ranged for α > αd ; this was shown in [13] to imply the divergence of the relaxation time

SciPost Physics

Submission

equation. In particular, for the hypergraph bicoloring and coloring problems, its asymptotic
expansion at large k , q shows that the relevant scale of constraint densities (for the graph
coloring problem we use the more natural average degree c = 2α) is

α = α(k , γ ) =

2k−1

k

(ln k + ln ln k + γ ) ,

c = c(q , γ ) = q(ln q + ln ln q + γ ) ,

(1)

k

with γ a ﬁnite constant parameter, the rigidity transition αr occuring on this scale when
γ crosses the critical value γr = 1 (for both models).
It turns out that the asymptotic
behavior of αd is also on the scale of Eq. (1), with another constant γd ≤ γr . This statement
follows from a series of rigorous works on this problem: for the coloring problem [19] proved
that 1 − ln 2 ≤ γd ≤ γr = 1, and the strict inequality γd < 1 was later obtained in [21],
implying the asymptotic existence of a regime [γd , γr ] where reconstruction is possible but
naive reconstruction is not. A large family of models, including the two discussed here, was
also adressed in [20] which proved αd (k) ≥ 2k−1
ln k , cd (q) ≥ q ln q , conﬁrming the leading
term in the scaling (1).
We report in this paper a study of the asymptotic expansion of αd for the graph coloring
and hypergraph bicoloring problems. We will show that the transition indeed happens on the
scale of constraint densities deﬁned in (1), with the same value of γd for both models, which is
to some extent surprising given their diﬀerent microscopic nature. We characterize γd in terms
of the behavior of a functional equation, whose numerical study yields the estimate γd ≈ 0.871,
while an analytical treatment provides the lowerbound γd ≥ 1 + ln(2(√2 − 1)) ≈ 0.812. Even
with the less demanding level of rigor of theoretical physics, to which we stick here, the
computation is relatively involved because of the asymptotic proximity of the thresholds αd
and αr , at the origin of a quite singular behavior of the probability distributions describing
the intermediate regime of reconstruction without naive reconstruction. This might be an
explanation for some previous incorrect statements in the literature, in particular [23] wrongly
claimed that γd = γr for the k-SAT problem.
The rest of the paper is organized as follows. We start in Section 2 by deﬁning more
explicitly the tree reconstruction problem and the basic equations that describe it. Then
in Sec. 3 we perform the large k limit on the hypergraph bicoloring model and reduce the
determination of γd to the study of a reduced set of equations, in which k does not appear
anymore. This reduced problem takes the form of recursive equations on a sequence of prob-
ability distributions, determining a correlation function at distance n. The study of the large
n limit of this reduced problem, from which γd can be ﬁnally deduced, is performed in Sec. 4;
this limit requires some additional reparametrizations in the interesting regime. Finally we
draw our conclusions and propose some perspectives for future works in Sec. 5. For simplicity
in the main part of the text we concentrate on the hypergraph bicoloring case, and devote the
Appendix A to the graph coloring problem: we show that the large q limit yields exactly the
same reduced problem than the large k limit of the hypergraph bicoloring, hence the study
of Sec. 4 and the determination of γd is common to both.

4

SciPost Physics

Submission

Figure 1: An example of an hypertree, vertices being represented by circles, while hyperedges
are drawn as squares linked to k vertices, with k = 3 on the ﬁgure.

2 The tree reconstruction problem for ﬁnite k

2.1 The recursive distributional equations for the tree reconstruction prob-
lem

As mentioned in the introduction the dynamic transition αd can be characterized in several
ways; we shall exploit here the perspective provided by the tree reconstruction problem, that
we now brieﬂy describe in the speciﬁc case of the hypergraph bicoloring, referring the reader
to [14, 15] for more generic and extensive discussions. Consider an hypertree G = (V , E ), with
vertices i ∈ V , and hyperedges a ∈ E , where an hyperedge is a set denoted ∂ a of k ≥ 3 vertices
(see Fig. 1 for an example); we shall denote similarly ∂ i the set of hyperedges adjacent to a
vertex i. An Ising spin variable σi ∈ {−1, +1} is placed on each vertex i ∈ V of the hypertree,
with their global conﬁguration denoted σ = {σi , i ∈ V }, the notation σS = {σi , i ∈ S }
corresponding to the conﬁguration on a subset S ⊂ V of the vertices. A proper bicoloring of
G is deﬁned as a conﬁguration σ such that no hyperedge is monochromatic, in other words
every hyperedge must have among its k neighboring vertices at least one spin equal to +1
and one equal to −1. The uniform distribution over these proper bicolorings, η(σ ), can thus
be written as

η(σ ) =

1

Z Ya∈E

w(σ ∂ a ) , w(σ1 , . . . , σk ) = I(σ1 , . . . , σk n.a.e.) = 1 − I(σ1 = · · · = σk ) ,

(2)

where Z is a normalizing factor counting the number of proper bicolorings, I(A) is the indicator
function of the event A, and n.a.e. is the abbreviation of not all equal.
Thanks to the invariance of η under a global spin ﬂip, η(−σ) = η(σ ), and to the acyclic
property of the tree G, it is actually easy to sample conﬁgurations from η by a recursive,
broadcasting procedure described as follows. Choose an arbitrary vertex i0 to be called the
root of the tree (the one drawn at the top of Fig. 1), and set its spin σi0 to ±1 with probability
1/2. Then, independently for each edge a adjacent to the root, draw the conﬁguration of the

5

SciPost Physics

Submission

(3)

k − 1 other variables with the conditional probability p(σ∂ a\i0 |σi0 ), where
1
p(σ1 , . . . , σk−1 |σ) =
(1 − I(σ1 = · · · = σk−1 = σ)) .
2k−1 − 1
Once the values of all the spins at distance 1 from the root have been set in this way the same
process can be iterated, each of these vertices of the ﬁrst generation being in turn considered
as the root of the subtree lying below it.
This description of the sampling from η as a broadcast process naturally calls for an in-
terpretation as the transmission of an information, the value of the spin at the root, through
noisy channels, the hyperedges, towards a set of receivers, the vertices at a certain distance n
from the root, to be denoted Bn . In this information theoretic perspective the tree reconstruc-
tion problem asks the following question: given only the values σBn of the spins at distance
n from the root in a conﬁguration σ generated as above, how much information is available
on the value of the root σi0 , and does a non-vanishing amount of information on σi0 survives
in the n → ∞ limit ? This question is equivalent to the existence of long-range non-trivial
point-to-set correlations under the probability measure η

SciPost Physics

Submission

SciPost Physics

Submission

lYi=1

∞Xl=0
bPn (u) = Xσ1 ,...,σk−1

f (u1 , . . . , ul ) with h drawn from Pσ,n+1 , l is a Poisson distributed random variable with mean
αk , and the ui ’s are i.i.d. copies of a random variable of law bPσ,n .
One can slightly simplify these equations by noticing that the invariance of the bicoloring
problem under a global spin-ﬂip of all its variables implies that P−σ,n (h) = Pσ,n (−h) and
bP−σ,n (u) = bPσ,n (−u); this can be checked by induction from (12,13), using p(σ1 , . . . , σk−1 |σ) =
p(−σ1 , . . . , −σk−1 | − σ) and the fact that f and g change sign when all their arguments are
multiplied by −1. It is thus redundant to track the evolution with n of the distributions with
both σ = +1 and σ = −1, we shall instead deﬁne Pn (h) = P+1,n (h) and bPn (u) = bP+1,n (u)
and close the equations on these two sequences of distributions:
l! Z
e−αk (αk)l
Pn+1 (h) =
d bPn (ui ) δ(h − f (u1 , . . . , ul )) ,
(14)
p(σ1 , . . . , σk−1 | + 1) Z k−1Yi=1
dPn (hi ) δ(u − g(h1 σ1 , . . . , hk−1σk−1 )) .
The answer to the reconstructibility question raised above can be read oﬀ from the behavior
of Pn (h) in the large n limit:
if it tends to the trivial distribution δ(h) (which is always a
stationary solution of (14,15)), then all information on the value of the root has been washed
out and the reconstruction problem is not solvable. On the contrary if the limit of Pn (h) is
non-trivial then the observation of σBn contains some information on the root and the problem
is said to be solvable. The occurence of these two situations depend on the parameters k and
α of the model; increasing α gives rise to a larger number of spin variables to be observed,
which makes the inference problem easier. Hence it is natural to expect the existence of a
threshold αd (k) such that the problem is unsolvable (resp. solvable) for α < αd (k) (resp.
α > αd (k)).
It is actually more convenient to describe this transition by a scalar order parameter
(instead of the functional one Pn ), the point-to-set correlation function that we shall deﬁne
as
Cn (α, k) = Z dPn(h) h ,
This is indeed an order parameter for the transition in the sense that C (α, k) > 0 if and
only if α > αd (k). This equivalence is a consequence of some symmetry properties of the
distributions Pn that we will describe now.
Let us call Tn (h) the distribution of the posterior magnetization h of the root,
in a
broadcast process which is not conditioned on the value of the root in σ , i.e. Tn (h) =
(P+,n (h) + P−,n (h))/2. A consequence of Bayes theorem applied to the joint law between
the spins at the root and on the boundary vertices is the following converse relation between
conditional and unconditional laws, Pσ,n (h) = (1 + σh)Tn (h) (see [15, 20, 25] for more details
on this property and its consequences). In addition the invariance of the problem under a
global spin-ﬂip implies that Tn (−h) = Tn (h), which yields a symmetry constraint on the
distributions Pn ,
Z dPn (h) b(h) = Z dPn (h) b(−h)
the second equality being valid for any function b(h) such that the integrals exist. This
symmetry (sometimes called Nishimori symmetry [26], and also fulﬁlled by bPn (u)) implies
8

Pn (−h) =

C (α, k) = lim

Cn (α, k) .

1 − h
1 + h

,

1 − h
1 + h

Pn (h) ,

n→∞

(16)

(15)

(17)

SciPost Physics

Submission

several identities between the moments of h that can be derived by appropriate choices of the
test function b [20, 25]; here we shall only state the simplest one, namely
Cn (α, k) = Z dPn (h) h = Z dPn(h) h2 ,
that can be obtained from (17) with b(h) = h(1 − h). This is enough to justify our statement
of the characterization of the reconstruction transition via the behavior of Cn : if the latter
vanishes in the n → ∞ limit this implies that both the average and the variance of Pn go to
zero, hence Pn tends to the trivial distribution δ(h).

(18)

2.2 Numerical resolution for ﬁnite k

The distributional equations (14,15) can be solved numerically relatively easily for ﬁnite values
of k by using a population dynamics algorithm [12, 27], whose main idea is to approximate
a probability distribution by the empirical distribution of a large sample of representative
elements. Suppose indeed that at some step n one has an approximation of Pn (h) written as

Pn (h) ≈

1

N

NXi=1

δ(h − h(n)

i

) ,

(19)

) ,

(20)

1

N

δ(u − u(n)

i

NXi=1

where N ≫ 1 is the size of the population, that controls the numerical accuracy of the
procedure. One can then insert this form in the r.h.s. of (15) to obtain an approximation of
bPn (u) as

bPn (u) ≈
where each of the representants u(n)
i has been constructed independently by drawing σ1 , . . . , σk−1
according to the law p(σ1 , . . . , σk−1 |+), then k − 1 indices i1 , . . . , ik−1 uniformly at random in
i = g (cid:16)σ1h(n)
ik−1 (cid:17). Similarly, Pn+1 (h) can be approxi-
{1, . . . , N }, and setting u(n)
, . . . , σk−1h(n)
mated by an empirical distribution of the form (19), where according to (14) each of the repre-
sentants h(n+1)
is obtained by drawing an integer l from the Poisson law pl = e−αk (αk)l
, then
= f (cid:16)u(n)
il (cid:17).
l indices i1 , . . . , il uniformly at random in {1, . . . , N }, and taking h(n+1)
, . . . , u(n)
The initial condition P0 (h) = δ(h − 1) can obviously be represented by a sample with all
representants h(0)
equal to 1, and at every iteration step observables can be estimated as
empirical averages,
Z dPn (h)F (h) ≈
for an arbitrary function F .
The ﬁgure 2 presents some numerical results obtained with this procedure. The left panel
displays the decay of the correlation function Cn (α, k) as a function of the distance n for
diﬀerent values of α and k = 5 (all values of k large enough are qualitatively similar, but
small values of k behaves diﬀerently, see for instance [18]). When α is small this function
decays to 0 as n → ∞, signalling the impossibility of reconstruction; when α increases the
decay gets slower and proceeds in two steps, with a longer and longer plateau at a strictly

NXi=1

F (h(n)

)

i

1

N

i

i1

i

i

l!

(21)

i1

9

SciPost Physics

Submission

Cn

1

0.8

0.6

0.4

0.2

0

0

1

0.98

0.96

0.94

0.92

0.9

0.88

0.86

0.84
9.2

C
w

9.4

9.6

9.8

10

10.2

10.4

10.6

10.8

11

11.2

11.4

α

20

40

60

80

100

n

Figure 2: Left: the correlation function Cn (α, k) as a function of n for k = 5 and from left
to right α = 9.2, α = 9.4, α = 9.6. Right: the large n limit C (α, k) = limn Cn (α, k) as a
function of α for k = 5, along with the contribution of the hard ﬁelds w(α, k) = limn wn (α, k)
discussed in Sec. 2.3. The ﬁrst curve is non zero for α ≥ αd (k = 5) ≈ 9.465, the second one
for α ≥ αr(k = 5) ≈ 10.526.

positive value developping as α gets closer to the transition; ﬁnally for α > αd the plateau lasts
forever, the large n limit C (α, k) is strictly positive. This quantity, that jumps discontinuously
from 0 to a strictly positive value when α crosses αd , is plotted as a function of α in the right
panel of Fig. 2. To increase the numerical accuracy we estimated the limit by averaging the
value of Cn when n is large enough to have reached its plateau behavior.

2.3 The naive reconstruction procedure

The deﬁnition of the reconstruction transition αd and its analysis in terms of the RDE on
Pn described above are based on the optimal inference algorithm, namely the computation of
the posterior probability η(σi |σBn ) via the BP equations (4). One can nevertheless consider a
simpler, suboptimal inference procedure, that aims at answering the following question: is σi
uniquely determined in the measure η(·|σBn ), in other words is σi constant in all the proper
bicolorings of the graphs that take the values σBn on the boundary vertices? It is clear that if
the answer is yes then the inferred value of σi is the correct one that was used in the broadcast,
hence if reconstruction is possible in this strong sense of certain inference it is also possible
in the deﬁnition introduced above.
We shall now determine the probability of success of this naive reconstruction procedure,
that corresponds to a pro jection of the BP algorithm towards its Warning Propagation [28]
version that only keeps sure beliefs and discards partially biased ones. To incorporate naturally
this computation in the one presented above we decompose the ﬁeld distributions as follows:
Pn (h) = wn δ(h − 1) + (1 − wn ) Qn (h) ,
bPn (u) = bwn δ(u − 1) + (1 − bwn ) bQn (u) ,
where Qn and bQn are probability measures with no atom in 1. The weight wn

(22)

SciPost Physics

Submission

another value that it had in the broadcast), and that they enjoy the same Bayes symmetry
(17) as the complete distributions Pn and bPn . Inserting this decomposition in (14,15), and
considering the possible combinations of arguments of the functions f , g in (9) that yields
h, u = 1 one easily obtains the following evolution equations for wn and bwn :
bwn =
.
(23)
2k−1 − 1
The ﬁrst one expresses the fact that a spin is perfectly recovered as soon as one of its neigh-
boring interactions forces it to its correct value, while the second one shows that this latter
event happens when in the broadcast the k − 1 variables adjacent to it have been given the
same value, and that they all have been perfectly recovered.
Assembling these two equations we obtain a simple recursive equation on wn ,

wn+1 = 1 − e−αk bwn ,

wk−1
n

n

,

Γ(α, k) =

wn+1 = 1 − e−Γ(α,k)wk−1

αk
2k−1 − 1
with the initial condition w0 = 1. By a numerical inspection of the shape of this recursion
function one easily realizes that for k ≥ 3 the ﬁxed point reached by wn for n → ∞ undergoes
a discontinuous bifurcation from zero to a strictly positive value when Γ crosses a critical
value Γr = Γr(k). The latter can be determined by noting that at such a bifurcation the
derivative of the recursion function must be equal to 1, hence that Γr and wr , the ﬁxed point
at the bifurcation, are solutions of

(24)

,

wr = 1 − e−Γrwk−1

1 = (k − 1)wk−2
One can close these two equations on a single one that determines wr : 1 = (k − 1) ln(1 −
wr)(1− 1/wr ), from which one obtain Γr(k) = − ln(1− wr)/(wk−1
), and in terms of the original
parameter α

r Γre−Γrwk−1

(25)

,

.

r

r

r

SciPost Physics

Submission

1

0.95

0.9

0.85

0.8

0.75

0.7

0.65

Cn
wn

0.6

0

5

10

15

25

30

35

40

20

n

Figure 3: The evolution of Cn and wn for k = 5, α = 10.4, in the intermediate regime between
αd and αr : the fraction wn of hard ﬁelds falls to zero (the vertical range has been reduced for
the sake of readability) while the correlation function Cn tends to a positive constant.

2.4 The distribution of the soft ﬁelds
We will now derive the recursion equations on the distribution of the soft ﬁelds Qn and bQn
introduced in (22), that complete the equations (23) for the evolution of the weights wn and
bwn of hard ﬁelds. Both are obtained by plugging the decomposition (22) into the recursion
equations (14,15) on Pn and bPn .
As f (u1 , . . . , ul ) = 1 as soon as one of the arguments is equal to 1, i.e. as soon as one of
the neighboring interactions forces the root variable, it is easy to see from (14) that the soft
part of Pn arises from the combination of only soft u’s, namely
e−αk(1− bwn ) (αk(1 − bwn ))l
d bQn (ui ) δ(h − f (u1 , . . . , ul )) .
l!
The treatment of (15) will require a little bit more work in order to put the resulting
equation into a form convenient for the rest of the paper. Denoting p the number of soft ﬁelds
picked in the r.h.s. of (15), we ﬁrst rewrite this equation as

∞Xl=0

Qn+1 (h) =

lYi=1

Z

(27)

k−1Xp=0(cid:18)k − 1
p (cid:19)wk−1−p
n

(1 − wn )p Xσ1 ...σk−1

bPn (u) =

p(σ1 . . . σk−1 |+)
Z dQn (h1 ) . . . dQn(hp ) δ(u − g(σ1 h1 . . . σphp , σp+1 . . . , σk−1 )) .
As explained above the term δ(u − 1) arises solely from the term p = 0, (σ1 . . . σk−1 ) =
(−, . . . , −). Moreover one realizes by inspection of the expression of g in (9) that u = 0 as
soon as among the hard ﬁelds (σp+1 . . . , σk−1 ) at least one is positive and at least one is
negative; this expresses the fact that in such a situation the bicoloring condition is satisﬁed
whatever the value of the spin at the root. Combining these observations with the expression
(3) of the broadcasting probability p(σ1 . . . σk−1 |+) one obtains after a short computation the

(28)

12

SciPost Physics

Submission

2k−1

n

k−2Xp=1 (cid:18)k − 1
k−2Xp=1 (cid:18)k − 1

2 (cid:17)k−1(cid:21) δ(u)
wn
δ(u − gp (σ1h1 , . . . , σphp ))

following expression for the soft part of bPn ,
2k−1 − 1 (cid:20)1 + (1 − wn )k−1 − 2 (cid:16)1 −
(1 − bwn ) bQn (u) =
p (cid:19)(1 − wn )pwk−1−p
+
dQn(hi )
1
p (cid:19)(1 − wn )pwk−1−p
2k−1 − 1 X′
1
2k−1 − 1 X′
+
(1 − wn )k−1
dQn(hi )δ(u − g(σ1h1 , . . . , σk−1hk−1 )) ,
(29)
where the primed sums P′ exclude the conﬁguration with all the spin arguments equal to
+1, and where gp is deﬁned as

n
σ1 ,...,σk−1 Z k−1Yi=1

2k−1 − 1 Xσ1 ,...,σp

dQn(hi )

δ(u + gp (σ1h1 , . . . , σphp ))

Z pYi=1
Z pYi=1

+

σ1 ,...,σp

gp (h1 , . . . , hp ) = −g(h1 , . . . , hp , +1, . . . , +1) =

.

(30)

pQi=1
1+hi
2
pQi=1

2 −

1+hi
2

The initial condition for this evolution of the soft ﬁelds distribution turns out to be Q1 (h) =
δ(h), as can be easily realized by an explicit computation of bP0 (u) and P1 (h) starting from
P0 (h) = δ(h − 1).

3 The large k limit for a ﬁnite distance n

3.1 Evolution of the hard ﬁelds

We turn now to the ﬁrst steps towards the main goal of this article, namely the determination
of the asymptotic expansion of αd (k) when k → ∞. Before confronting this functional bifur-
cation threshold it is much easier to consider the rigidity transition αr (k), that corresponds
to the bifurcation of the scalar recursion equation (24). We have given in (25) the expressions
that determine analytically αr (k) for all k . The value of Γr (k) cannot be given explicitly when
k is ﬁnite, but it is easy to perform its asymptotic expansion at large k , which yields

αr (k) =

2k−1

k

(ln k + ln ln k + γr + o(1)) ,

with γr = 1 .

(31)

As explained above this is an upperbound on the sought for dynamic transition αd (k), and the
rigorous results of [20] suggest (or prove for the coloring problem [19, 21]) that the asymptotic
expansion of αd (k) has the same form as the one of αr (k), with a diﬀerent constant term γd .
We shall thus study the large k limit taking α to diverge simultaneously with k according
to the function α(k , γ ) deﬁned in Eq. (1), with γ a ﬁnite constant that becomes our control
parameter for the density of constraints in this limit.
It is instructive to investigate the
behavior of the hard ﬁeld weights wn , solution of the recursion equation (24), for a ﬁnite

13

SciPost Physics

Submission

x

e−γ+x

2

1.5

1

0.5

0

0

0.5

1

x

1.5

2

2

1.5

xn

1

0.5

0

0

10

20

30

40

n

50

60

70

80

Figure 4: Left: the recursion function e−γ+x (solid lines) for three values of γ (from top to
bottom γ = 0.9, γ = 1 = γr , γ = 1.2) compared to x (dashed line). Right: the iterates
xn deﬁned by x0 = 0, xn+1 = e−γ+xn for three values of γ (from top to bottom γ = 0.99,
γ = 1 = γr , γ = 1.2).

distance n. With this choice for the scaling of α with k one easily obtains by induction on n
that the leading behavior of wn reads
+ o (cid:18) 1
k ln k (cid:19) ,
where xn is a γ -dependent sequence, deﬁned recursively by

wn = 1 −

xn
k ln k

(32)

x0 = 0 ,

xn+1 = e−γ+xn .

(33)

This recursion function is illustrated on Fig. 4.
Its study is very simple, and unveils the
following behavior for xn :
if γ ≥ 1 then xn converges at large n to a ﬁnite ﬁxed point
(depicted on the right panel of Fig. 5), while for γ < 1 the sequence xn diverges as n → ∞,
very quickly (as iterated exponentials). The transition between these two behaviors thus
occurs at the critical value of the parameter γ = γr = 1, which corresponds to the expansion
of αr (k) stated above. Note that this coincidence is not as trivial as it may look at ﬁrst sight:
the expansion of Eq. (31) was obtained by ﬁrst taking the limit n → ∞, then k → ∞, while
in (33) we have taken the limit k → ∞, and only later studied the behavior of xn for large
n. The commutativity of these two limits can in this case be traced back to the simple shape
of the recursion equation (24): either it has no non-trivial ﬁxed point, or if it has one in the
large k limit it must be of order 1 − O(1)/(k ln k), and hence captured by the scaling (32).

3.2 The reduced order parameter

Our determination of the asymptotic behavior of αd (k) will be based on three hypotheses that
we now spell out explicitly. First of all, we assume that this transition occurs on the scale
(1), hence that the sought for constant γd can be deﬁned as
k→∞ (cid:20) kαd (k)
2k−1 − ln k − ln ln k(cid:21) ;
γd = lim
14

(34)

SciPost Physics

Submission

(35)

as mentioned above the rigorous results of [19–21] support this hypothesis. We shall further-
more assume that on this scale of α the order parameter C (α, k) is either equal to 0 (for
α < αd (k)) or scales with k in the same way as its lowerbound provided by the hard ﬁeld
weight w(α, k) (see Eq. (32)), hence deﬁne a reduced order parameter as
eC (γ ) = lim
(1 − C (α(k , γ ), k))k ln k ,
that should be ﬁnite for γ > γd , and diverge to +∞ for γ < γd . Note that in order to
have eC (γ ) ≥ 0 we introduced a minus sign in this deﬁnition, hence increasing values of eC
corresponds to smaller correlations in the original order parameter C . Finally we assume that
eC (γ ) can be computed by reversing the order of the large n and large k limits, in other words
we deﬁne for n ﬁnite eCn (γ ) as
eCn (γ ) = lim
(1 − Cn(α(k , γ ), k))k ln k ,
(36)
and our third hypothesis will consist in computing eC (γ ) as the large n limit of eCn (γ ).
To rephrase these last two hypotheses, we exclude the possibility that on the scale (1)
the ﬁxed point order parameter C (α, k) has distinct scalings with k depending on the value
of γ , and similarly that the ﬁnite distance correlation function Cn (α, k) decays with several
plateaus at heights each scaling diﬀerently with k . These hypotheses are reasonable when
confronted with the ﬁnite k numerical results (for instance those of Fig. 2), and are somehow
corroborated by the scheme of proofs of [19, 20], that rely on the fact that once Cn

k→∞

k→∞

SciPost Physics

Submission

1+g1 (h) = 1−h

Note that this function fulﬁlls the identity 1−g1 (h)
2 ; as a consequence one can check
that the Bayes symmetry is respected by bRn , i.e. that bRn (−u) = 1−u
1+u bRn (u), if Qn veriﬁes
this symmetry.
Let us give an intuitive explanation of the equations (37,38):
in the large k limit the
weight of the hard ﬁelds wn is very close to 1, hence almost all of the k − 1 ﬁelds hi acting
on the variables of an hyperedge are forcing them. If they all force them to take the same
color −1 then to satisfy the constraint the root must take the opposite color, which leads to
an hard ﬁeld u = 1 (the k − 1 ﬁelds cannot be all forcing in the direction +1, this would force
the root to be −1, in contradiction with the broadcast being conditional on the root equal to
+1). If they are all hard but with the two colors represented, then the clause is satisﬁed for
every choice of the root, and this produces a trivial soft ﬁeld u = 0. The least unprobable
situation that can produce a non-trivial soft ﬁeld (u 6= 0, 1) is thus when among the k − 1
entering ﬁelds hi exactly one, say h1 , is soft, and all the k − 2 other are hard. If the two
colors appear among the k − 2 hard ﬁelds, again the root is unbiased, this produces a trivial
soft ﬁeld u = 0. Assume thus that the k − 2 hard ﬁelds are of the same color. If this color
is +1, then necessarily σ1 = −1 and this yields u = −g1 (−h1 ). If this color is −1, then both
σ1 = +1 (producing u = g1 (−h1 )) and σ1 = −1 (corresponding to u = g1 (h1 )) are possible;
this concludes the interpretation of (37,38).
We can now inject the simpliﬁed form (37) of bQn (u) in the other recursion equation (27);
as f (u1 , . . . , ul , 0, . . . , 0) = f (u1 , . . . , ul ) the ﬁrst term of bQn (u) does not contribute, and the
number of bRn (ui ) picked up in the r.h.s. of (27) is a Poisson random variable of parameter
αk(1 − bwn )
2k−1 ln k . This quantity converges to 3xn in the large k limit for the regime we are
considering, hence (27) becomes:

3xn

Qn+1 (h) =

d bRn(ui ) δ(h − f (u1 , . . . , ul )) .
We can ﬁnally express the reduced order parameter Cn (γ ) in the large k limit: combining
its deﬁnition from (36), the expression of Cn in terms of the soft ﬁelds distribution and of the
hard ﬁelds weight given in Eq. (26), and the scaling of the latter quantity written in (32), we
obtain eCn (γ ) = xn R dQn (h)(1 − h).

(40)

4 The limit of large distance n

Let us summarize what we have achieved up to now; starting from the recursion equations
(14,15) for the distributions Pn (h) we have taken the large k limit with the density of con-
straints scaling as α(k , γ ) of Eq. (1), and argued for the existence of a reduced correlation
function at ﬁnite distance, eCn (γ ) deﬁned in (36). We have then shown that the latter could
be computed by solving some recursion equations on both xn , a scalar quantity related to the
weight of the hard ﬁelds in Eq. (32), and on Qn (h), the distribution of the soft ﬁelds (that
is a distribution supported on [−1, 1], with no atoms in ±1). For the sake of readability we

16

e−3xn (3xn )l

l!

∞Xl=0

Z

lYi=1

SciPost Physics

Submission

regroup now all the equations that will be necessary to proceed:

x0 = 0 ,

xn+1 = e−γ+xn ,
∞Xl=0
e−3xn (3xn )l

Z

lYi=1

(41)

(42)

(43)

(45)

(44)

1+ui

2 +

1−ui
2

1−ui
2

1+ui

2 −

lQi=1
lQi=1

lQi=1
lQi=1

1+h
2
2 − 1+h
2

Q1 (h) = δ(h) , Qn+1 (h) =
d bRn (ui ) δ(h − f (u1 , . . . , ul )) ,
l!
3 Z dQn(h) [δ(u − g1 (h)) + δ(u − g1 (−h)) + δ(u + g1 (−h))] ,
bRn (u) =
1
f (u1 , . . . , ul ) =
,
g1 (h) =
,
eCn (γ ) = xn Z dQn(h)(1 − h) .
Let us emphasize that the parameter k has disappeared from these equations, that only depend
on γ ; moreover we show in the Appendix that exactly the same equations describe the large
q limit of the coloring problem. What remains to do now is to study the large n limit of these
equations, as the threshold γd will be determined according to the behavior of eCn (γ ) in this
limit, namely eCn (γ ) → +∞ will signal that γ < γd , while eCn (γ ) will remain ﬁnite for n → ∞
if γ > γd .
4.1 The regime γ ≥ γr = 1
Let us start by considering the case γ ≥ γr = 1; then the sequence xn remains bounded for
all n (its limit x(γ ) being depicted as a function of γ on the right panel of Fig. 5), which
translates the presence of hard ﬁelds in the ﬁxed point solution of the corresponding ﬁnite
k regime α ≥ αr . As a consequence the numerical resolution of (42) presents no diﬃculty
and can be performed with the usual population dynamics algorithms explained in Sec. 2.2,
Qn(h) being represented as an empirical distribution over a sample of hi ’s. The ﬁgure 5
presents some numerical results obtained in this way; one can see on the left panel that eCn (γ )
converges to a ﬁnite limit as n grows, this limit value being drawn as a function of γ on the
right panel. In this regime Qn converges (weakly) to a stationary distribution Q, solution of
the ﬁxed point equation obtained by replacing in (42) xn by its limit.
The ﬁnite k inequalities wn ≤ Cn ≤ 1 becomes in these rescaled units 0 ≤ eCn (γ ) ≤ xn (γ );
indeed,
Z dQn (h)(1 − h) = 1 − Z dQn (h)h = 1 − Z dQn(h)h2 ∈ [0, 1] ,
(46)
because of the consequence stated in (18) of the Bayes symmetry enjoyed by Qn . In the large
n limit we thus have eC (γ ) ≤ x(γ ), as illustrated in the right panel of Fig. 5 which is the
analog of the right panel of Fig. 2 for ﬁnite k .
Note that eC (γ ) seems to behave smoothly as γ → γ+
r , as expected if the transition occurs
at γd < γr . As x has a square root singularity this means that there is also a square root
singularity in R dQ(h)(1 − h) as a function of γ , in order for their product eC (γ ) to be regular.

17

SciPost Physics

Submission

0.6

0.5

0.4

0.3

0.2

0.1

eCn

1.2

1

0.8

0.6

0.4

0.2

γ = 1.0
γ = 1.2
γ = 1.4

x

eC

0

0

5

10

15

n

20

25

30

0
0.8

1

1.2

1.4

γ

1.6

1.8

2

Figure 5: Left: the reduced correlation function eCn (γ ) as a function of n for a few values of
γ ≥ γr = 1. Right: the large n limit eC (γ ) = limn eCn (γ ) as a function of γ , along with the
contribution of the hard ﬁelds x(γ ) = limn xn (γ ). The ﬁrst curve exists for γ ≥ γd ≈ 0.871,
the second one for γ ≥ γr = 1. The data for γ < 1 have been obtained through the reweighted
algorithm expained in Sec. 4.3.

3

2.5

2

1.5

1

0.5

xn
eCn

0

0

5

10

n

15

20

Figure 6: The evolution of eCn and xn for γ = 0.96 < γr . The sequence xn diverges asymp-
totically in a very rapid way (as iterated exponentials, the vertical range has been cut for the
sake of readability) while the reduced correlation function eCn tends to a positive constant.
This is the analog of the ﬁnite k regime αd < α < αr depicted in Fig. 3.

18

SciPost Physics

Submission

4.2 The diﬃculties for γ < 1

The study of the large n limit is much more diﬃcult when γ < 1: the sequence xn solution of
(41) is then divergent (asymptotically very strongly, as iterated exponentials). As the direct
implementation of the population dynamics procedure to solve (42) involves the manipulation
of a number of ﬁelds ui ’s that is distributed as a Poisson random variable of parameter xn ,
this becomes very quickly impossible to handle. A ﬁrst hint of what happens for γ < 1 can
nevertheless be unveiled by this numerical procedure: when γ is only slightly smaller than
1, xn grows rather slowly at ﬁrst, the range of n that can be treated in this way is then
suﬃciently large to gain some useful informations. A typical result obtained in this way is
plotted on Fig. 6 for γ = 0.96: even though xn is diverging it is tempting to conjecture from
this plot that eCn admits a limit when n → ∞. Looking at the expression (45) of eCn one
realizes that this is possible provided R dQn(h)(1 − h) tends to 0 as n grows, with an order
of magnitude inversely proportional to the one of xn . This weak convergence of Qn (h) to
δ(h − 1) is compatible with the form of the recursion equation (42), the combination of a very
large number of ui ’s can indeed produce a ﬁeld h very close to 1.
Lowering further the value of γ the speed of the divergence of xn increases so much that an
extrapolation of eCn to large n values becomes impossible with this numerical method, which
as a consequence does not allow for an accurate estimation of γd . We thus need to devise a
formalism that incorporates the compensation mechanism between the divergence of xn and
the concentration of Qn around δ(h − 1) at the origin of the ﬁnite value of eC . A natural idea
would be to make the change of variable h = 1 − (h′ /xn ), with h′ a random variable that
should remain ﬁnite and thus obey a simpliﬁed recursion equation. Unfortunately the Bayes
symmetry enjoyed by Qn , and its consequences on the moments of h, imply that h′ has higher
moments that diverge with n. This strategy seems thus rather unpractical. In fact it is more
probable that the value of eCn is determined by contributions of all values of h in (−1, 1), even
very improbable ones where Qn is of order 1/xn , while the typical values around h = 1 do not
contribute to eCn because of the factor 1 − h in the integral in (45). In more technical terms we
conjecture that xnQn , which is a sequence of positive measures, even if not probability ones
because their total mass is the diverging sequence xn , does converge to a positive measure ρ,
in the sense of the vague convergence on (−1, 1), i.e.
xn Z b
dQn (h) = Z b
for all −1 < a < b < 1 which are continuity points of ρ. A direct numerical test of this
conjecture, and the determination of ρ, seems rather diﬃcult as ρ is not a probability measure
and may have an inﬁnite total mass. We have thus devised an alternative numerical procedure
that allowed us to explore the regime γ < 1, as we shall now explain.

dρ(h)

(47)

lim

n→∞

a

a

4.3 Reweighted probability distributions

The idea underlying this procedure is to study the evolution not of the probability measure
Qn , but of a reweighted (or tilted) version of it, that give less importance to the typical (for
Qn) values of h around h = 1, which do not contribute to eCn . Let us thus consider a positive
function rn (h), and deﬁne the reweighted distribution µn (h) = xnr(h)Qn (h). In more precise
mathematical terms µn is absolutely continuous with respect to Qn , with relative density xn r .
For the reasons explained above our goal is to use a function r(h) that vanishes in h = 1; a

19

SciPost Physics

Submission

2

.

2

2

,

(48)

(49)

νn (h) =

µn (h) .

convenient choice is to take r of the form r(h) = ((1 − h)/(1 + h))t , with t an exponent that
is arbitrary for the moment. Indeed with this choice the reweighting will factorize in (42),
in the sense that r(f (u1 , . . . , ul )) = r(u1 ) × · · · × r(ul ). We will actually further specify the
function by taking the exponent t = 1/2, thus setting
µn (h) = xnQn (h) (cid:18) 1 − h
1 + h (cid:19) 1
The reasons for this choice of the exponent are two fold: the Bayes symmetry (17) enjoyed by
Qn implies then that µn is symmetric in the usual sense, i.e. µn (−h) = µn (h). Furthermore
(17) also implies the following identity (used in the proof of lemma 4.4 in [20]),
Z dQn (h) (cid:18) 1 − h
1 + h (cid:19) 1
= Z dQn (h)p1 − h2 ,
which can be obtained from (17) with the choice b(h) = h((1 − h)/(1 + h))1/2 . The right hand
side of (49) is obviously between 0 and 1, thus for all ﬁnite n the measure µn has a ﬁnite total
mass, smaller than xn . We shall therefore deﬁne a probability measure νn by dividing µn by
its mass mn :
mn = Z dµn(h) = xn Z dQn (h) (cid:18) 1 − h
1 + h (cid:19) 1
Note that the three descriptions in terms of the (ﬁnite but not normalized to 1) positive
measure µn , or the pair (mn , νn ), or the original one in terms of (xn , Qn ), are strictly equivalent
for all ﬁnite n; in particular one can compute the reduced correlation function as
eCn (γ ) = Z dµn(h)p1 − h2 = mn Z dνn(h)p1 − h2 .
Besides its equivalence with the original quantities at ﬁnite n the advantage of the reweighted
description in terms of µn is a much nicer behavior when n grows, as we shall see.
Let us now derive the recursion equations that governs the evolution of µn (or equivalently
eh = arcth(h) and eu = arcth(u), that corresponds to the eﬀective magnetic ﬁelds associated to
of the pair (mn , νn )).
It will be more convenient to express some quantities in terms of
the magnetizations h and u. In particular the operation h = f (u1 , . . . , ul ) translates in this
domain to a simple addition, eh = eu1 + · · · + eul , and the reweighting r(h) becomes e−eh . For the
sake of conciseness we shall take the liberty of using simultaneously both types of quantities
in the following equations, keeping implicit the relation eh = arcth(h) between them; we will
also denote with the same symbol Qn the measure for the random variables h and eh related
in this way.
Let us ﬁrst rewrite the equations (42,43) in terms of eh:
Qn+1 (eh) =
d bRn (eui ) δ(eh − eu1 − · · · − eul )) ,
l!
1
3 Z dQn(eh) hδ(eu − a(eh)) + δ(eu − a(−eh)) + δ(eu + a(−eh))i ,
bRn (eu) =
20

e−3xn (3xn )l

∞Xl=0

lYi=1

1
mn

(52)

(53)

(50)

(51)

Z

SciPost Physics

Submission

where we introduced the function
1
ln (cid:16)1 + e2eh(cid:17) .
a(eh) = arcth(g1 (tanh(eh))) =
2
(54)
Under Qn+1 the random variable eh has a compound Poisson distribution, it is thus more
convenient to describe it in terms of its characteristic function (i.e. Fourier transform). We
deﬁne the latter for the various measures as
bQn (z ) = Z dQn(h)eizeh ,
bµn (z ) = Z dµn(h)eizeh ,
bνn(z ) = Z dνn(h)eizeh =
1
mn bµn (z ) .
With these conventions the two equations (52,53) become:
bQn+1 (z ) = exp (cid:20)−3xn + xn Z dQn(h) (cid:16)eiza(eh) + eiza(−eh) + e−iza(−eh)(cid:17)(cid:21) .
(55)
The eﬀect of the reweighting is easily seen to translate in terms of the characteristic functions
as a shift of the argument,
µn+1 (h) = xn+1e−ehQn+1 (h) ⇔ bµn+1 (z ) = xn+1 bQn+1 (z + i) .
Recalling that xn+1 = exp[−γ + xn ] we thus obtain

(56)

Replacing in this equation xnQn by eehµn yields

bµn+1 (z ) = exp (cid:20)−γ + xn Z dQn (h) (cid:16)e−a(eh) eiza(eh) + e−a(−eh)eiza(−eh) + ea(−eh) e−iza(−eh) − 2(cid:17)(cid:21)
bµn+1 (z ) = exp (cid:20)−γ + Z dµn(h) (cid:16)eeh−a(eh) eiza(eh) + eeh−a(−eh) eiza(−eh) + eeh+a(−eh) e−iza(−eh) − 2eeh(cid:17)(cid:21)
eiza(eh)
eiza(−eh) + r 2
e−iza(−eh) − 2!!#

= exp "−γ + Z dµn(h) r 1 + h
2
+r 1 + h
1 − h r 1 + h
2
1 + h
where in the second line we expressed the weight factors in terms of h instead of eh, using the
expression of a(eh) given in (54). As µn (h) = µn (−h) one can symmetrize the integrand to
obtain
bµn+1 (z ) = exp " − γ + Z dµn(h) 
p2(1 + h) (cid:16)eiza(eh) + e−iza(eh)(cid:17)
1
(57)
p2(1 − h) (cid:16)eiza(−eh) + e−iza(−eh)(cid:17) −
1
+
= exp "−γ + Z dµn (h) r 2
conservation of the symmetry µn+1 (h) = µn+1 (−h) along the iterations. The integrand of the
These two expressions for bµn+1 (z ) are obviously invariant under z → −z , which enforces the
21

√1 − h2 !#
√1 − h2 !# .

1 − h (cid:16)eiza(−eh) + e−iza(−eh)(cid:17) −

2

2

(58)

SciPost Physics

Submission

ﬁrst one is explicitly symmetric in h, while the more compact second one has been obtained
by exploiting the symmetry of µn .
We have thus obtained a recursion equation for the reweighted measure µn , that is equiv-
alent to the original system on (xn , Qn ). It will be useful to spell out its translation in terms
of the mass mn of µn and its normalized version νn . By setting z = 0 in (58) we obtain
mn+1 = exp (cid:20)−γ + Z dµn(h)β (h)(cid:21) , with β (h) = r 2
+ r 2
√1 − h2
2
1 + h
Note that β (h) ≤ 1 for h ∈ [−1, 1], hence the integral in (59) is smaller than mn , which allows
to check inductively that mn ≤ xn , in agreement with the direct derivation of this bound
from (49). Dividing the expression (58) of bµn+1 (z ) by its total mass mn+1 we obtain the
characteristic function bνn+1 (z ) of νn+1 , the normalized probability distribution. Replacing µn
by mnνn we thus have a recursion equation on the pair (mn , νn ), namely
mn+1 = exp (cid:20)−γ + mn Z dνn(h)β (h)(cid:21) ,
(60)
bνn+1 (z ) = exp "mn Z dνn(h)r 2
completed by the initial condition m1 = e−γ , ν1 (h) = δ(h), that derives directly from x1 =
e−γ , Q1 (h) = δ(h).

1 − h (cid:16)eiza(−eh) + e−iza(−eh) − 2(cid:17)# ,

1 − h −

(61)

.

(59)

4.4 Numerical resolution

There is one last diﬃculty to face in the derivation of a numerical procedure able to solve
the equations (60,61), that we shall now explain. As νn is a normalized probability measure
we can represent it as a large sample of ﬁelds, according to the population dynamics strategy
explained in Sec. 2.2. Suppose this has been done up to the n-th iteration, and that an
estimate of the real number mn is also known. Then mn+1 can be easily computed from
(60), the integration over νn being estimated as an empirical average over the representative
population. There remains to give an interpretation of the law νn+1 whose characteristic
function is given in (61), and to devise a sampling procedure from it in order to produce the
population of i.i.d. samples that will represent νn+1 . In order to do so let us introduce a
positive (not normalized) measure πn and its total mass λn according to
πn (y) = mn Z dνn(h)r 2
(δ(y − a(−eh)) + δ(y + a(−eh))) ,
1 − h
λn = 2mn Z dνn(h)r 2
1 − h
,
in such a way that (61) can be rewritten
bνn+1 (z ) = exp (cid:20)Z dπn(y)(eizy − 1)(cid:21) .
In more technical terms πn is the L´evy measure associated to the inﬁnitely divisible dis-
tribution νn+1 [29], with λn the total mass of πn , which is ﬁnite for a Poisson compound

(63)

(62)

22

SciPost Physics

Submission

i

i

,

.

(64)

distribution. This form makes clear that under νn+1 the random variable eh can be described
as the distributional equality eh d= Pl
i=1 yi , where in the right hand side l is a Poisson ran-
dom variable of mean λn , and the yi ’s are i.i.d. copies drawn with the probability measure
πn(y)/λn . If νn is known as a sample of ﬁelds it is possible to sample eﬃciently y from πn/λn ,
by extracting a ﬁeld h(n)
i with a probability proportional to (1 − h(n)
)−1/2 and then setting
y = ±a(−eh(n)
), the two signs being chosen with probability 1/2. It could thus seem at ﬁrst
sight that the distributional interpretation given above leads to a valid numerical procedure
to solve (60,61). A closer look reveals that this strategy cannot work as it is for γ < 1. Let
us indeed rewrite the expression of λn by exploiting the symmetry of νn :
λn = mn Z dνn(h) r 2
+ r 2
1 + h ! = mn Z dνn (h)
√2(√1 + h + √1 − h)
1 − h
√1 − h2
On the other hand the sequence xn can be expressed from the deﬁnition (48) of µn as
xn = Z dµn (h)r 1 + h
= mn Z dνn(h)
2 r 1 + h
+ r 1 − h
1 + h ! = mn Z dνn(h)
1
√1 − h2
1
1 − h
1 − h
where we used the normalization of Qn and the symmetry of νn . Noting that the function
√2(√1 + h + √1 − h) is bounded between 2 and 2√2 when h ∈ [−1, 1] we can conclude by
comparing these two expressions of λn and xn that 2xn ≤ λn ≤ 2√2xn . Hence for γ < 1
the lowerbound implies that λn diverges with n, which brings us back to the situation we are
trying to avoid of a Poisson compound distribution with a diverging number of summands.
Fortunately the reweighting performed above will allow us to circumvent this diﬃculty.
One sees indeed on the expression (62) that the divergent contribution to λn arises from the
neighborhood of h = 1, i.e. of eh = +∞. However the corresponding summands ±a(−eh) are
very small (recall the expression of a from Eq. (54)), it is thus conceivable that such a sum
of a very large number of very small contributions can be handled in a simpliﬁed way. To
formalize this intuition we rewrite (61) as
bνn+1 (z ) = bν (≤)
n+1 (z ) ,
n+1 (z ) = exp "Z dµn(h)r 2
1 − h (cid:16)eiza(−eh) + e−iza(−eh) − 2(cid:17) I(h ≤ 1 − εn )# ,
n+1 (z ) = exp "Z dµn(h)r 2
1 − h (cid:16)eiza(−eh) + e−iza(−eh) − 2(cid:17) I(h > 1 − εn )# ,
where εn is for the moment an arbitrary threshold; such a decomposition is loosely inspired
by an analogy with the L´evy-Itˆo decomposition of L´evy processes [29].
These two contributions to bνn+1 (z ) are characteristic functions of probability distributions,
hence under the law νn+1 the random variable eh is the sum of independent draws from ν (≤)
and ν (>)
n+1 . The ﬁrst one can be described as above, modulo the introduction of the cutoﬀ εn ;
deﬁning
n (y) = mn Z dνn(h)r 2
(δ(y − a(−eh)) + δ(y + a(−eh)))I(h ≤ 1 − εn ) ,
1 − h
(68)
n = 2mn Z dνn (h)r 2
I(h ≤ 1 − εn ) ,
1 − h

n+1 (z ) bν (>)

bν (≤)
bν (>)

π (≤)

λ(≤)

(65)

(66)

(67)

n+1

(69)

23

SciPost Physics

Submission

n

n /λ(≤)

one sees that under the law ν (≤)
n+1 the random variable eh satisﬁes the distributional equality
eh d= Pl
i=1 yi , where in the right hand side l is a Poisson random variable of mean λ(≤)
and
the yi are i.i.d. with the law π (≤)
n .
The law of ν (>)
n+1 will instead be described via its cumulants, to be denoted cn+1,p for the
p-th one. By taking derivatives with respect to z of ln bν (>)
n+1 (z ) one ﬁnds easily that
cn+1,p = mn Z dνn (h)r 2
(1 + (−1)p ) a(−eh)p I(h > 1 − εn ) .
1 − h
As expected from the symmetry of the law ν (>)
n+1 all its cumulants of odd order vanish and one
can write for the even ones:
cn+1,2p = 2mn Z dνn(h)r 2
a(−eh)2p I(h > 1 − εn ) .
1 − h
The strategy we have followed in our numerical resolution is to choose εn large enough
such that λ(≤)
does not grow with n, in such a way that the contribution from ν (≤)
n+1 can be
generated with a ﬁnite Poissonian number of summands, but small enough so that ν (>)
n+1 can
be safely approximated as a Gaussian distribution, neglecting the cumulants cn+1,2p for p > 1
(there exist some ways to draw better approximations of inﬁnitely divisible distributions by
using more cumulants [30, 31], but we did not try to implement them). Let us give an explicit
description of the algorithm. At the n-th iteration we assume to have an estimation of mn
and of νn as a population, namely

(71)

(70)

n

) .

(72)

2 ≤ · · · ≤ eh(n)

i
1 ≤ eh(n)

νn (h) ≈
δ(eh − eh(n)
We will assume that the population has been sorted, eh(n)
N , and translate
the cutoﬀ εn by deﬁning Nn in such a way that h(n)
Nn ≤ 1 − εn < h(n)
Nn+1 . We can thus estimate
all integrals with respect to νn according to
Z νn (h)F (eh) ≈
1
F (eh(n)
for all functions F , and in particular this gives us mn+1 from (60). We then compute
a(−eh(n)
1 − h(n)
by repeating N times, independently

n ≈ 2mn
1 − h(n)
We then construct the new population elements eh(n+1)
for i = 1, . . . , N :
• draw a random number l from a Poisson distribution of parameter λ(≤)
n ;
• draw i1 , . . . , il i.i.d.
in {1, . . . , Nn} with probability proportional to
be done eﬃciently by precomputing a cumulative table);

NXi=Nn+1 s 2

NnXi=1 s 2

cn+1,2 ≈ 2mn

1q1−h(n)

i

NXi=1

(this can

1

N

1

N

)2 .

i

λ(≤)

,

i

(73)

(74)

)

i

N

i

1

N

NXi=1

i

24

SciPost Physics

Submission

i

i1

il

n

• set eh(n+1)
= δ1 a(−eh(n)
) + · · · + δl a(−eh(n)
) + √cn+1,2z where the δi ’s are ±1 with
probability 1/2, independently from each other and from anything else, and z is a
standard Gaussian random variable.
We can then compute the reduced correlation function eCn+1 from (51), and sort the elements
of the new population to be ready for the next step.
In our implementation we chose the threshold εn , or equivalently Nn , in an adaptive
way: at each step we take the largest value of Nn that maintains λ(≤)
computed from (74)
smaller than a value λ ﬁxed beforehand and kept constant along the iterations. The numerical
accuracy of our procedure is thus limited by the ﬁniteness of N (the representation (72)
becomes exact only in the limit N → ∞) and of λ (because of the Gaussian approximation
we perform for ν (>)
n+1 ). The numerical results presented in the ﬁgures have been obtained with
N = 107 and λ = 20; we checked that varying λ between 10 and 30, or reducing N to 106 ,
did not aﬀect our conclusions in a quantitative way.
On the left panel of Fig. 7 we show that this new method allows us to track the evolution
of eCn for values of γ deep in the regime γ < 1 that was unaccessible to the simplest strategy
In particular for γ & 0.88 there is a clear plateau in eCn , the value
presented in Sec. 4.1.
of which was reported as a function of γ in the right panel of Fig. 5 along with the results
previously obtained for γ ≥ 1. Note that the new algorithm is also valid for γ > 1 (and in this
case the cutoﬀ εn can be safely put to 0), we found as expected a perfect agreement between
the results of the two procedures in this case.
On the right panel of Fig. 7 we have plotted the evolution of (the inverse of ) mn as a
function of n, that presents the same kind of plateau behavior as eCn . These numerical results
suggest that eCn diverges with n if and only if mn diverges, and hence that γd can be deﬁned
as the smallest value of γ such that mn remains bounded when n → ∞. We have not been
able to prove analytically this statement, that will be taken as an additional hypothesis in
the rest of the paper. This conjecture could be wrong if there existed a regime of γ such that
eCn remains ﬁnite while mn diverges, because of the existence of another reweighting scheme
that deals with the compensation between the divergence of xn and the convergence of Qn (h)
to δ(h − 1) in a more eﬃcient way than the one we introduced in (48). We found numerically
no trace of such a phenomenon, which if it existed would only modify our estimate of γd by
a quantitatively very small amount, as for γ = 0.87 the ﬁnite n study strongly suggests a
common divergence of eCn and mn (and for γ = 0.86 the divergences are obvious on Fig. 7).
4.5 The ﬁxed point equation and the determination of γd
The numerical results presented above suggest that for γ ≥ γd both mn and eCn converge
when n → ∞. It is then tempting to conjecture that the probability distribution νn itself
converges to some ν , in other words that we can remove the indices n from (60,61) and get a
system of self-consistent equations on the ﬁxed-point (m, ν ) as:
m = exp (cid:20)−γ + Z dν (h)β (h)(cid:21) ,
bν (z ) = exp (cid:20)Z dπ(y)(eizy − 1)(cid:21) ,
π(y) = m Z dν (h)r 2
(δ(y − a(−eh)) + δ(y + a(−eh))) .
1 − h
25

(76)

(77)

(75)

SciPost Physics

Submission

0.8

0.75

0.7

0.65

0.6

0.55

0.5

0

eCn

1/mn

1.8

1.6

1.4

1.2

1

0.8

0.6

0.4

0.2

0

0

20

40

60

80

100

120

140

n

20

40

60

80

100

120

140

n

Figure 7: The results of the reweighted distribution method in the neighborhood of γd : on the
left panel the reduced order parameter eCn (γ ) as a function of n, on the right panel the inverse
of the mass mn of the reweighted measure µn . On both panels the ﬁve curves correspond to
γ = 0.85, γ = 0.86, γ = 0.87, γ = 0.88, γ = 0.89, from top to bottom on the left panel and
from bottom to top on the right panel. These curves show that 0.87 < γd < 0.88, eCn and mn
diverge for γ = 0.87, even if it is not completely visible on the displayed range of n.

1

0.95

0.9

0.85

0.8

0.75

0.7

m

0.65
0.86

0.87

0.88

0.89

0.9

0.91

0.92

0.93

0.94

0.95

0.96

γ

Figure 8: The relationship between the parameter γ and the mass m of the reweighted measure
µ in the n → ∞ limit. The numerical results suggest that m reaches 1 with a square root
behavior as γ tends to γd .

26

SciPost Physics

Submission

Let us make a few remarks on these equations; ﬁrst, one can check that if m is ﬁnite and ν
is a probability measure with no atoms in h = ±1 (i.e.
in eh = ±∞), then the measure π
an atom in 0, and is such that R dπ(y)|y |I(|y | ≤ 1) < ∞. This ensures that the integral in
deﬁned in (77) gives a ﬁnite mass to all sets that are bounded away from 0, does not have
the deﬁnition of bν (z ) converges, hence π is a valid L´evy measure for the inﬁnitely divisible
distribution ν . Moreover the assumption of convergence of νn towards ν is self-consistent in
the following sense: if νn
w→ ν (i.e. in the sense of weak convergence of probability measures)
then πn (f ) → π(f ) for all bounded continuous functions f that vanish in a neighborhood
of 0, and limǫ→0 lim supn→∞ R dπn (y)y2 I(|y | ≤ ǫ) = 0. These two properties allow to invoke
w→ ν , the inﬁnitely divisible distribution with L´evy
theorem 8.7 of [29] to conclude that νn
measure π . Of course this circular argument does not prove the convergence νn
w→ ν , but at
least shows its consistency.
Note that in (75-77) we have ﬁnally achieved the main goal of the article, namely getting
rid of the parameters k and n that have been sent to inﬁnity and obtaining a system of
equations that only depend on the parameter γ . Moreover γ only appears in (75): one can
thus view (76,77) as a self-consistent equation on ν , parametrized by m, from which one
deduces γ according to (75). We have performed this numerical resolution at ﬁxed m, relying
again on the Gaussian approximation to deal with the divergence of the total mass of π ,
and checked that the results were in perfect agreement with the one obtained ﬁxing γ in the
n → ∞ limit. In Fig. 8 we have plotted the correspondance function between γ and m. The
numerical resolution of the ﬁxed point equation (76,77) led us to the following observations:
(i) a solution of the equation only exists for m ≤ 1 (ii) the tail behavior of ν is very well
described numerically by
ν ({eh ≥ x}) ∼ S (x)
as x → +∞ ,
where S is a slowly varying function, ρ is an exponent very close to 1 for all the values of m
we have considered, and r(m) ≥ 0 controls the dominant exponential decrease of the tail (iii)
r(m) > 0 for m < 1, and r(m) → 0 as m → 1.
Some of these numerical observations can be rationalized through the following analytical
considerations. If one assumes the form (78), the exponential behavior of ν when eh → +∞
(and also in −∞ thanks to the symmetry of ν ) allows to continue bν (z ) from the real to the
imaginary axis, i.e. to deﬁne the Laplace transform of ν as
L(t) = bν (−it) = Z dν (h)eteh = Z dν (h) cosh(teh) .
(79)
This function L is well-deﬁned for t ∈ (−r(m), r(m)), formally inﬁnite for |t| > r(m), with
L(0) = 1 and L non-decreasing on [0, r(m)).
Its behavior as t → r(m) depends on the
exponent ρ that controls the algebraic decay in (78). If ρ ≤ 0 then L diverges in this limit, with
a dominant behavior of (r(m) − t)ρ (and a prefactor that involves the slowly varying function
S , see theorem XIII.5.1 in [32] for a rigorous statement of such a Tauberian argument), while
if ρ > 0 the limit L(r(m)) is ﬁnite. We claim that for the probability measure ν solution of
transforms as L(t) = exp[R(t)], with R(t) = R dπ(y)(ety − 1). Consider now the tail behavior
(76,77) one should have ρ > 0. Let us indeed rewrite this equation in terms of the Laplace
of the measure π related to ν by (77); a simple computation, based in particular on the fact
that a(eh) = eh + O(e−2eh ) as eh → ∞, shows that the asymptotic expansion (78) is also valid for
27

e−r(m)x

xρ

(78)

SciPost Physics

Submission

the tail of π , up to the multiplicative coeﬃcient m: π({y ≥ x}) ∼ m ν ({eh ≥ x}) as x → ∞.
As a consequence if ρ < 0 both L(t) and R(t) would diverge as (r(m) − t)ρ when t → r(m),
which is clearly incompatible with the equation L(t) = exp[R(t)]. We must thus have ρ > 0,
in such a way that L is ﬁnite in r(m); nevertheless some derivatives of L will be divergent in
r(m), each derivative with respect to t in (79) multiplying the integrand by eh, hence reducing
the exponent ρ by 1. Suppose for simplicity that 0 < ρ ≤ 1, in such a way that L′ (t) is
divergent (higher values of ρ would lead to the same conclusion by considering higher order
derivatives). Because of the proportionality between the tails of ν and π the function R′ (t) is
also divergent, with R′ (t)/L′ (t) → m as t → r(m). Since L′ (t) = R′ (t) exp[R(t)] = R′ (t)L(t),
we are led to the conclusion that
1 = m L(r(m)) .
(80)

This type of reasoning can actually be put on rigorous grounds, the statement (80) being
essentially the content of corollary 2.1 in [33]. As L(r(m)) ≥ L(0) = 1 we can conclude that
a solution of (76,77) with a tail behavior of the form (78) can only exist for m ≤ 1, and that
r(m) must vanish when m → 1, which conﬁrms part of the numerical observations reported
above. As m is a decreasing function of γ (see in particular Fig. 8) we are thus led by (75) to
the following deﬁnition for our conjectured value of γd :
γd = Z dν (h)β (h) ,
where ν is the solution of (76,77) with m = 1 (and hence has a power law decay when
eh → ∞). A numerical evaluation of this quantity led us to the estimate γd ≈ 0.871. The
property m → 1 as γ → γd was illustrated with the dotted horizontal line in the right panel
of Fig. 7, that corresponds to the expected height of the plateau of the curves in the critical
region.
The square root behavior of m as a function of γ when γ is close to γd , that is clearly
visible on Fig. 8 and conﬁrmed by a numerical ﬁt of the data, is in line with the bifurcation
of the functional equation (76,77). It is more surprising to observe that eC (γ ) seems to behave
linearly in the limit γ → γd (see the right panel of Fig. 5), as it could suggest that eC admits a
continuation to smaller values of γ , in violation of the hypothesis made at the end of Sec. 4.4.
There are alternative explanations to this observation: the square root contribution could
be very small and not observable with our numerical accuracy, or the expected square root
behavior of C (α, k) when α → αd at ﬁnite k could be washed out in the limit k → ∞, i.e. the
limits α → αd and k → ∞ do not necessarily commute to correspond to the limit γ → γd .

(81)

4.6 An analytic lowerbound on γd

As we have seen above our conjecture for γd is given in terms of the solution of a functional
equation that does not seem to admit a simple expression. One can however derive explicitly
that β (h) ≥ 2(√2 − 1) for all h ∈ [−1, 1]. As a consequence the sequences of masses mn obey
a quantitatively close lowerbound, by observing that the function β (h) deﬁned in (59) is such
the inductive bounds mn+1 ≥ exp[−γ+2(√2−1)mn ]. The function m → exp[−γ+2(√2−1)m]
being increasing the sequence bmn deﬁned by bm1 = e−γ , bmn+1 = exp[−γ + 2(√2 − 1) bmn ] can
simple to show that for γ < 1 + ln(2(√2 − 1)) ≈ 0.812 the sequence bmn diverges with n, and
be shown by induction to lowerbound the sequence mn , namely mn ≥ bmn for all n. It is then
equivalence of the divergence of mn and of eCn this yields the lowerbound γd ≥ 1+ln(2(√2−1)).
as a consequence so does mn . Under the assumption spelled out at the end of Sec. 4.4 on the
28

SciPost Physics

Submission

5 Conclusion

We shall conclude this article by a brief summary and a list of possible directions for future
works. We have computed the constant γd that appears in the asymptotic expansion for
the clustering transition of two constraint satisfaction problems, the bicoloring of random
k-hypergraphs in the limit k → ∞ and the q -coloring of random graphs with q → ∞ (we
considered models with Poissonian degree distributions but our analysis would hold for any
well-behaved distributions, in particular for regular graphs). Our computation relied on a
series of assumptions, made explicit in Sec. 3.2 and at the end of Sec. 4.4, that were backed
up with numerical simulations whenever possible. It would be of course highly desirable to
obtain rigorous proofs of these hypotheses, thus enabling a quantitative enhancement of the
results of [19–21].
Another possible direction of work would be the study of other constraint satisfaction
problems; the coincidence of γd for the two models studied here calls for an investigation of
the range of universality of this constant. In particular the large k limit of the reconstruction
threshold of the random k-satisﬁability problem [23] would be worth investigating, because
at variance with the two models considered here it does not have global symmetries like the
spin ﬂip invariance of the bicoloring problem (or the color permutation invariance for the
q -coloring). In more technical terms its replica symmetric (RS) solution is non-trivial, this
complication could thus aﬀect the value of γd (unless the RS solution is suﬃcienly concentrated
in the relevant regime of α).
The computation we presented could also be generalized to the study of the 1RSB equa-
tions with Parisi breaking parameter distinct from 1, and/or to models at positive tempera-
ture. In the latter situation strictly hard ﬁelds would never exist, but the mechanism of soft
ﬁelds that become asymptotically hard in the large k limit of the regime α ∈ (αd (k), αr (k))
could be at work also in this case. A related problem is the asymptotic expansion of the
reconstruction threshold for the hardcore model on the tree [34, 35], that has been studied
in [36] and presents a similar behavior.
Finally let us mention that our original motivation for the study presented here arose
from our previous work [37] where we studied the possibility of tuning the value of αd (k) by
considering non-uniform (biased) measures on the set of solutions of constraint satisfaction
problems. For ﬁnite values of k well-chosen biases allow indeed to increase αd , thus improving
the range of α in which solutions of random CSPs can be found by eﬃcient algorithms. It
remains to see whether this improvement survives the large k limit, which requires being able
to compute the asymptotics of αd (k) both in the unbiased and biased cases. The former was
the ob ject of the present article, work is currently under way to deal with the latter.

Acknowledgements

GS is part of the PAIL grant of the French Agence Nationale de la Recherche, ANR-17-CE23-
0023-01.

29

SciPost Physics

Submission

A The graph coloring case

This Appendix is devoted to the graph coloring problem. We shall present computations that
are the counterparts of the ones explained in Sec. 2 and 3 of the main text for the hypergraph
bicoloring problem, namely the deﬁnition of the reconstruction problem and its study in the
limit where the number of colors q and the degree c diverge simultaneously according to (1),
and show that the very same equations summarized at the beginning of Sec. 4 arise in this
limit. As the computations are quite similar we will be more succint than in the main text
and concentrate on the speciﬁcities of the coloring problem.
Let us consider a rooted tree with spins σi placed on its vertices. These spins can take q
values, interpreted as colors, σi ∈ {1, . . . , q}. A proper coloring of the tree is a conﬁguration
of the spins such that no edge is monochromatic (i.e. no pair of adjacent vertices are given
the same color). A uniform proper coloring can be drawn in a broadcast fashion, by choosing
the color σ of the root uniformly at random among the q possible ones, then each descendent
of the root is assigned a color uniformly at random among the q − 1 colors distinct from σ ,
and this is repeated recursively down to the n-th generation of the tree. In the reconstruction
problem an observer is then provided with the colors on the vertices of the n-th generation of
the tree only, and asked to guess the color of the root. The optimal strategy is to compute
η , the posterior probability of the root given the observations, which is a distribution over
{1, . . . , q}. A moment of thought reveals that the probability distribution of η , with respect
to a broadcast process conditioned on the root value σ , and with respect to a random choice
of the tree as a Galton-Watson branching process with Poisson oﬀspring distribution of mean
c, is a measure Pσ,n (η) that can be determined recursively through the induction relation:

Pσ,n+1 (η) =

e−c cl

l!

∞Xl=0

1

(q − 1)l Xσ1 ,...,σl 6=σ Z

lYi=1

dPσi ,n(ηi ) δ(η − fc (η1 , . . . , ηl )) ,

(82)

where the Belief Propagation recursion function fc is deﬁned here in such a way that η =
fc (η1 , . . . , ηl ) means

(1 − ηi (τ ))

lQi=1
Pτ ′
lQi=1

η(τ ) =

.

(83)

(1 − ηi (τ ′ ))
The initial condition of this recursive computation is given by Pσ,0 = δ(η − δσ ), where δσ is
the measure concentrated on the color σ , i.e. δσ (τ ) = I(σ = τ ), which corresponds to the
colors being revealed on the leaves of the tree. These equations correspond to (9,12,13) for
the hypergraph bicoloring problem.

SciPost Physics

Submission

Indeed fc (η1 , . . . , ηl ) = δσ if and only if for each color σ ′ 6= σ at least one of the arguments
ηi is equal to δσ′ , thus forbidding all colors except σ . The number of hard ﬁelds of the color
σ ′
6= σ is easily seen from (82) to be Poisson distributed with average cwn
q−1 , independently
from one color σ ′ to another, from which (85) follows.
The recursion (85) has a bifurcation at cr (q), in the sense that wn → 0 as n → ∞ if
and only if c < cr (q). Writing down the equations ﬁxing cr and wr at the bifurcation, which
are similar to (25), and then expanding them for large q one ﬁnds the asymptotic expansion
cr = q(ln q + ln ln q + 1 + o(1)). We shall thus study the large q limit with c getting also large,
on the scale c = q(ln q + ln ln q + γ ) with γ ﬁnite. In this limit one ﬁnds that for n ﬁnite
+ o (cid:18) 1
ln q (cid:19) ,
where xn is of order 1 and obeys exactly the same recursion as in the bicoloring case, namely
x0 = 0 and xn+1 = e−γ+xn .
Let us now simplify the evolution equation for the distributions Qσ,n of the soft ﬁelds.
First of all we insert the decomposition (84) in the right hand side of (82) and obtain, without
any approximation,

wn = 1 −

xn
ln q

(86)

1

l!

(87)

Yσ′ 6=σ (cid:16)e− cwn

Pσ,n+1 (η) =

∞Xl=0

e−c(1−wn ) (c(1 − wn ))l
(q − 1)l Xσ1 ,...,σl 6=σ X{pσ ′ =0,1}σ ′ 6=σ
q−1 (cid:17)1−pσ ′ Z
lYi=1

q−1 (cid:17)pσ ′ (cid:16)1 − e− cwn

dQσi ,n(ηi ) δ(η − efc (σ, {pσ′ }σ′ 6=σ ; η1 , . . . , ηl )) ,
where l is the number of neighbors of the root that receive a soft ﬁeld, σ1 , . . . , σl the colors
these vertices have in the broadcast, and the indicator variables pσ′ are equal to 1 if and
only if no neighbor of the root assigned the color σ ′ in the broadcast is perfectly recovered
(i.e.
receives a hard ﬁeld). Hence the colors σ ′
6= σ with pσ′ = 0 are precisely the ones
forbidden for the root, as at least one of its neighbors is forced to this value. The relation
η = efc (σ, {pσ′ }σ′ 6=σ ; η1 , . . . , ηl ) is obtained by specializing fc of (83) to this pattern for the
presence of hard ﬁelds in its arguments, and thus reads
pτ
(1 − ηi (τ ))

(88)

η(τ ) =

lQi=1
lQi=1
pτ ′

Pτ ′

,

(1 − ηi (τ ′ ))

with the convention pσ = 1.
Let us call p = Pσ′ 6=σ
pσ′ the number of colors that satisfy the condition explained above;
in the equation (87) it corresponds to a random variable with a binomial distribution of
parameters (q − 1, e− cwn
q−1 ). According to (86) the product of these parameters go to zero as
1/ ln q in the limit we are considering, we shall thus truncate (87) on the smallest possible
values of p. As p = 0 yields a hard ﬁeld in the left hand side of (87), the distribution of
the soft ﬁelds is dominated in this limit by the case p = 1. As a consequence the ﬁelds η in
the support of Qσ,n have non-zero values on two colors only, σ and another one σ ′ uniformly

31

SciPost Physics

Submission

with

.

(89)

(90)

Qσ,n+1 (η) =

1

q − 1 Xσ′ 6=σ

∞Xl=0

e−c(1−wn ) (c(1 − wn ))l

q − 1 Xσ′ 6=σ
1+h
2
1−h
2

distributed on the q − 1 possibilities. Let us parametrize this type of distributions via a
distribution Qn (h) on real random variables h ∈ [−1, 1],
Qσ,n (η) = Z dQn(h)
1
δ(η − s(σ, σ ′ ; h)) ,
s(σ, σ ′ ; h)(τ ) = 
if τ = σ
if τ = σ ′
0
otherwise
Let us also denote bfc (σ, σ ′ ; η1 , . . . , ηl ) the function efc (σ, {pσ′′ }σ′′ 6=σ ; η1 , . . . , ηl ) with pσ′′ =
δσ′′ ,σ′ , in such a way that the only two non-zero components of bfc (σ, σ ′ ; η1 , . . . , ηl ) correspond
to the colors σ and σ ′ . Using this notation, and the parametrization (89), one can deduce
from (87) the evolution equation for Qσ,n (η) at lowest order:
Z dQn (hi )
(q − 1)2 Xσi 6=σ
1
δ(η − bfc (σ, σ ′ ; s(σ1 , σ ′
1 ; h1 ), . . . , s(σl , σ ′
l ; hl )))
To put this expression under the form (89), and hence close the recursion on Qn (h), it remains
to notice that
bfc (σ, σ ′ ; η1 , . . . , ηl ) = s(σ, σ ′ , h) with h = f (u1 , . . . , ul ) ,
ui = bu(σ, σ ′ ; ηi ) ,
where f is the function deﬁned for Ising spins in (9), and
η(σ ′ ) − η(σ)
bu(σ, σ ′ ; η) =
2 − η(σ) − η(σ ′ )
.
For a ﬁxed choice of σ and σ ′ 6= σ , one can see that bu(σ, σ ′ ; s(σi , σ ′
i ; hi )) is a random variable
with respect to the uniform choices of σi 6= σ and σ ′
i 6= σi , that takes the following values
(recall the deﬁnition of the function g1 from (39)):
g1 (hi )
with probability q−2
(q−1)2 , when σi = σ ′ , σ ′
i 6= σ ,
g1 (−hi )
with probability q−2
i = σ ′ , σi 6= σ ,
−g1 (−hi ) with probability q−2
i = σ , σi 6= σ ′ ,
i = σ , σi = σ ′ ,
hi
with probability
0

(q−1)2 , when σ ′
(q−1)2 , when σ ′
(q−1)2 , when σ ′
1

lYi=1



(91)

(92)

(93)

l!

σ′
i 6=σi

otherwise .

As c(1−wn ) q−2
(q−1)2 → xn in the regime we are considering, the number of occurences of the ﬁrst
three cases in (91) is Poissonian of mean xn ; on the other hand the number of times the fourth
case happens vanishes when q diverges (as 1/q), while the ﬁfth does not contribute to (91),
because f (u1 , . . . , ul , 0, . . . , 0) = f (u1 , . . . , ul ). We thus see by comparison with (42,43) that
the probability distribution Qn (h) deﬁned in (89) obeys exactly the same recursion equations
as the one derived in the main text for the hypergraph bicoloring model, the initial condition
Q1 (h) = δ(h) being also valid here.

(94)



32

SciPost Physics

Submission

References

[1] M. Garey and D. Johnson, Computers and intractability: A guide to the theory of NP-

completeness, Freeman, San Francisco (1979).

[2] C. H. Papadimitriou, Computational complexity, Addison-Wesley (1994).

[3] R. Monasson, R. Zecchina,
sky,

Relation of

S. Kirkpatrick, B. Selman and L. Troyan-

typical-case

complexity

to the nature of

the

2+p-sat:
transition,

phase

Random Structures
and Algorithms 15,
414
doi:10.1002/(SICI)1098-2418(199910/12)15:3/4<414::AID-RSA10>3.0.CO;2-G .

(1999),

[4] G. Biroli, R. Monasson and M. Weigt, A variational description of the ground
state structure in random satisﬁability problems, Eur. Phys. J. B 14, 551 (2000),

doi:10.1007/s100510051065 .

[5] M. M´ezard, G. Parisi and R. Zecchina, Analytic and algorithmic solution of random

satisﬁability problems, Science 297, 812 (2002), doi:10.1126/science.1073287 .

[6] S. Mertens, M. M´ezard and R. Zecchina, Threshold values of random k-sat from the
cavity method, Random Struct. Algorithms 28(3), 340 (2006), doi:10.1002/rsa.20090 .

[7] F. Krzakala, A. Montanari, F. Ricci-Tersenghi, G. Semerjian and L. Zdeborova, Gibbs

states and the set of solutions of random constraint satisfaction problems, Proceedings of

the National Academy of Sciences 104(25), 10318 (2007), doi:10.1073/pnas.0703685104 .

[8] D. Achlioptas and F. Ricci-Tersenghi, On the solution-space geometry of random con-
straint satisfaction problems, In Proc. of 38th STOC, pp. 130–139. ACM, New York, NY,

USA, doi:10.1145/1132516.1132537 (2006).

[9] D. Achlioptas and A. Co ja-Oghlan, Algorithmic barriers from phase transitions,

In

Proceedings of FOCS 2008, p. 793, doi:10.1109/FOCS.2008.11 (2008).

[10] M. Molloy, The freezing threshold for k-colourings of a random graph, In Proceedings of

the 44th symposium on Theory of Computing, p. 921. ACM, doi:10.1145/2213977.2214060
(2012).

[11] J. Ding, A. Sly and N. Sun, Proof of the satisﬁability conjecture for large k, In Proceedings
of the Forty-seventh Annual ACM Symposium on Theory of Computing, STOC ’15, pp.

59–68, doi:10.1145/2746539.2746619 (2015).

[12] M. M´ezard and G. Parisi, The bethe lattice spin glass revisited, Eur. Phys. J. B 20, 217
(2001), doi:10.1007/PL00011099 .

[13] A. Montanari and G. Semerjian, Rigorous inequalities between length and time scales
in glassy systems,

J. Stat. Phys. 125, 23 (2006),

doi:10.1007/s10955-006-9175-y ,

cond-mat/0603018.

[14] E. Mossel and Y. Peres,
Information ﬂow on trees, Ann. Appl. Probab. 13(3), 817
(2003), doi:10.1214/aoap/1060202828 .

33

SciPost Physics

Submission

[15] M. M´ezard and A. Montanari, Reconstruction on trees and spin glass transition, J. Stat.

Phys. 124, 1317 (2006), doi:10.1007/s10955-006-9162-3 .

[16] L. Zdeborov´a and F. Krzakala, Phase transitions in the coloring of random graphs, Phys.

Rev. E 76, 031131 (2007), doi:10.1103/PhysRevE.76.031131 .

[17] L. Dall’Asta, A. Ramezanpour and R. Zecchina, Entropy landscape and non-gibbs
Phys. Rev. E 77, 031118 (2008),

solutions in constraint satisfaction problems,

doi:10.1103/PhysRevE.77.031118 .

[18] M. Gabri´e, V. Dani, G. Semerjian and L. Zdeborov´a, Phase transitions in the q-coloring
of random hypergraphs, Journal of Physics A: Mathematical and Theoretical 50(50),
505002 (2017), doi:10.1088/1751-8121/aa9529 .

[19] A. Sly, Reconstruction of random colourings, Communications in Mathematical Physics
288(3), 943 (2009), doi:10.1007/s00220-009-0783-7 .

[20] A. Montanari, R. Restrepo and P. Tetali, Reconstruction and clustering in random
constraint satisfaction problems, SIAM Journal on Discrete Mathematics 25(2), 771
(2011), doi:10.1137/090755862 .

[21] A. Sly and Y. Zhang, Reconstruction of colourings without freezing, arXiv preprint

arXiv:1610.02770 (2016).

[22] G. Semerjian, On the freezing of variables in random constraint satisfaction problems, J.

Stat. Phys. 130, 251 (2008), doi:10.1007/s10955-007-9417-7 .

[23] A. Montanari, F. Ricci-Tersenghi and G. Semerjian,

Clusters of solutions and
replica symmetry breaking in random k-satisﬁability, J. Stat. Mech. P04004 (2008),

doi:10.1088/1742-5468/2008/04/p04004 .

[24] F. R. Kschischang, B. Frey and H.-A. Loeliger, Factor graphs and the sum-product
algorithm, IEEE Trans. Inform. Theory 47(2), 498 (2001), doi:10.1109/18.910572 .

[25] T. Richardson and R. Urbanke, Modern Coding Theory, Cambridge University Press
(2007).

[26] H. Nishimori, Statistical Physics of Spin Glasses and Information Processing: An Intro-

duction, Oxford University Press, Oxford, UK (2001).

[27] R. Abou-Chacra, D. J. Thouless and P. W. Anderson,
Journal of Physics C: Solid State Physics 6(10), 1734 (1973),
doi:10.1088/0022-3719/6/10/009 .

A selfconsistent

theory

of

localization,

[28] A. Braunstein, M. M´ezard and R. Zecchina, Survey propagation: An algorithm for
satisﬁability, Random Struct. Algorithms 27(2), 201 (2005), doi:10.1002/rsa.20057 .

[29] K.-I. Sato, L´evy Processes and Inﬁnitely Divisible Distributions, Cambridge University

Press (2013).

[30] S. Asmussen and J. Rosinski, Approximations of smal l jumps of l´evy processes with
a view towards simulation,

Journal of Applied Probability 38(2), 482–493 (2001),

doi:10.1239/jap/996986757 .

34

SciPost Physics

Submission

[31] Z. Chi, Nonnormal smal l jump approximation of inﬁnitely divisible distributions, Ad-

vances in Applied Probability 46(4), 963–984 (2014), doi:10.1239/aap/1418396239 .

[32] W. Feller, An introduction to probability theory and its applications, Vol II, 2nd ed.,

Wiley New York (1971).

[33] T. Watanabe and K. Yamamuro, Ratio of the tail of an inﬁnitely divisible distri-
bution on the line to that of its l´evy measure, Electron. J. Probab. 15, 44 (2010),

doi:10.1214/EJP.v15-732 .

[34] G. R. Brightwell and P. Winkler, A second threshold for the hard-core model on a bethe

lattice, Random Structures & Algorithms 24(3), 303 (2004), doi:10.1002/rsa.20006 .

[35] J. Barbier, F. Krzakala, L. Zdeborov´a and P. Zhang, The hard-core model on ran-
Journal of Physics: Conference Series 473, 012021 (2013),
doi:10.1088/1742-6596/473/1/012021 .

dom graphs revisited,

[36] N. Bhatnagar, A. Sly and P. Tetali, Reconstruction threshold for the hardcore model, In

M. Serna, R. Shaltiel, K. Jansen and J. Rolim, eds., Approximation, Randomization, and

Combinatorial Optimization. Algorithms and Techniques, pp. 434–447 (2010).

[37] L. Budzynski, F. Ricci-Tersenghi and G. Semerjian, Biased landscapes for random con-
straint satisfaction problems, Journal of Statistical Mechanics: Theory and Experiment
2019(2), 023302 (2019), doi:10.1088/1742-5468/ab02de .

35

